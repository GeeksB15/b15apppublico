import{_ as st,a3 as Vt,r as pe,o as R,d as W,w as o,f as t,M as je,G as He,h as xe,i as Le,k as x,t as ae,m as Fe,e as oe,H as be,Q as ce,N as Ee,I as Ze,J as Ge,p as _e,a_ as Dt,a$ as dt,b5 as Ft,b6 as ut,W as Me,b7 as ht,d8 as vt,d9 as Ue,K as Ke,aU as tt,D as $e,bi as yt,ar as ze,au as xt,bJ as wt,b4 as Oe,C as ge,j as ie,bf as Re,P as qe,S as fe,T as Y,U as ue,v as Qe,B as Xe,L as _t,F as Ve,x as Te,l as ct,aO as gt,E as lt,br as mt,e8 as bt,c as rt,bH as it,e9 as Pt,as as zt,at as qt,aN as It,A as Nt,O as Tt}from"./index.f7e7bbce.js";import{Q as At}from"./QUploader.63ab9aad.js";import{L as Bt}from"./Lista.c907a8f4.js";import{Q as Ut}from"./QFab.6569baff.js";import{S as Ot}from"./SeletorCfop.f5d87f2b.js";import{C as Mt}from"./Campo.383b6999.js";import"./xlsx.c8ed84fc.js";import"./use-file.8d91067d.js";const Rt={components:{SeletorNcm:Vt,SeletorCfop:Ot,Campo:Mt},data(){return{abaSelecionada:"tab1",historicoItem:[],tabelaHistoricoItem:{colunas:[{name:"fornecedor",label:"Fornecedor",align:"left"},{name:"dataCompra",label:"Data Compra",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"},{name:"valorCusto",label:"Valor de Custo",align:"right"},{name:"valorTotal",label:"Valor Total (Custo)",align:"right"}],paginacao:{page:1,rowsPerPage:5}},estoqueItem:[],tabelaEstoqueItem:{colunas:[{name:"empresa",label:"Empresa",align:"left"},{name:"tipoEstoque",label:"Tipo estoque",align:"right"},{name:"lote",label:"Lote",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"}],paginacao:{page:1,rowsPerPage:5}},compra:{},cfop:null,cstIcms:"",cstIpi:"",contaEstoque:[],impostoCstIpi:[],impostoIcmsModalidade:[],impostoCstIcms:[],impostoCstIcmsSt:[],documentoItem:{},imposto:{},item:{},visivel:!1,contasOpcoes:[],exibirIcms:!1,exibirIcmsSt:!1,exibirFcp:!1,exibirFcpSt:!1,exibirIpi:!1,somenteLeituraIcms:!1,somenteLeituraIcmsSt:!1,exibirHistorico:!1,exibirEstoque:!1,exibeCfop:!1}},emits:["salvar"],methods:{async mostrar(r,e,f){var a,m,h,I;this.compra=f,this.documentoItem=$utils.clonarV2(r),this.item=$utils.clonarV2(e),await this.consultarHistoricoItem(this.item),await this.consultarEstoqueItem(this.item);const _=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:1}}),i=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:21}});this.impostoCstIcms=_.concat(i).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,n)=>Number(b.valor)-Number(n.valor)),this.impostoIcmsModalidade=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:3}})).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,n)=>Number(b.valor)-Number(n.valor)),this.impostoCstIcmsSt=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:4}})).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,n)=>Number(b.valor)-Number(n.valor)),this.impostoCstIpi=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:5}})).map(b=>({rotulo:b.numero.trim()+" - "+b.descr,valor:Number(b.numero)})).sort((b,n)=>Number(b.valor)-Number(n.valor)),this.contaEstoque=(await $db.hibrido.lista({table:"financeiroPlanoConta"})).map(b=>{var n,l,C;return{rotulo:(C=(l=(n=b==null?void 0:b.descricao)!=null?n:" - "+(b==null?void 0:b.classificacao))!=null?l:" - "+(b==null?void 0:b.caminho))!=null?C:"",valor:b.id}}).sort((b,n)=>Number(b.valor)-Number(n.valor));let s;(a=this.documentoItem)!=null&&a.idCfop&&(s=await $erp().cfop.where({id:this.documentoItem.idCfop}).first()),s===void 0&&console.log("CFOP inv\xE1lido");const d=this.documentoItem.total/(this.documentoItem.quantidade||1)||0;this.documentoItem.cfop=(m=s==null?void 0:s.cfop.toString())!=null?m:"",this.documentoItem.codigoCfop=(h=s==null?void 0:s.codigoCfop)!=null?h:null,this.documentoItem.idCfop=(I=s==null?void 0:s.id)!=null?I:null,this.documentoItem.valorBaseIcms=this.documentoItem.valorBaseIcms||d,this.documentoItem.valorBaseIpi=this.documentoItem.valorBaseIpi||d,this.documentoItem.valorBaseIcmsSt=this.documentoItem.valorBaseIcmsSt||d,this.calcularImpostos(),this.exibeCfop=!0,this.visivel=!0},async salvar(){try{if(this.exibirIcms||(this.documentoItem.modalidadeBaseCalculo=null,this.documentoItem.codigoCst=null,this.documentoItem.percentualIcms=0,this.documentoItem.valorIcms=0),this.exibirIcmsSt||(this.documentoItem.modalidadeBaseCalculoST=null,this.documentoItem.percentualIcmsSt=0,this.documentoItem.valorIcmsSt=0),this.exibirFcp||(this.documentoItem.percentualFcp=0,this.documentoItem.valorFcp=0),this.exibirFcpSt||(this.documentoItem.percentualFcpSt=0,this.documentoItem.valorFcpSt=0),this.exibirIpi||(this.documentoItem.codigoCstIpi=null,this.documentoItem.percentualIpi=0,this.documentoItem.valorIpi=0),Object.keys(this.documentoItem.cfop).length>0){const r=await $db.hibrido.lista({table:"cfop",where:{cfop:Number(this.documentoItem.cfop)}});this.documentoItem.codigoCfop=r[0].codigoCfop,this.documentoItem.idCfop=r[0].id}this.documentoItem.cfop&&delete this.documentoItem.cfop,this.$emit("salvar",this.documentoItem),this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirFcp=!1,this.exibirFcpSt=!1,this.exibirIpi=!1,this.visivel=!1}catch(r){$q.notifyError("Ocorreu um erro ao salvar o produto: ",r.message)}finally{$q.notifyPositive("Produto salvo com sucesso.")}},calcularImpostos(r){var u,y,v,V,D,z,A,$,T,Z,re,E,U,p,O,ne;let e=(u=this.documentoItem.valorBaseIcms)!=null?u:0,f=(y=this.documentoItem.valorBaseIpi)!=null?y:0,_=(v=this.documentoItem.valorBaseIcmsSt)!=null?v:0,i=(V=this.documentoItem.percentualIcms)!=null?V:0,s=(D=this.documentoItem.percentualIpi)!=null?D:0,d=(z=this.documentoItem.percentualIVA)!=null?z:0,a=(A=this.documentoItem.percentualIcmsSt)!=null?A:0,m=($=this.documentoItem.valorIcms)!=null?$:0,h=(T=this.documentoItem.valorIpi)!=null?T:0,I=(Z=this.documentoItem.valorIcmsSt)!=null?Z:0;["valorBaseIcms","percentualIcms"].includes(r)&&(m=e*i/100),r==="valorIcms"&&(i=m/e*100),["valorBaseIpi","percentualIpi"].includes(r)&&(h=f*s/100),r==="valorIpi"&&(s=h/f*100),r==="valorBaseIcmsSt"&&(d=0,_>0&&e>0&&_>=e&&(d=(_-e)/e*100),I=_*a/100-m),r==="percentualIVA"&&(_=e*(1+d/100),I=_*a/100-m),r==="percentualIcmsSt"&&(I=_*a/100-m),r==="valorIcmsSt"&&(a=I/_*100),this.documentoItem.valorBaseIcmsSt=parseFloat(_.toFixed(2)),this.documentoItem.percentualIcms=parseFloat(i.toFixed(2)),this.documentoItem.percentualIcmsSt=parseFloat(a.toFixed(2)),this.documentoItem.percentualIpi=parseFloat(s.toFixed(2)),this.documentoItem.percentualIVA=parseFloat(d.toFixed(2)),this.documentoItem.valorIcms=parseFloat(m.toFixed(2)),this.documentoItem.valorIcmsSt=parseFloat(I.toFixed(2)),this.documentoItem.valorIpi=parseFloat(h.toFixed(2)),(this.documentoItem.modalidadeBaseCalculo||this.documentoItem.codigoCst||this.documentoItem.percentualIcms>0||this.documentoItem.valorIcms>0)&&(this.exibirIcms=!0),(this.documentoItem.modalidadeBaseCalculoST||this.documentoItem.percentualIcmsSt>0||this.documentoItem.valorIcmsSt>0)&&(this.exibirIcmsSt=!0);let b=(re=this.documentoItem.valorBaseFcp)!=null?re:0,n=(E=this.documentoItem.percentualFcp)!=null?E:0,l=(U=this.documentoItem.valorFcp)!=null?U:0,C=(p=this.documentoItem.valorBaseFcpSt)!=null?p:0,g=(O=this.documentoItem.percentualFcpSt)!=null?O:0,w=(ne=this.documentoItem.valorFcpSt)!=null?ne:0;(this.documentoItem.percentualFcp>0||this.documentoItem.valorFcp>0)&&(this.exibirFcp=!0),(this.documentoItem.percentualFcpSt>0||this.documentoItem.valorFcpSt>0)&&(this.exibirFcpSt=!0),["valorBaseFcp","percentualFcp"].includes(r)&&(l=b*n/100),r==="valorFcp"&&(n=l/b*100),["valorBaseFcpSt","percentualFcpSt"].includes(r)&&(w=C*g/100),r==="valorFcpSt"&&(g=w/C*100),this.documentoItem.valorBaseFcp=parseFloat(b.toFixed(2)),this.documentoItem.percentualFcp=parseFloat(n.toFixed(2)),this.documentoItem.valorFcp=parseFloat(l.toFixed(2)),this.documentoItem.valorBaseFcpSt=parseFloat(C.toFixed(2)),this.documentoItem.percentualFcpSt=parseFloat(g.toFixed(2)),this.documentoItem.valorFcpSt=parseFloat(w.toFixed(2)),(this.documentoItem.codigoCstIpi||this.documentoItem.percentualIpi>0||this.documentoItem.valorIpi>0)&&(this.exibirIpi=!0)},async consultarCFOP(){var f,_;const r=this.documentoItem.cfop,e=await $erp().cfop.where({cfop:Number(r)}).first();e===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.idCfop=(f=e==null?void 0:e.id)!=null?f:null,this.documentoItem.codigoCfop=(_=e==null?void 0:e.CodigoCFOP)!=null?_:null},async consultarHistoricoItem(r){const e={};(r==null?void 0:r.atual)&&Object.keys(r.atual).length>0&&(r=r.atual);const _=(await $db.hibrido.lista({table:"documentoItem",where:{idItem:r.id}})).filter(i=>(i.operacao==="Compra"||i.operacao==="Compra de Mercadoria")&&i.status==="Finalizado"&&i.operacaoFator===1&&i.quantidade>0);for(const i of _){const s=await $db.hibrido.le({table:"documento",id:i.idDocumento}),d=await $db.hibrido.le({table:"contato",id:s.idContato});e[i.idItem]||(e[i.idItem]={fornecedores:[]}),e[i.idItem].fornecedores.push({fornecedor:d.apelido||"",dataCompra:s.dataCompra||"",quantidade:i.quantidade||"",valorCusto:i.valorItem||"",valorTotal:i.valorItem*i.quantidade||""})}Object.keys(e).length>0?(this.historicoItem=e,this.historicoItem[r.id].fornecedores.sort((i,s)=>{const d=new Date(i.dataCompra||"1900-01-01");return new Date(s.dataCompra||"1900-01-01")-d})):this.historicoItem[r.id]={fornecedores:[]},this.exibirHistorico=!0},async consultarEstoqueItem(r){const e={};(r==null?void 0:r.atual)&&Object.keys(r.atual).length>0&&(r=r.atual);const f=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",where:{idItem:r.id},whereFilter:{tipoEstoque:"Dispon\xEDvel"}});for(const _ of f){const i=await $db.hibrido.le({table:"contato",id:_.idEmpresa});e[_.idItem]||(e[_.idItem]={estoques:[]}),e[_.idItem].estoques.push({empresa:i.apelido||"",tipoEstoque:_.tipoEstoque||"",lote:_.lote||"-",quantidade:_.saldo||""})}Object.keys(e).length>0?(this.estoqueItem=e,this.estoqueItem[r.id].estoques.sort((_,i)=>{const s=Number(_.quantidade||0);return Number(i.quantidade||0)-s})):this.estoqueItem[r.id]={estoques:[]},this.exibirEstoque=!0},async fechar(){this.documentoItem.cfop&&delete this.documentoItem.cfop,this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirFcp=!1,this.exibirFcpSt=!1,this.exibirIpi=!1}}},Lt=["src"],$t={key:0},jt={key:0};function Ht(r,e,f,_,i,s){const d=pe("badge"),a=pe("g-col"),m=pe("g-row"),h=pe("campo"),I=pe("SeletorNcm"),b=pe("SeletorCfop"),n=pe("g-label");return R(),W($e,{modelValue:i.visivel,"onUpdate:modelValue":e[50]||(e[50]=l=>i.visivel=l),persistent:""},{default:o(()=>[t(je,{container:"",view:"hHh Lpr fFf",class:"bg-white",style:{"max-width":"980px"}},{default:o(()=>[t(He,{class:"bg-primary"},{default:o(()=>[t(xe,{class:"bg-primary text-white"},{default:o(()=>[t(Le,null,{default:o(()=>[x(ae(i.documentoItem.descricaoItem),1)]),_:1}),i.item.referencia?(R(),W(d,{key:0,cor:"tertiary",class:"q-mr-sm"},{default:o(()=>[x(ae(i.item.referencia)+" ",1),t(Fe,null,{default:o(()=>e[51]||(e[51]=[x(" Refer\xEAncia ")])),_:1})]),_:1})):oe("",!0),i.item.codigoItem?(R(),W(d,{key:1,cor:"positive",class:"q-mr-sm"},{default:o(()=>[x(" #"+ae(i.item.codigoItem.toString().padStart(4,"0"))+" ",1),t(Fe,null,{default:o(()=>e[52]||(e[52]=[x(" C\xF3digo Item ")])),_:1})]),_:1})):oe("",!0),be(t(ce,{onClick:s.fechar,dense:"",flat:"",icon:"close",round:""},null,8,["onClick"]),[[Ee]])]),_:1})]),_:1}),t(Ze,null,{default:o(()=>[t(Ge,null,{default:o(()=>[t(m,{gutter:"md"},{default:o(()=>[t(a,null,{default:o(()=>[t(m,{class:"col-12 text-center"},{default:o(()=>[t(a,null,{default:o(()=>{var l,C,g,w,u,y;return[((l=i.item)==null?void 0:l.imagem)||((g=(C=i.item)==null?void 0:C.atual)==null?void 0:g.imagem)?(R(),_e("img",{key:0,src:((w=i.item)==null?void 0:w.imagem)||((y=(u=i.item)==null?void 0:u.atual)==null?void 0:y.imagem),alt:"",style:{"max-width":"33%"}},null,8,Lt)):oe("",!0)]}),_:1})]),_:1}),t(Dt,{modelValue:i.abaSelecionada,"onUpdate:modelValue":e[0]||(e[0]=l=>i.abaSelecionada=l),align:"justify",dense:"","indicator-color":"light-blue-4",class:"text-primary q-px-sm"},{default:o(()=>[t(dt,{default:"",name:"tab1",icon:"info",label:"Detalhes",class:"cinza"}),t(dt,{name:"tab2",icon:"history",label:"Compras",class:"cinza"}),t(dt,{name:"tab3",icon:"compare_arrows",label:"Estoque",class:"cinza"})]),_:1},8,["modelValue"]),t(Ft,{modelValue:i.abaSelecionada,"onUpdate:modelValue":e[49]||(e[49]=l=>i.abaSelecionada=l),animated:"",class:"text-tertiary"},{default:o(()=>[t(ut,{name:"tab1",class:"q-px-sm"},{default:o(()=>[t(m,null,{default:o(()=>[t(a,null,{default:o(()=>[t(h,{modelValue:i.documentoItem.observacao,"onUpdate:modelValue":e[1]||(e[1]=l=>i.documentoItem.observacao=l),tipo:"textoArea","somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Observa\xE7\xE3o",dense:"",rows:"4"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(h,{modelValue:i.documentoItem.referenciaFornecedor,"onUpdate:modelValue":e[2]||(e[2]=l=>i.documentoItem.referenciaFornecedor=l),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",rotulo:"Refer\xEAncia Fornecedor"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(I,{modelValue:i.documentoItem.ncm,"onUpdate:modelValue":e[3]||(e[3]=l=>i.documentoItem.ncm=l),disable:i.compra.status!=="Digita\xE7\xE3o",class:"col-12 col-md-6",outlined:""},null,8,["modelValue","disable"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(b,{modelValue:i.documentoItem.cfop,"onUpdate:modelValue":e[4]||(e[4]=l=>i.documentoItem.cfop=l),disable:i.compra.status!=="Digita\xE7\xE3o",class:"col-12 col-md-6",outlined:""},null,8,["modelValue","disable"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:o(()=>[t(a,null,{default:o(()=>[t(n,{text:"sub1 medium"},{default:o(()=>e[53]||(e[53]=[x("Estoque")])),_:1})]),_:1})]),_:1}),t(m,{items:"center"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(h,{modelValue:i.documentoItem.idPlanoContaEstoque,"onUpdate:modelValue":e[5]||(e[5]=l=>i.documentoItem.idPlanoContaEstoque=l),opcoes:i.contaEstoque,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"seletor",ajuda:"Plano de Conta de Estoque para Entrada de Mercadoria",dense:"",outlined:"",rotulo:"Conta Estoque"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1})]),_:1}),t(m,{mg:"lg-t"},{default:o(()=>[t(a,null,{default:o(()=>[t(n,{text:"sub1 medium"},{default:o(()=>e[54]||(e[54]=[x("Impostos")])),_:1})]),_:1})]),_:1}),t(m,null,{default:o(()=>[t(Me,{label:"ICMS",modelValue:i.exibirIcms,"onUpdate:modelValue":e[6]||(e[6]=l=>i.exibirIcms=l)},null,8,["modelValue"])]),_:1}),i.exibirIcms?(R(),W(m,{key:0,items:"center"},{default:o(()=>[t(a,{col:"12 sm6"},{default:o(()=>[t(h,{modelValue:i.documentoItem.modalidadeBaseCalculo,"onUpdate:modelValue":e[7]||(e[7]=l=>i.documentoItem.modalidadeBaseCalculo=l),opcoes:i.impostoIcmsModalidade,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"seletor",outlined:"",rotulo:"ICMS (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(a,{col:"12 sm6"},{default:o(()=>[t(h,{modelValue:i.documentoItem.codigoCst,"onUpdate:modelValue":e[8]||(e[8]=l=>i.documentoItem.codigoCst=l),opcoes:i.impostoCstIcms,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"seletor",outlined:"",rotulo:"CST ICMS"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorBaseIcms,"onUpdate:modelValue":e[9]||(e[9]=l=>i.documentoItem.valorBaseIcms=l),onBlur:e[10]||(e[10]=l=>s.calcularImpostos("valorBaseIcms")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.percentualIcms,"onUpdate:modelValue":e[11]||(e[11]=l=>i.documentoItem.percentualIcms=l),onBlur:e[12]||(e[12]=l=>s.calcularImpostos("percentualIcms")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS %"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorIcms,"onUpdate:modelValue":e[13]||(e[13]=l=>i.documentoItem.valorIcms=l),onBlur:e[14]||(e[14]=l=>s.calcularImpostos("valorIcms")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):oe("",!0),t(m,null,{default:o(()=>[t(Me,{label:"ICMS ST",modelValue:i.exibirIcmsSt,"onUpdate:modelValue":e[15]||(e[15]=l=>i.exibirIcmsSt=l)},null,8,["modelValue"])]),_:1}),i.exibirIcmsSt?(R(),W(m,{key:1,items:"center"},{default:o(()=>[t(a,{col:"12 sm6"},{default:o(()=>[t(h,{modelValue:i.documentoItem.modalidadeBaseCalculoST,"onUpdate:modelValue":e[16]||(e[16]=l=>i.documentoItem.modalidadeBaseCalculoST=l),opcoes:i.impostoCstIcmsSt,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"seletor",outlined:"",rotulo:"ICMS ST (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(a,{col:"12 sm6"},{default:o(()=>[t(h,{modelValue:i.documentoItem.percentualIVA,"onUpdate:modelValue":e[17]||(e[17]=l=>i.documentoItem.percentualIVA=l),onBlur:e[18]||(e[18]=l=>s.calcularImpostos("percentualIVA")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IVA (%)"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorBaseIcmsSt,"onUpdate:modelValue":e[19]||(e[19]=l=>i.documentoItem.valorBaseIcmsSt=l),onBlur:e[20]||(e[20]=l=>s.calcularImpostos("valorBaseIcmsSt")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.percentualIcmsSt,"onUpdate:modelValue":e[21]||(e[21]=l=>i.documentoItem.percentualIcmsSt=l),onBlur:e[22]||(e[22]=l=>s.calcularImpostos("percentualIcmsSt")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS ST (%)"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorIcmsSt,"onUpdate:modelValue":e[23]||(e[23]=l=>i.documentoItem.valorIcmsSt=l),onBlur:e[24]||(e[24]=l=>s.calcularImpostos("valorIcmsSt")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):oe("",!0),t(m,null,{default:o(()=>[t(Me,{label:"Fundo de Combate \xE0 Pobreza (FCP)",modelValue:i.exibirFcp,"onUpdate:modelValue":e[25]||(e[25]=l=>i.exibirFcp=l)},null,8,["modelValue"])]),_:1}),i.exibirFcp?(R(),W(m,{key:2,items:"center"},{default:o(()=>[t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorBaseFcp,"onUpdate:modelValue":e[26]||(e[26]=l=>i.documentoItem.valorBaseFcp=l),onBlur:e[27]||(e[27]=l=>s.calcularImpostos("valorBaseFcp")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base FCP"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.percentualFcp,"onUpdate:modelValue":e[28]||(e[28]=l=>i.documentoItem.percentualFcp=l),onBlur:e[29]||(e[29]=l=>s.calcularImpostos("percentualFcp")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"FCP %"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorFcp,"onUpdate:modelValue":e[30]||(e[30]=l=>i.documentoItem.valorFcp=l),onBlur:e[31]||(e[31]=l=>s.calcularImpostos("valorFcp")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor FCP"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):oe("",!0),t(m,null,{default:o(()=>[t(Me,{label:"FCP retido por substituicao tributaria (FCP ST)",modelValue:i.exibirFcpSt,"onUpdate:modelValue":e[32]||(e[32]=l=>i.exibirFcpSt=l)},null,8,["modelValue"])]),_:1}),i.exibirFcpSt?(R(),W(m,{key:3,items:"center"},{default:o(()=>[t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorBaseFcpSt,"onUpdate:modelValue":e[33]||(e[33]=l=>i.documentoItem.valorBaseFcpSt=l),onBlur:e[34]||(e[34]=l=>s.calcularImpostos("valorBaseFcpSt")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base FCP ST"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.percentualFcpSt,"onUpdate:modelValue":e[35]||(e[35]=l=>i.documentoItem.percentualFcpSt=l),onBlur:e[36]||(e[36]=l=>s.calcularImpostos("percentualFcpSt")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"FCP ST %"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorFcpSt,"onUpdate:modelValue":e[37]||(e[37]=l=>i.documentoItem.valorFcpSt=l),onBlur:e[38]||(e[38]=l=>s.calcularImpostos("valorFcpSt")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor FCP ST"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):oe("",!0),t(m,null,{default:o(()=>[t(Me,{label:"IPI",modelValue:i.exibirIpi,"onUpdate:modelValue":e[39]||(e[39]=l=>i.exibirIpi=l)},null,8,["modelValue"])]),_:1}),i.exibirIpi?(R(),W(m,{key:4,items:"center"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(h,{modelValue:i.documentoItem.codigoCstIpi,"onUpdate:modelValue":e[40]||(e[40]=l=>i.documentoItem.codigoCstIpi=l),opcoes:i.impostoCstIpi,"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"seletor",dense:"",outlined:"",rotulo:"CST IPI"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorBaseIpi,"onUpdate:modelValue":e[41]||(e[41]=l=>i.documentoItem.valorBaseIpi=l),onBlur:e[42]||(e[42]=l=>s.calcularImpostos("valorBaseIpi")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base IPI"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.percentualIpi,"onUpdate:modelValue":e[43]||(e[43]=l=>i.documentoItem.percentualIpi=l),onBlur:e[44]||(e[44]=l=>s.calcularImpostos("percentualIpi")),"somente-leitura":i.compra.status!=="Digita\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IPI %"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm4"},{default:o(()=>[t(h,{modelValue:i.documentoItem.valorIpi,"onUpdate:modelValue":e[45]||(e[45]=l=>i.documentoItem.valorIpi=l),onBlur:e[46]||(e[46]=l=>s.calcularImpostos("valorIpi")),tipo:"decimal","somente-leitura":i.compra.status!=="Digita\xE7\xE3o",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor IPI"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):oe("",!0)]),_:1}),t(ut,{name:"tab2",class:"q-px-sm"},{default:o(()=>[i.exibirHistorico?(R(),W(ht,{key:0,rows:i.historicoItem[i.documentoItem.idItem].fornecedores,columns:i.tabelaHistoricoItem.colunas,pagination:i.tabelaHistoricoItem.paginacao,"onUpdate:pagination":e[47]||(e[47]=l=>i.tabelaHistoricoItem.paginacao=l),"row-key":"index",class:"no-shadow text-left"},{body:o(l=>[t(vt,{props:l},{default:o(()=>[t(Ue,{key:"fornecedor",props:l},{default:o(()=>[x(ae(l.row.fornecedor),1)]),_:2},1032,["props"]),t(Ue,{key:"dataCompra",props:l},{default:o(()=>[l.row.dataCompra!==""?(R(),_e("span",$t,ae(r.$filters.data(l.row.dataCompra)),1)):oe("",!0)]),_:2},1032,["props"]),t(Ue,{key:"quantidade",props:l},{default:o(()=>[x(ae(l.row.quantidade),1)]),_:2},1032,["props"]),t(Ue,{key:"valorCusto",props:l},{default:o(()=>[x(ae(r.$filters.numero(l.row.valorCusto,2)),1)]),_:2},1032,["props"]),t(Ue,{key:"valorTotal",props:l},{default:o(()=>[x(ae(r.$filters.numero(l.row.valorTotal,2)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):oe("",!0)]),_:1}),t(ut,{name:"tab3",class:"q-px-sm"},{default:o(()=>[i.exibirEstoque?(R(),W(ht,{key:0,rows:i.estoqueItem[i.documentoItem.idItem].estoques,columns:i.tabelaEstoqueItem.colunas,pagination:i.tabelaEstoqueItem.paginacao,"onUpdate:pagination":e[48]||(e[48]=l=>i.tabelaEstoqueItem.paginacao=l),"row-key":"index",class:"no-shadow text-left"},{body:o(l=>[t(vt,{props:l},{default:o(()=>[t(Ue,{key:"empresa",props:l},{default:o(()=>[x(ae(l.row.empresa),1)]),_:2},1032,["props"]),t(Ue,{key:"tipoEstoque",props:l},{default:o(()=>[x(ae(l.row.tipoEstoque),1)]),_:2},1032,["props"]),t(Ue,{key:"lote",props:l},{default:o(()=>[l.row.lote!==""?(R(),_e("span",jt,ae(l.row.lote),1)):oe("",!0)]),_:2},1032,["props"]),t(Ue,{key:"quantidade",props:l},{default:o(()=>[x(ae(l.row.quantidade),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):oe("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Ke,{class:"bg-light q-pa-sm",bordered:""},{default:o(()=>[t(xe,null,{default:o(()=>[t(tt),be(t(ce,{onClick:s.fechar,label:"Cancelar",size:"md",flat:"","no-ripple":"",color:"tertiary",class:"q-mr-sm"},null,8,["onClick"]),[[Ee]]),t(ce,{onClick:s.salvar,label:"Salvar",color:"primary","no-ripple":"",unelevated:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Zt=st(Rt,[["render",Ht]]);const Gt={components:{ModalEditarProdutoCompras:Zt,PromptItemV2:yt},data(){const r={tela:{},termoBusca:"",layoutCompraItens:[],ehOrcamento:!0,adicionar:{modal:{value:!1,name:""}},dataPrevistaEntrega:"",horaPrevistaEntrega:"",contatos:{},produtos:[],formasDePagamento:[],visivel:!1,somenteLeitura:!1,condicaoPagamentoRules:[async()=>{const e=this.compra.condicaoPagamento;return/^[\d/]*$/.test(e)}],formaPagamentoRules:[async()=>{const e=this.compra.formaDePagamento;return/^[^\d\s][a-zA-Z\s]*[^\d\s]$/.test(e)}],comprasMigrar:[],erroDesconto:!1,erroFrete:!1,erroSeguro:!1,erroOutrasDespesas:!1,exibeInfNota:!1,documentoNovo:!1,valorTotalPagamento:0,sku:0,operacao:"",alterarPrevisaoEntrega:!1,showContabilidade:!1};return this.limpaCampos(r),r},emits:["atualizar","dialogImprimirEtiquetas"],computed:{skus(){return this.compraItens.length>0?`${Number(this.compraItens.length)}`:"0"},quantidadeItens(){return this.compraItens.reduce((r,e)=>r+e.quantidade,0)}},methods:{buscar(){try{let r=new Set((this.termoBusca||"").trim().toLowerCase().replace(/\s+/g," ").normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(" "));r=Array.from(r);for(const e of Object.values(this.layoutCompraItens)){let f=`${e.id} ${e.codigoItem?String(e.codigoItem)+" #"+String(e.codigoItem):""} `;f+=`${e.descricaoConcatenada||""} ${e.marca||""} ${e.grupo||""} ${e.subGrupo||""} `,f+=`${e.aplicacao||""} ${e.referencia?e.referencia+" Ref"+e.referencia:""} `,f+=`${e.codigoBarras||""} ${e.tipo||""} ${e.codigoBarrasAntigo||""} ${e.codigoAntigo||""}`,f=f.trim().toLowerCase().replace(/\s+/g," ").normalize("NFD").replace(/[\u0300-\u036f]/g,"");let _=!0;for(const i of r)if(f.indexOf(i)===-1){_=!1;break}_?e.visivel=!1:e.visivel=!0}}catch(r){console.error("Erro ao buscar item. ",r)}},editarProduto(r){const e=this.produtos[r.idItem],f=this.compra;this.$refs.ModalEditarProdutoCompras.mostrar(r,e,f)},removerItem(r){this.compraItens=this.compraItens.filter(e=>e.id!==r.id),this.calcularTotais()},async migrarParaOutraCompra(r,e){await $tryLoading(async()=>{const f=(e==null?void 0:e.id)||$utils.uuid(),_=e?{...e}:{...this.compra,id:f,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,totalDesconto:void 0,totalPercentualDesconto:void 0,valorFrete:void 0,valorSeguro:void 0,valorOutrasDespesas:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o"},i={...r,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:f,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"};this.calcularTotais("",_,[i]),await $db.hibrido.grava("documento",{atual:_,original:e}),await $db.hibrido.grava("documentoItem",{atual:i}),this.removerItem(r),this.salvar(),$q.notifyPositive("Item migrado com sucesso!")},{mensagem:"Migrando..."})},fecharEdicaoProduto(r){const e=this.compraItens.findIndex(f=>f.id===r.id);this.compraItens[e]=$utils.clonar(r),this.calcularTotaisItem(e)},async atualizar(){var i,s,d,a,m,h,I;this.compraOriginal=await $db.hibrido.le({table:"documento",id:this.compra.id}),this.compra=$utils.clonarV2(this.compraOriginal),$utils.verificarErro(!this.compra.id,"Compra n\xE3o encontrada"),this.compraItensOriginal=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:this.compra.id}})).sort((b,n)=>new Date(b.dataHoraEmissao||0)-new Date(n.dataHoraEmissao||0));const r=[...new Set(this.compraItensOriginal.map(b=>b.idItem))],e=(i=await $db.hibrido.lista({table:"item",columns:["id","codigoItem","codigoItem","codigoItem","descricaoConcatenada","marca","grupo","subGrupo","aplicacao","referencia","referencia","referencia","codigoBarras","tipo","codigoBarrasAntigo","codigoAntigo"],whereIn:{id:r}}))!=null?i:{};for(const b of this.compraItensOriginal)b.descricaoConcatenada=(e==null?void 0:e.find(n=>n.id===b.idItem).descricaoConcatenada)||"",this.layoutCompraItens[b.idItem]={...e==null?void 0:e.find(n=>n.id===b.idItem),codigoItem:((s=e==null?void 0:e.find(n=>n.id===b.idItem))==null?void 0:s.codigoItem[0])||((d=e==null?void 0:e.find(n=>n.id===b.idItem))==null?void 0:d.codigoItem),referencia:((a=e==null?void 0:e.find(n=>n.id===b.idItem))==null?void 0:a.referencia[0])||((m=e==null?void 0:e.find(n=>n.id===b.idItem))==null?void 0:m.referencia),visivel:!1};this.compraItens=$utils.clonarV2(this.compraItensOriginal),this.compraCondicoesDePagamentoOriginal=(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:this.compra.id}})).sort((b,n)=>new Date(b.dataVencimento||0)-new Date(n.dataVencimento||0)),this.compraCondicoesDePagamento=$utils.clonarV2(this.compraCondicoesDePagamentoOriginal),this.compraTitulosOriginal=await $db.hibrido.lista({table:"financeiroTitulo",where:{documentoId:this.compra.id}}),this.compraTitulos=$utils.clonarV2(this.compraTitulosOriginal),this.compraMovimentacoesOriginal=await $db.hibrido.lista({table:"financeiroMovimentacao",where:{documentoId:this.compra.id}}),this.compraMovimentacoes=$utils.clonarV2(this.compraMovimentacoesOriginal),this.compraDocumentoXmlOriginal=await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:this.compra.id}}),this.compraDocumentoXml=$utils.clonarV2(this.compraDocumentoXmlOriginal),this.compra.totalComImposto=!0,this.compra.calcularTributacao=(h=this.compra.calcularTributacao)!=null?h:!0,this.compra.naoGerarFinanceiro=(I=this.compra.naoGerarFinanceiro)!=null?I:!1;const f=[this.compra.idEmpresa,this.compra.idContato,this.compra.idContatoComprador,this.compra.idContatoVendedor,this.compra.idContatoTransportadora].filter(Boolean);this.carregarImagensContatos(f);const _=this.compraItens.map(({idItem:b})=>b).filter(Boolean);if(this.carregarImagensItens(_),this.valorTotalPagamento===0)for(const b of this.compraCondicoesDePagamento)this.valorTotalPagamento=this.valorTotalPagamento+b.valor;this.compra.dataHoraPrevisto&&(this.dataPrevistaEntrega=this.compra.dataHoraPrevisto.slice(0,10),this.horaPrevistaEntrega=this.compra.dataHoraPrevisto.slice(11,16)),this.carregarComprasMigrar(this.compra),this.calcularTotais(),this.exibeInfNota=!0},async carregarContatos(r){const e=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:r}});for(const f of e)this.contatos[f.id]=f},async carregarImagensContatos(r){if(!!r.length){await $utils.dormir(200);try{await this.carregarContatos(r)}catch(e){console.error("Erro ao carregar imagens de contatos - ",e)}}},async carregarComprasMigrar(r){try{this.comprasMigrar=(await $db.hibrido.lista({table:"documento",where:{tipo:"Compra",idContato:r.idContato},whereFilter:{idEmpresa:r.idEmpresa,status:"Digita\xE7\xE3o"}})).filter(({id:e})=>e!==r.id)}catch(e){console.error("Erro ao carregar compras para migra\xE7\xE3o - ",e)}},async carregarItens(r){const e=await $db.hibrido.lista({table:"item",columns:["id","descricao","imagem","valorCustoReposicao","marca","referencia","codigoItem"],whereIn:{id:r}});for(const f of e)this.produtos[f.id]=f},async carregarImagensItens(r){if(!!r.length){await $utils.dormir(200);try{await this.carregarItens(r)}catch(e){console.error("Erro ao ler imagens de itens - ",e)}}},async salvar_click(){await $tryLoading(async()=>{if(this.compra.idContato||(this.compra.idContato=$db.usuario.logado.id),this.dataPrevistaEntrega){const r=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;this.compra.dataHoraPrevisto=ze.formatDate(r)}this.calcularTotais(),await this.salvar(),this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi salva com sucesso.":"O Pedido de Compra foi salvo com sucesso.")},{mensagem:"Salvando..."})},async excluir_click(){!await $q.dialogSimNao({title:"Excluir compra",message:`Deseja excluir ${this.compra.operacao==="Pedido de Compra"?`o ${this.compra.operacao}?`:`a ${this.compra.operacao}?`}`})||await $tryLoading(async()=>{this.visivel=!1,this.operacao=this.compra.operacao,this.compra={},this.compraCondicoesDePagamento=[],this.compraItens=[],this.compraMovimentacoes=[],this.compraTitulos=[],this.compraDocumentoXml=[],await this.salvar(),await this.fechar(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi excluida com sucesso.":"O Pedido de Compra foi excluido com sucesso.")},{mensagem:"Excluindo..."})},async criar(){await $tryLoading(async()=>{const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;if(!(r.length>0)){this.$q.notify({message:"N\xE3o h\xE1 empresa configurada",timeout:0,type:"negative",closeBtn:!0});return}let e=r[0];if(r.length>1){const i={ativo:!0,empresas:!0};if(e=await $g.promptContato.show({filtro:i,placeholder:"Selecione a empresa"}),!e){this.ocultarModal();return}}const f=(await $db.hibrido.lista({table:"empresa",where:{idContato:e.id}}))[0];if(!f){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}if(this.contatos[e.id]||await this.carregarContatos([e.id]),this.limpaCampos(this),this.compra={id:$utils.uuid(),tipo:"Compra",operacao:"Pedido de Compra",status:"Digita\xE7\xE3o",descricaoEmpresa:f.nome,numeroDocumentoEmpresa:f.numeroDocumentoNacional,descricaoContato:"",idContatoComprador:null,dataHoraEmissao:$utils.dataAtual(),tipoFrete:"CIF",tipoTransporte:null,idEmpresa:f.idContato,idContato:null,totalDesconto:0,totalPercentualDesconto:0,calcularTributacao:!0,totalComImposto:!0,naoGerarFinanceiro:!1,freteSeparado:!1,dataHoraPrevisto:null,valorBaseIcms:0,valorIcms:0,valorBaseIcmsSt:0,valorIcmsSt:0,valorFcp:0,valorFcpSt:0,valorOutrasDespesas:0},!await this.abrirModalFornecedor()){this.ocultarModal();return}this.documentoNovo=!0,this.exibeInfNota=!0,this.visivel=!0})},async validaCampos(){try{if($utils.verificarErro(!this.compra.descricaoContato,"N\xE3o \xE9 permitido finalizar a compra sem informar o fornecedor!"),$utils.verificarErro(!this.compraItens.length,"N\xE3o \xE9 permitido finalizar compra sem itens!"),!this.compra.naoGerarFinanceiro){const r=$utils.arredondar(this.compraCondicoesDePagamento.reduce((e,f)=>e+f.valor,0));$utils.verificarErro(!this.compra.formaDePagamento,"N\xE3o \xE9 permitido finalizar a compra sem informar a forma de pagamento!"),$utils.verificarErro(this.compraCondicoesDePagamento.length>0&&this.compra.totalDocumento!==r,"N\xE3o \xE9 permitido finalizar a compra se o valor total difere da soma das parcelas!"),$utils.verificarErro(this.compraCondicoesDePagamento.length===0,'Verifique se a op\xE7\xE3o "N\xE3o gerar financeiro" est\xE1 marcada, ou adicione as parcelas para finalizar a compra!')}return this.compra.operacao==="Nota de Entrada"&&($utils.verificarErro(!this.compra.notaNumero,"N\xE3o \xE9 permitido finalizar a compra sem informar o n\xFAmero da Nota de Entrada!"),$utils.verificarErro(!this.compra.notaSerie,"N\xE3o \xE9 permitido finalizar a compra sem informara s\xE9rie da Nota de Entrada!"),$utils.verificarErro(!this.compra.naturezaOperacao,"N\xE3o \xE9 permitido finalizar a compra sem informar natureza de opera\xE7\xE3o da Nota de Entrada!"),$utils.verificarErro(!this.compra.dataCompra,"N\xE3o \xE9 permitido finalizar a compra sem informar a data de compra da Nota de Entrada!"),$utils.verificarErro(!this.compra.chaveAcesso,"N\xE3o \xE9 permitido finalizar a compra sem informar a chave de acesso da Nota de Entrada!")),!0}catch(r){return $q.notifyError("Ocorreu um erro na valida\xE7\xE3o de campos",r),!1}},async finalizar_click(){if(!await this.validaCampos())return;let r=!this.compra.naoGerarFinanceiro;await $tryLoading(async()=>{this.compra.status="Finalizado",this.compra.dataHoraFinalizado=$utils.dataAtual(),this.compra.provisaoCompra=r?1:void 0,await this.finalizarItens(),r?await this.gerarFinanceiro():(this.compraTitulos=[],this.compraMovimentacoes=[]),await this.salvar(),this.$emit("atualizar",{aba:"Finalizado"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi finalizada com sucesso!":"O Pedido de Compra foi finalizada com sucesso!"),r&&$q.notifyPositive("Provisionamento gerado com sucesso!")},{mensagem:"Finalizando Compra..."})},finalizarItens(){var s,d;let r=1,e=0,f=0,_=!1;const i=this.compra;if(i.subTotalProduto>0&&(i.tipoFrete==="FOB"&&i.freteSeparado===0&&(e=(i.valorFrete||0)+(i.valorSeguro||0)),r=((i.subTotalProduto||0)+(i.valorOutrasDespesas||0)-(i.totalDesconto||0)+(e||0))/(i.subTotalProduto||1)),f=this.compraItens.reduce((a,m)=>a+m.valorIcmsSt,f),f!==i.valorIcmsSt&&(_=!0),i.operacao==="Nota de Entrada")for(const a of this.compraItens)_&&(a.valorIcmsSt=i.valorIcmsSt*((a==null?void 0:a.total)||0)/(i.subTotalProduto>0?i.subTotalProduto:1)),a.valorFreteRateado=i.valorFrete*(((a==null?void 0:a.total)||0)/(i.subTotalProduto||1)),a.valorSeguroRateado=i.valorSeguro*(((a==null?void 0:a.total)||0)/(i.subTotalProduto||1)),a.valorOutrasDespesasRateado=(i.valorOutrasDespesas||0)*(((a==null?void 0:a.total)||0)/(i.subTotalProduto||1)),a.descontoTotalRateado=(i.totalDesconto||0)*(((a==null?void 0:a.total)||0)/(i.subTotalProduto||1)),(a==null?void 0:a.valorIcmsSt)-(a==null?void 0:a.valorIcms)>0&&((a==null?void 0:a.valorIcmsSt)||0)-((a==null?void 0:a.valorIcms)||0),a.valorRealTotal=((a==null?void 0:a.total)||0)*r+((a==null?void 0:a.valorIpi)||0)+((a==null?void 0:a.valorIcms)||0),a.valorRealTotalImpostos=((a==null?void 0:a.total)||0)+a.valorFreteRateado+a.valorSeguroRateado+a.valorOutrasDespesasRateado-a.descontoTotalRateado+((a==null?void 0:a.valorIpi)||0)+((a==null?void 0:a.valorIcmsSt)||0)+((a==null?void 0:a.valorFcpSt)||0),a.valorReal=a.valorRealTotalImpostos/((a==null?void 0:a.quantidade)||1),a.valorCustoReposicao=((s=this.produtos[a.idItem])==null?void 0:s.valorCustoReposicao)||0;if(i.operacao==="Pedido de Compra")for(const a of this.compraItens){_&&(a.valorIcmsSt=$utils.arredondar(i.valorIcmsSt*(a.total||0)/(i.subTotalProduto>0?i.subTotalProduto:1))),a.valorFreteRateado=$utils.arredondar((i.valorFrete||0)*(a.total||0)/(i.subTotalProduto||1),4),a.valorSeguroRateado=$utils.arredondar((i.valorSeguro||0)*(a.total||0)/(i.subTotalProduto||1),4),a.valorOutrasDespesasRateado=$utils.arredondar((i.valorOutrasDespesas||0)*(a.total||0)/(i.subTotalProduto||1),4),a.descontoTotalRateado=$utils.arredondar((i.totalDesconto||0)*(a.total||0)/(i.subTotalProduto||1),4);let m=0;a.valorIcmsSt-a.valorIcms>0&&(m=$utils.arredondar((a.valorIcmsSt||0)-(a.valorIcms||0),2)),a.valorRealTotal=$utils.arredondar((a.total||0)*r+(a.valorIpi||0)+(m>0?m:0),2),a.valorRealTotalImpostos=$utils.arredondar((a.total||0)+a.valorFreteRateado+a.valorSeguroRateado+a.valorOutrasDespesasRateado-a.descontoTotalRateado+(a.valorIpi||0)+(a.valorIcmsSt||0)+(a.valorFcpSt||0),4),a.valorReal=$utils.arredondar(a.valorRealTotalImpostos/(a.quantidade||1),4),a.valorCustoReposicao=$utils.arredondar(((d=this.produtos[a.idItem])==null?void 0:d.valorCustoReposicao)||0,2)}},async transformarEmNotaDeEntrada_click(){this.compra.operacao==="Pedido de Compra"&&await $tryLoading(async()=>{var f;const r=this.compraItens.map(({idItem:_})=>_).filter(Boolean),e=await $db.hibrido.lista({table:"itemFornecedor",whereIn:{idItem:r},whereFilter:{idContato:this.compra.idContato}});for(const _ of this.compraItens)if(!e.some(({idItem:i})=>i===_.idItem)){const i={id:$utils.uuid(),idItem:_.idItem,idContato:this.compra.idContato,referencia:"",descricao:_.descricaoItem};await $db.hibrido.grava("itemFornecedor",{atual:i,original:{}})}for(const _ of this.compraTitulos)_.formaDePagamento=(f=this.compra.formaDePagamento)!=null?f:"";this.compra.operacao="Nota de Entrada",this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",await this.salvar(),$q.notifyPositive("Nota de Entrada gerada com sucesso!")},{mensagem:"Processando..."})},async mostrar({id:r}){this.visivel=!0;const e=$utils.logarIni("ComprasFicha");await $tryLoading(async()=>{this.compra.id=r,await this.atualizar()}),$utils.logarFim(e,1)},fechar(){this.compra.status==="Finalizado"?this.$emit("atualizar",{aba:"Finalizado"}):this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),this.produtos=[],this.limpaCampos(this),this.formasDePagamento=[],this.documentoNovo=!1,this.exibeInfNota=!1,this.valorTotalPagamento=0},ocultarModal(){this.visivel=!1},async abrirModalEmpresa(){const r={ativo:!0,empresas:!0},e=await $g.promptContato.show({filtro:r,placeholder:"Selecione"});if(!e)return;let f=(await $db.hibrido.lista({table:"empresa",where:{idContato:e.id}}))[0];if(!f){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}this.contatos[e.id]||await this.carregarContatos([e.id]),this.compra.descricaoEmpresa=f.nome,this.compra.idEmpresa=f.idContato,this.compra.numeroDocumentoEmpresa=f.numeroDocumentoNacional,this.compra.InscricaoMunicipalEmpresa=f.InscricaoMunicipalEmpresa},async abrirModalComprador(){const r=await this.selecionarContato({placeholder:"Selecione o comprador",filtro:{ativo:!0,compradores:!0}});r.id&&(this.compra.idContatoComprador=r.id),this.contatos[r.id]||await this.carregarContatos([r.id])},async abrirModalFornecedor(){const r={ativo:!0},e=await $g.promptContato.show({filtro:r,placeholder:"Selecione o fornecedor"});if(!e)return e;const f=await $db.contatoTelefone.le({idContato:e.id}),_=await $db.contatoEndereco.le({idContato:e.id}),i=f.find(a=>a.tipoTelefone==="Principal"||a.tipoTelefone==="WhatsApp")||f[0]||null,s=_.find(a=>a.grupo==="Principal")||_[0]||null;let d;return s&&Object.keys(s).length>0&&(d=`${s.logradouro}, ${s.numero} ${s.complemento} - ${s.bairro} - ${s.municipio}/${s.uf}`),e.id&&(this.compra.idContato=e.id,this.compra.descricaoContato=e.nome,this.compra.numeroDocumentoContato=e.numeroDocumentoNacional,this.compra.emailContato=(e==null?void 0:e.email)||null,this.compra.regimeContato=(e==null?void 0:e.regime)||null,this.compra.telefoneContato=(i==null?void 0:i.telefone)||null,this.compra.descricaoContatoEndereco=d||null),this.contatos[e.id]||await this.carregarContatos([e.id]),e},async abrirModalVendedor(){const r=(await $db.contato.leFilhos(this.compra.idContato)).map(f=>f.id),e=await this.selecionarContato({placeholder:"Selecione o vendedor",filtro:{ativo:!0,usuarios:r}});e.id&&(this.compra.idContatoVendedor=e.id),this.contatos[e.id]||await this.carregarContatos([e.id])},async abrirModalTransportador(){const r=await this.selecionarContato({placeholder:"Selecione o transportadora",filtro:{ativo:!0,transportadoras:!0}});r.id&&(this.compra.idContatoTransportadora=r.id),this.contatos[r.id]||await this.carregarContatos([r.id])},async selecionarContato(r){const{placeholder:e,filtro:f}={placeholder:"Selecione o contato",filtro:{ativo:!0},...r},_=await $g.promptContato.show({filtro:f,placeholder:e});if(!_)throw new Error("Contato n\xE3o selecionado");return _},async adicionarItem(){let r={},e=[];for(const f of e)r[f.idItem]={item:await $db.hibrido.le({table:"item",id:f.idItem}),quantidade:f.quantidade};this.adicionar.modal.value=!0,this.adicionar.modal.name="Item"},trocarItens(r){const e=Object.keys(r)[0],f=r[e].item;this.produtos[e]=f},async selecionarItens(r){var e,f;for(const _ in r){let i=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",whereFilter:{idEmpresa:this.compra.idEmpresa,tipoEstoque:"Dispon\xEDvel",idItem:_}});i=i[0];const s=await $db.configuracoes.porNome("vendas.checaestoque",this.compra.idEmpresa);Number((e=s.find(l=>l.id))==null?void 0:e.valor);const d=r[_].item||{},a=((f=(await $db.hibrido.lista({table:"itemFornecedor",whereFilter:{idItem:d.id}}))[0])==null?void 0:f.referencia)||null,m=r[_].quantidade||0,h=(d==null?void 0:d.valorCustoReposicao)||(i==null?void 0:i.valorCustoMedio)||0;let I=this.compraItens.find(l=>l.idItem===_);const b=(await $erp().cfop.where({cfop:5102}).toArray())[0],n=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral");if(I)I.quantidade=$utils.arredondar(m,4),I.quantidadeRealizado=$utils.arredondar(m,4),I.subTotal=$utils.arredondar(h,2),I.total=$utils.arredondar(m*h,2);else{const l={dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:"",descricaoItem:d.descricao,id:$utils.uuid(),idDocumento:this.compra.id,idItem:d.id,referencia:d.referencia,referenciaFornecedor:a,ncm:d.ncm||null,operacao:"Compra de Mercadoria",operacaoFator:1,idCfop:b==null?void 0:b.id,idPlanoContaEstoque:n==null?void 0:n.id,quantidade:$utils.arredondar(m,4),quantidadeRealizado:$utils.arredondar(m,4),status:"Digita\xE7\xE3o",tipoItem:d.tipo,subTotal:$utils.arredondar(h,2),total:$utils.arredondar(m*h,2),unidade:d.unidade,valorCustoMedio:(i==null?void 0:i.valorCustoMedio)||0,valorItem:h,valorOriginal:h,observacao:""};this.compraItens.push(l),await this.carregarItens([d.id])}this.compra.subTotal=0,this.compra.subTotalProduto=0;for(let l in this.compraItens)this.compra.subTotal+=this.compraItens[l].total,this.compra.subTotalProduto+=this.compraItens[l].total;this.compra.subTotal=$utils.arredondar(this.compra.subTotal,2),this.compra.totalDocumento=this.compra.subTotal}},calcularTotaisItem(r,e){const f=$utils.clonar(this.compraItens[r]);f.valorOriginal;const _=f.quantidade||0;let i=f.valorItem||0,s=f.descontoPercentualItem||0,d=f.descontoItem||0,a=f.subTotal||0,m=f.total||0;e==="descontoPercentualItem"&&((s<0||s>100)&&(s=0),d=i*s/100,a=i-d),e==="descontoItem"&&((d<0||d>i)&&(d=0),s=d/i*100,a=i-d),e==="valorItem"&&(d>i&&(d=0,s=0),s=d/i*100,a=i-d),e==="subTotal"&&((a<0||a>i)&&(a=i),d=i-a,s=d/i*100),m=_*a,f.valorItem=i,f.descontoItem=d,f.descontoPercentualItem=s,f.subTotal=a,f.total=m,this.compraItens[r]=f,this.calcularTotais("totalDesconto")},calcularTotais(r,e,f){const _=e||$utils.clonar(this.compra),i=f||this.compraItens;let s=0,d=0,a=0,m=_.totalDesconto||0,h=_.totalPercentualDesconto||0,I=_.valorFrete||0,b=_.valorSeguro||0,n=_.valorOutrasDespesas||0,l=0,C=0,g=0,w=0,u=0,y=0,v=0;this.erroFrete=!1,this.erroSeguro=!1,this.erroOutrasDespesas=!1;for(const V of i)s+=V.total,l+=V.valorBaseIcms||0,C+=V.valorIcms||0,g+=V.valorBaseIcmsSt||0,w+=V.valorIcmsSt||0,u+=V.valorFcp||0,y+=V.valorFcpSt||0,v+=V.valorIpi||0;r==="totalPercentualDesconto"&&(this.erroDesconto=!1,(h<0||h>100)&&(this.erroDesconto=!0),m=s*h/100),r==="totalDesconto"&&(this.erroDesconto=!1,(m<0||m>s)&&(this.erroDesconto=!0),h=m/s*100),I<0&&(this.erroFrete=!0),I=_.tipoFrete==="FOB"?I:0,b<0&&(this.erroSeguro=!0),b=_.tipoFrete==="FOB"?b:0,n<0&&(this.erroOutrasDespesas=!0),_.calcularTributacao||(l=0,C=0,g=0,w=0,u=0,y=0),_.totalComImposto||(v=0),d=s-m+I+b+n,a=d+v+w+y,_.valorBaseIcms=$utils.arredondar(l,2),_.valorIcms=$utils.arredondar(C),_.valorBaseIcmsSt=$utils.arredondar(g),_.valorIcmsSt=$utils.arredondar(w),_.valorFcp=$utils.arredondar(u),_.valorFcpSt=$utils.arredondar(y),_.valorIpi=$utils.arredondar(v),_.totalDesconto=$utils.arredondar(m),_.totalPercentualDesconto=$utils.arredondar(h),_.subTotalProduto=$utils.arredondar(s),_.totalProduto=$utils.arredondar(s)-$utils.arredondar(m),_.subTotal=$utils.arredondar(d),_.totalDocumento=$utils.arredondar(a),e||(this.compra=_)},limpaCampos(r){r.compra={},r.compraOriginal={},r.compraItens=[],r.compraItensOriginal=[],r.compraCondicoesDePagamento=[],r.compraCondicoesDePagamentoOriginal=[],r.compraTitulos=[],r.compraTitulosOriginal=[],r.compraMovimentacoes=[],r.compraMovimentacoesOriginal=[],r.compraDocumentoXml=[],r.compraDocumentoXmlOriginal=[],r.dataPrevistaEntrega="",r.horaPrevistaEntrega=""},async salvar(){this.compra.totalComImposto&&delete this.compra.totalComImposto;for(const e of this.compraItens)e.dataHoraFinalizado=this.compra.dataHoraFinalizado,e.status=this.compra.status;const r=[];this.compra.id?await $db.hibrido.preGrava(r,"documento",{atual:this.compra,original:this.compraOriginal}):this.compraOriginal.id&&await $db.hibrido.preRemove(r,"documento",this.compraOriginal),await $db.hibrido.preGravaLista(r,"documentoItem",{atual:this.compraItens,original:this.compraItensOriginal}),await $db.hibrido.preGravaLista(r,"documentoCondicaoPagamento",{atual:this.compraCondicoesDePagamento,original:this.compraCondicoesDePagamentoOriginal}),await $db.hibrido.preGravaLista(r,"financeiroTitulo",{atual:this.compraTitulos,original:this.compraTitulosOriginal}),await $db.hibrido.preGravaLista(r,"financeiroMovimentacao",{atual:this.compraMovimentacoes,original:this.compraMovimentacoesOriginal}),await $db.hibrido.preGravaLista(r,"documentoXML",{atual:this.compraDocumentoXml,original:this.compraDocumentoXmlOriginal}),await $db.hibrido.enviaLote(r),this.compra.totalComImposto=!0,this.calculaKardex()},async calculaKardex(){const r=$utils.logarIni("calculaKardex"),e=this.compraItens.map(({idItem:f})=>f).filter(Boolean);try{e.length&&await $utils.geeksApi({calculaKardex:{funcao:"9913E9FD-24A5-4C0A-9F1E-AACCDC7EAB9D",idsItem:e}})}catch(f){console.error(`Erro ao calcular Kardex
`,f)}$utils.logarFim(r,e.length)},async reabrir_click(){var e;const r=(e=this.compraTitulos)!=null&&e.length?this.compra.operacao==="Nota de Entrada"?"<strong>A movimenta\xE7\xE3o financeira ser\xE1 retornada ao status de provisionada!</strong>":"<strong>O Financeiro ser\xE1 apagado!</strong>":"";!await $q.dialogSimNao({title:"Reabertura",message:`Deseja reabrir o documento?<br/>${r}`,html:!0})||await $tryLoading(async()=>{await this.retornarParaDigitacao(),await this.salvar(),await this.atualizar(),$q.notifyPositive("Documento reaberto para digita\xE7\xE3o!")},{mensagem:"Reabrindo..."})},async retornarParaDigitacao(){$utils.verificarErro(this.compra.status!=="Finalizado","N\xE3o \xE9 poss\xEDvel realizar esta opera\xE7\xE3o em documento n\xE3o finalizado.");const r=this.compraTitulos.filter(({dataPagamento:e})=>e);$utils.verificarErro(r.length,"N\xE3o \xE9 poss\xEDvel excluir o Financeiro. Parcelas provisionadas j\xE1 pagas!"),this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",this.compra.operacao==="Pedido de Compra"&&(this.compraTitulos=[],this.compraMovimentacoes=[]),this.compra.operacao==="Nota de Entrada"&&this.compraTitulos.forEach(e=>{e.formaDePagamento=`Provis\xE3o Pedido - ${e.formaDePagamento}`})},async removerPagamento_click(r){try{this.compraCondicoesDePagamento=this.compraCondicoesDePagamento.filter(e=>e.id!==r.id),this.compraCondicoesDePagamento.sort((e,f)=>{let _=new Date(e.dataVencimento),i=new Date(f.dataVencimento);return _-i}),await this.atualizaValorTotalPagamento({condicao:r,acao:"remover"})}catch(e){console.log(e.message)}},async gerarCondicoesDePagamento_click(){var r;try{let e=this.compra.id,f=this.compra.condicaoPagamento,_=(r=this.compra.notaNumero)!=null?r:null;this.compra.naoGerarFinanceiro||await this.gerarParcelamento(e,f,_),this.compra.naoGerarFinanceiro&&(this.compraCondicoesDePagamento=[])}catch(e){console.log(e.message)}},async gerarParcelamento(r,e,f){this.compraCondicoesDePagamento=[];const _=$utils.clonar(this.compra),i=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`,s=ze.formatDate(i)||_.dataHoraPrevisto,d=_.dataCompra||s||$utils.dataAtual(),a=e.split("/"),m=a.length,h=(_==null?void 0:_.freteSeparado)||0;let I=$utils.arredondar(_==null?void 0:_.totalDocumento,2);const b=$utils.arredondar(((_==null?void 0:_.valorFrete)||0)+((_==null?void 0:_.valorSeguro)||0),2);if(h&&(_==null?void 0:_.tipoFrete)==="FOB"&&b>0){let C;s?C=new Date(s):(C=new Date(d),C.setDate(C.getDate()+Number(a[0]||0)));let g={id:$utils.uuid(),idDocumento:_==null?void 0:_.id,dataVencimento:ze.formatDate(C),valor:b,observacao:"Valor Frete + Seguro",freteSeparado:!0};this.compraCondicoesDePagamento.push(g),I-=b}let n=0,l=$utils.arredondar(I/m,2);for(let C in a){let g=new Date(d);g.setDate(g.getDate()+Number(a[C]||0));let w={id:$utils.uuid(),idDocumento:_==null?void 0:_.id,dataVencimento:ze.formatDate(g),valor:l,observacao:""};this.compraCondicoesDePagamento.push(w),n+=l||0}n=$utils.arredondar(n||0,2),I=$utils.arredondar(I||0,2),I!==n&&(this.compraCondicoesDePagamento[0].valor=$utils.arredondar(this.compraCondicoesDePagamento[0].valor+I-n,2)),this.valorTotalPagamento=h&&(_==null?void 0:_.tipoFrete)==="FOB"?$utils.arredondar(I+b,2):I},async gerarFinanceiro(){var d,a;const r=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral"),e=[];for(const m of this.compraItens){if(m.idPlanoContaEstoque===r.id)continue;const h=(m.total||0)-(m.descontoTotalRateado||0),I=e.findIndex(({idPlanoContaEstoque:b})=>b===m.idPlanoContaEstoque);I!==-1?e[I].valor+=h:e.push({idPlanoContaEstoque:m.idPlanoContaEstoque,idPlanoContaDestino:"",valor:h,porcentagem:0})}for(const m of e)m.valor=$utils.arredondar(m.valor),m.porcentagem=$utils.arredondar(m.valor/this.compra.totalDocumento,4);const f=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.freteaquisicao"),_=this.compraTitulos.filter(({dataPagamento:m})=>m);$utils.verificarErro(_.length,"N\xE3o \xE9 poss\xEDvel regerar o Financeiro. Parcelas provisionadas j\xE1 pagas!");const i=ze.formatDate(new Date().setHours(0,0,0,0));this.compraTitulos=[];for(const m in this.compraCondicoesDePagamento){const h=this.compraCondicoesDePagamento[m],I=[h.observacao,this.compra.codigoDocumento?`Pedido de Compra: ${this.compra.codigoDocumento}`:"",this.compra.notaNumero?`Nota nro: ${this.compra.notaNumero}`:""].filter(Boolean).join(" | "),b={id:$utils.uuid(),dataEmissao:i,dataCompetencia:i,dataVencimento:ze.formatDate(new Date(h.dataVencimento).setHours(0,0,0,0)),dataVencimentoOriginal:ze.formatDate(new Date(h.dataVencimento).setHours(0,0,0,0)),valor:$utils.arredondar(h.valor,2),tipoJuros:"dia",valorMulta:0,percentualJuros:0,documentoTipo:this.compra.operacao,parcela:`${Number(m)+1}/${this.compraCondicoesDePagamento.length}`,descricao:this.compra.operacao,observacao:I,formaDePagamento:this.compra.operacao==="Pedido de Compra"?`Provis\xE3o Pedido - ${(d=this.compra.formaDePagamento)!=null?d:""}`:(a=this.compra.formaDePagamento)!=null?a:"",receberPagar:0,valorOriginal:$utils.arredondar(h.valor,2),documentoVinculado:1,valorTotal:$utils.arredondar(h.valor,2),valorARealizar:$utils.arredondar(h.valor,2),valorDesconto:0,percentualDesconto:0,idEmpresa:this.compra.idEmpresa,idContato:(h==null?void 0:h.freteSeparado)&&!!this.compra.idContatoTransportadora?this.compra.idContatoTransportadora:this.compra.idContato,idFinanceiroPlanoConta:h.observacao==="Valor Frete + Seguro"?f.id:r==null?void 0:r.id,documentoId:this.compra.id,idFinanceiroMovimentacaoAgrupamentoAutomatico:$utils.uuid(),cobrancaAtivo:1};this.compraTitulos.push(b)}const s=$utils.uuid();this.compraMovimentacoes=[];for(const m of e){const h={id:$utils.uuid(),idFinanceiroMovimentacaoN:s,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:r.id,dataEmissao:i,valorCredito:this.compra.totalDocumento*m.porcentagem,valorDebito:0,descricao:r.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:i,dataVencimento:i,dataMovimento:i,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(h);const I=await $db.financeiroPlanoConta.leCache({id:m.idPlanoContaEstoque}),b={id:$utils.uuid(),idFinanceiroMovimentacaoN:s,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:m.idPlanoContaEstoque,dataEmissao:i,valorCredito:0,valorDebito:this.compra.totalDocumento*m.porcentagem,descricao:I.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:i,dataVencimento:i,dataMovimento:i,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(b)}},async atualizaValorTotalPagamento({condicao:r,acao:e}){!r||e==="remover"&&(this.valorTotalPagamento=this.valorTotalPagamento-r.valor)},async ajustarPrevisaoEntrega(r){r==="alterar"&&(this.alterarPrevisaoEntrega=!0),r==="salvar"&&(await $tryLoading(async()=>{const e=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;$utils.verificarErro(!this.dataPrevistaEntrega&&this.horaPrevistaEntrega,"\xC9 necess\xE1rio preencher uma data em conjunto com a hora."),ze.formatDate(e)!==ze.formatDate(this.compra.dataHoraPrevisto)?(this.compra.dataHoraPrevisto=ze.formatDate(e)||"",await this.salvar(),await this.atualizar(),$q.notifyPositive("A previs\xE3o foi salva com sucesso")):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")}),this.alterarPrevisaoEntrega=!1)},dialogImprimirEtiquetas(r,e){this.$emit("dialogImprimirEtiquetas",{acao:r,item:e})},resize(){this.tela={width:$utils.tela("ComprasFicha").width,pageWidth:$utils.tela("ComprasFichaPage").width}}}},Wt={id:"Fatura",class:"bg-white rounded-borders"},Xt={class:"bg-grey-2 rounded-borders q-px-xs"},Qt={class:"CompraItem bg-white rounded-borders q-px-xs q-mb-sm"},Kt={class:"bg-grey-2 rounded-borders q-pa-sm"},Yt={class:"flex items-center justify-center",style:{height:"40px"}},Jt={class:"flex items-center justify-center",style:{height:"40px"}},ea={class:"flex items-center justify-center",style:{height:"40px"}},ta={class:"text-weight-bold"},aa={class:"text-weight-bold"},oa={class:"text-weight-bold"};function ra(r,e,f,_,i,s){const d=pe("g-label"),a=pe("g-col"),m=pe("Badge"),h=pe("BadgeCopiarUid"),I=pe("g-row"),b=pe("avatar"),n=pe("campo"),l=pe("badge"),C=pe("badgeCopiarUid"),g=pe("SeletorItem"),w=pe("ModalEditarProdutoCompras"),u=pe("PromptItemV2"),y=xt("mask");return R(),_e(Ve,null,[t($e,{modelValue:r.visivel,"onUpdate:modelValue":e[42]||(e[42]=v=>r.visivel=v),persistent:"",maximized:"",onKeyup:mt(s.fechar,["esc"]),id:"ComprasFicha"},{default:o(()=>[t(je,{view:"hHh lpR lFr",container:"",class:"bg-light"},{default:o(()=>[t(wt,{onResize:e[0]||(e[0]=v=>s.resize())}),t(He,null,{default:o(()=>[t(xe,null,{default:o(()=>[t(ce,{onClick:s.fechar,icon:"arrow_back",flat:"",round:"",dense:""},null,8,["onClick"]),t(Le,null,{default:o(()=>[x(ae(r.compra.operacao),1)]),_:1}),be(t(ce,{onClick:s.salvar_click,unelevated:"",label:"Salvar",color:"white","text-color":"primary",class:"q-ml-sm"},null,8,["onClick"]),[[Oe,r.compra.status==="Digita\xE7\xE3o"]])]),_:1})]),_:1}),t(Ze,null,{default:o(()=>[t(Ge,{id:"ComprasFichaPage",class:"u-container q-py-md"},{default:o(()=>[ge("div",Wt,[t(I,{gutter:"sm"},{default:o(()=>[t(a,{col:"12 sm12 md6"},{default:o(()=>[t(I,{items:"center",justify:"end",class:"hideondesktop"},{default:o(()=>[t(a,{col:"xs-shrink",order:"1 sm0"},{default:o(()=>[be(t(d,{caption:"",tip:`Emitido \xE1s ${r.$filters.hora(r.compra.dataHoraEmissao)}`},{default:o(()=>[t(ie,{name:"mdi-calendar-today",size:"sm"}),x(" "+ae(r.$filters.data(r.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[Oe,r.compra.dataHoraEmissao]])]),_:1}),t(a,{col:"xs-shrink",order:"1 sm0"},{default:o(()=>[be(t(d,{caption:"",tip:`Finalizado \xE1s ${r.$filters.hora(r.compra.dataHoraFinalizado)}`},{default:o(()=>[t(ie,{name:"mdi-calendar-today",size:"xs"}),x(" "+ae(r.$filters.data(r.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[Oe,r.compra.dataHoraFinalizado]])]),_:1}),t(a,{col:"xs12 sm-shrink",order:"0 sm1"},{default:o(()=>[t(I,{items:"center",justify:"end"},{default:o(()=>[t(m,{rotulo:r.compra.status,escuro:r.compra.status!=="Digita\xE7\xE3o",cor:r.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",class:"q-ml-sm"},null,8,["rotulo","escuro","cor"]),t(h,{id:r.compra.id,numero:r.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"]),t(ce,{color:"tertiary",flat:"",icon:"more_vert",round:""},{default:o(()=>[t(Re,null,{default:o(()=>[be((R(),W(qe,{link:"",separator:""},{default:o(()=>[r.alterarPrevisaoEntrega?(R(),W(fe,{key:1,clickable:"",onClick:e[2]||(e[2]=v=>s.ajustarPrevisaoEntrega("salvar"))},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"local_shipping"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[45]||(e[45]=[x("Salvar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1})):(R(),W(fe,{key:0,disable:r.compra.status==="Digita\xE7\xE3o",clickable:"",onClick:e[1]||(e[1]=v=>s.ajustarPrevisaoEntrega("alterar"))},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"local_shipping"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[44]||(e[44]=[x("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1},8,["disable"])),t(fe,{onClick:e[3]||(e[3]=v=>s.dialogImprimirEtiquetas("adicionar",r.compra)),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[46]||(e[46]=[x(" Adicionar Etiquetas ")])),_:1})]),_:1})]),_:1}),t(fe,{onClick:e[4]||(e[4]=v=>s.dialogImprimirEtiquetas("impressao",r.compra)),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[47]||(e[47]=[x(" Imprimir Etiquetas ")])),_:1})]),_:1})]),_:1})]),_:1})),[[Ee]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(I,null,{default:o(()=>[t(a,{col:"12 sm6"},{default:o(()=>[t(I,null,{default:o(()=>[t(a,{col:"xs-shrink"},{default:o(()=>{var v,V;return[t(b,{imagem:(v=r.contatos[r.compra.idContato])==null?void 0:v.imagem,rotulo:(V=r.contatos[r.compra.idContato])==null?void 0:V.apelido,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:1}),t(a,{col:"xs"},{default:o(()=>{var v;return[t(n,{modelValue:(v=r.contatos[r.compra.idContato])==null?void 0:v.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){s.abrirModalFornecedor()}}],disable:r.compra.status!=="Digita\xE7\xE3o",rotulo:"Fornecedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1})]),_:1})]),_:1}),t(a,{col:"12 sm6"},{default:o(()=>{var v;return[t(n,{modelValue:(v=r.contatos[r.compra.idContatoVendedor])==null?void 0:v.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalVendedor()}}],rotulo:"Vendedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(a,{col:"12 sm6"},{default:o(()=>{var v;return[t(n,{modelValue:(v=r.contatos[r.compra.idEmpresa])==null?void 0:v.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){s.abrirModalEmpresa()}}],disable:r.compra.status!=="Digita\xE7\xE3o",rotulo:"Empresa",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1}),t(a,{col:"12 sm6"},{default:o(()=>{var v;return[t(n,{modelValue:(v=r.contatos[r.compra.idContatoComprador])==null?void 0:v.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalComprador()}}],rotulo:"Comprador",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(a,{col:"12 sm6"},{default:o(()=>{var v;return[t(n,{modelValue:(v=r.contatos[r.compra.idContatoTransportadora])==null?void 0:v.apelido,"somente-leitura":"",disable:r.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalTransportador()}}],rotulo:"Transportadora",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(a,{col:"12 sm6"},{default:o(()=>[t(I,null,{default:o(()=>[t(a,{col:"7"},{default:o(()=>[t(Qe,{modelValue:r.dataPrevistaEntrega,"onUpdate:modelValue":e[5]||(e[5]=v=>r.dataPrevistaEntrega=v),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1}),t(a,{col:"5"},{default:o(()=>[t(Qe,{modelValue:r.horaPrevistaEntrega,"onUpdate:modelValue":e[6]||(e[6]=v=>r.horaPrevistaEntrega=v),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(a,{col:"12 sm12 md6"},{default:o(()=>[t(I,{justify:"end",items:"center",text:"right",class:"hideonmobile"},{default:o(()=>[t(a,{col:"shrink"},{default:o(()=>[be(t(d,{caption:"",tip:`Emitido \xE1s ${r.$filters.hora(r.compra.dataHoraEmissao)}`},{default:o(()=>[t(ie,{name:"mdi-calendar-today",size:"xs"}),x(" "+ae(r.$filters.data(r.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[Oe,r.compra.dataHoraEmissao]])]),_:1}),t(a,{col:"shrink"},{default:o(()=>[be(t(d,{caption:"",tip:`Finalizado \xE1s ${r.$filters.hora(r.compra.dataHoraFinalizado)}`},{default:o(()=>[t(ie,{name:"mdi-calendar",size:"xs"}),x(" "+ae(r.$filters.data(r.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[Oe,r.compra.dataHoraFinalizado]])]),_:1}),t(a,{col:"12 sm-shrink"},{default:o(()=>[t(I,{justify:"end",items:"center"},{default:o(()=>[t(l,{rotulo:r.compra.status,escuro:r.compra.status!=="Digita\xE7\xE3o",cor:r.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",class:"q-ml-sm"},null,8,["rotulo","escuro","cor"]),t(C,{id:r.compra.id,numero:r.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"]),t(ce,{color:"tertiary",flat:"",icon:"more_vert",round:""},{default:o(()=>[t(Re,null,{default:o(()=>[be((R(),W(qe,{link:"",separator:""},{default:o(()=>[r.alterarPrevisaoEntrega?(R(),W(fe,{key:1,clickable:"",onClick:e[8]||(e[8]=v=>s.ajustarPrevisaoEntrega("salvar"))},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"local_shipping"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[49]||(e[49]=[x("Salvar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1})):(R(),W(fe,{key:0,disable:r.compra.status==="Digita\xE7\xE3o",clickable:"",onClick:e[7]||(e[7]=v=>s.ajustarPrevisaoEntrega("alterar"))},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"local_shipping"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[48]||(e[48]=[x("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:1},8,["disable"])),t(fe,{onClick:e[9]||(e[9]=v=>s.dialogImprimirEtiquetas("adicionar",r.compra)),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[50]||(e[50]=[x(" Adicionar Etiquetas ")])),_:1})]),_:1})]),_:1}),t(fe,{onClick:e[10]||(e[10]=v=>s.dialogImprimirEtiquetas("impressao",r.compra)),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[51]||(e[51]=[x(" Imprimir Etiquetas ")])),_:1})]),_:1})]),_:1})]),_:1})),[[Ee]])]),_:1})]),_:1})]),_:1})]),_:1}),t(a,{col:"12"},{default:o(()=>[t(n,{modelValue:r.compra.observacao,"onUpdate:modelValue":e[11]||(e[11]=v=>r.compra.observacao=v),rotulo:"Observa\xE7\xE3o",rows:"4","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",tipo:"textoArea"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1}),t(I,{gutter:"sm"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[r.exibeInfNota?(R(),W(Xe,{key:0,class:"notaEntrada bg-grey-2","default-opened":r.compra.notaNumero>0||r.documentoNovo,"header-class":"q-px-xs"},{header:o(()=>[t(Y,null,{default:o(()=>[t(d,{text:"sub1 medium",icon:"mdi-file-replace sm tertiary left"},{default:o(()=>e[52]||(e[52]=[x("Nota de Entrada")])),_:1})]),_:1})]),default:o(()=>[t(I,{gutter:"sm"},{default:o(()=>[t(a,{col:"12 sm6 md3"},{default:o(()=>[be(t(n,{modelValue:r.compra.notaNumero,"onUpdate:modelValue":e[12]||(e[12]=v=>r.compra.notaNumero=v),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Numero",dense:""},null,8,["modelValue","somente-leitura"]),[[y,"##########"]])]),_:1}),t(a,{col:"12 sm6 md3"},{default:o(()=>[t(n,{modelValue:r.compra.notaSerie,"onUpdate:modelValue":e[13]||(e[13]=v=>r.compra.notaSerie=v),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Serie",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm6 md3"},{default:o(()=>[t(n,{modelValue:r.compra.naturezaOperacao,"onUpdate:modelValue":e[14]||(e[14]=v=>r.compra.naturezaOperacao=v),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Natureza da Opera\xE7\xE3o",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12 sm6 md3"},{default:o(()=>[t(n,{modelValue:r.compra.dataCompra,"onUpdate:modelValue":e[15]||(e[15]=v=>r.compra.dataCompra=v),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Data compra",tipo:"data",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"12"},{default:o(()=>[t(n,{modelValue:r.compra.chaveAcesso,"onUpdate:modelValue":e[16]||(e[16]=v=>r.compra.chaveAcesso=v),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Chave",dense:""},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1},8,["default-opened"])):oe("",!0)]),_:1})]),_:1}),t(I,{gutter:"sm"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[ge("div",Xt,[t(I,null,{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(d,{text:"sub1 medium",icon:"shopping_cart sm tertiary left"},{default:o(()=>[e[53]||(e[53]=x(" Carrinho ")),t(Ut,{flat:"",icon:"mdi-filter",size:"md",color:"tertiary",direction:"left",class:"float-right",padding:"xs"},{default:o(()=>[t(Qe,{modelValue:r.termoBusca,"onUpdate:modelValue":[e[17]||(e[17]=v=>r.termoBusca=v),e[18]||(e[18]=v=>s.buscar())],debounce:500,label:"Buscar","clear-icon":"close",standout:"",outlined:"",clearable:"",dense:"",class:"bg-white",style:_t(`width: ${r.tela.pageWidth>=768?r.tela.pageWidth/2:r.tela.pageWidth-80}px;`)},{prepend:o(()=>[t(ie,{name:"mdi-filter"})]),_:1},8,["modelValue","style"])]),_:1}),t(ce,{onClick:e[19]||(e[19]=v=>s.adicionarItem()),disable:r.compra.status!=="Digita\xE7\xE3o",icon:"add",label:"Produto",size:"md",color:"primary",flat:"",dense:"",class:"float-right q-px-sm"},null,8,["disable"])]),_:1})]),_:1}),(R(!0),_e(Ve,null,Te(r.compraItens,(v,V)=>{var D;return be((R(),W(a,{key:V,col:"12"},{default:o(()=>[ge("div",Qt,[t(I,{items:"center",justify:"between"},{default:o(()=>[t(a,{col:"auto",order:"0 sm0"},{default:o(()=>{var z;return[t(b,{imagem:(z=r.produtos[v.idItem])==null?void 0:z.imagem,rotulo:v.descricaoItem,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:2},1024),t(a,{col:"12 sm",order:"2 sm1"},{default:o(()=>{var z,A;return[t(g,{modelValue:v.idItem,"onUpdate:modelValue":$=>v.idItem=$,onSelecionarItens:s.trocarItens,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",rotulo:"Produto",class:"q-mb-xs"},null,8,["modelValue","onUpdate:modelValue","onSelecionarItens","somente-leitura"]),t(d,{caption:"",inline:"",class:"q-mr-xs"},{default:o(()=>{var $,T;return[x(ae((T=($=r.produtos[v.idItem])==null?void 0:$.marca)!=null?T:""),1)]}),_:2},1024),(z=r.produtos[v.idItem])!=null&&z.referencia?(R(),W(l,{key:0,rotulo:(A=r.produtos[v.idItem])==null?void 0:A.referencia,denso:""},null,8,["rotulo"])):oe("",!0)]}),_:2},1024),t(a,{col:"shrink",order:"1 sm2"},{default:o(()=>[t(ce,{onClick:z=>s.editarProduto(v),icon:r.compra.status==="Digita\xE7\xE3o"?"edit":"remove_red_eye",color:"primary",round:"",dense:"",flat:""},null,8,["onClick","icon"]),t(ce,{onClick:z=>s.removerItem(v),icon:"delete",color:"tertiary",disable:r.compra.status!=="Digita\xE7\xE3o",round:"",dense:"",flat:""},null,8,["onClick","disable"]),t(ce,{disable:r.compra.status!=="Digita\xE7\xE3o",round:"",dense:"",flat:"",icon:"more_vert",color:"tertiary"},{default:o(()=>[r.compra.status==="Digita\xE7\xE3o"?(R(),W(Re,{key:0},{default:o(()=>[be((R(),W(qe,{link:"",separator:""},{default:o(()=>[(R(!0),_e(Ve,null,Te(r.comprasMigrar,z=>(R(),W(fe,{key:z.id,onClick:A=>s.migrarParaOutraCompra(v,z),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"mdi-folder-move"})]),_:1}),t(Y,null,{default:o(()=>[x(ae(`Migrar para Compra #${z.numero||z.id.slice(-6)}`),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(fe,{onClick:z=>s.migrarParaOutraCompra(v),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"mdi-folder-move"})]),_:1}),t(Y,null,{default:o(()=>e[54]||(e[54]=[x("Migrar para nova Compra")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Ee]])]),_:2},1024)):oe("",!0)]),_:2},1032,["disable"])]),_:2},1024)]),_:2},1024),t(I,null,{default:o(()=>[t(a,{col:"4 md"},{default:o(()=>[t(n,{dense:"",align:"left",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Valor do produto",modelValue:v.valorItem,"onUpdate:modelValue":z=>v.valorItem=z,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o",onBlur:z=>s.calcularTotaisItem(V,"valorItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024),t(a,{col:"4 md"},{default:o(()=>[t(I,{items:"center"},{default:o(()=>[t(a,{col:"shrink"},{default:o(()=>[t(ie,{name:"mdi-minus",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{dense:"",opcoes:{maximumValue:100},tipo:"decimal",decimals:"2",rotulo:"Desconto percentual",modelValue:v.descontoPercentualItem,"onUpdate:modelValue":z=>v.descontoPercentualItem=z,outlined:"",suffix:"%","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",onBlur:z=>s.calcularTotaisItem(V,"descontoPercentualItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{col:"4 md"},{default:o(()=>[t(n,{dense:"",tipo:"decimal",modelValue:v.descontoItem,"onUpdate:modelValue":z=>v.descontoItem=z,decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Desconto em reais",prefix:"R$",onBlur:z=>s.calcularTotaisItem(V,"descontoItem"),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(a,{col:"6 md"},{default:o(()=>[t(I,{items:"center"},{default:o(()=>[t(a,{col:"shrink",class:"hideonmobile"},{default:o(()=>[t(ie,{name:"mdi-equal",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{dense:"",outlined:"",opcoes:{maximumValue:10,minimumValue:0},rotulo:"Subtotal",tipo:"decimal",decimals:"4",zerosDireita:"2",modelValue:v.subTotal,"onUpdate:modelValue":z=>v.subTotal=z,onBlur:z=>s.calcularTotaisItem(V,"subTotal"),"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{col:"6 md"},{default:o(()=>[t(I,{items:"center"},{default:o(()=>[t(a,{col:"shrink"},{default:o(()=>[t(ie,{name:"mdi-close",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{dense:"",max:"100",min:"0",outlined:"",modelValue:v.quantidade,"onUpdate:modelValue":z=>v.quantidade=z,decimals:"4",zerosDireita:"0",tipo:"quantidade",onBlur:z=>s.calcularTotaisItem(V),disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","disable"]),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[55]||(e[55]=[x("Quantidade")])),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),t(a,{col:"12 md"},{default:o(()=>[t(I,{items:"center"},{default:o(()=>[t(a,{col:"shrink",class:"hideonmobile"},{default:o(()=>[t(ie,{name:"mdi-equal",color:"primary"})]),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{dense:"",tipo:"decimal",decimals:"2",rotulo:"Total","somente-leitura":"",modelValue:v.total,"onUpdate:modelValue":z=>v.total=z,outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1024)),[[Oe,!((D=r.layoutCompraItens[v.idItem])!=null&&D.visivel)]])}),128))]),_:1})])]),_:1})]),_:1}),t(I,{gutter:"sm"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[ge("div",Kt,[t(I,{items:"center",justify:"end"},{default:o(()=>[t(a,{col:"3 sm2 md-shrink",text:"bold"},{default:o(()=>e[56]||(e[56]=[x(" Calcular ")])),_:1}),t(a,{col:"9 sm10 md",text:"right"},{default:o(()=>[t(Me,{modelValue:r.compra.calcularTributacao,"onUpdate:modelValue":[e[20]||(e[20]=v=>r.compra.calcularTributacao=v),s.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(a,{col:"6 md-shrink"},{default:o(()=>e[57]||(e[57]=[x(" Base ICMS ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:o(()=>[t(n,{dense:"",outlined:"",decimals:"2",zerosDireita:"2",tipo:"decimal",modelValue:r.compra.valorBaseIcms,"onUpdate:modelValue":e[21]||(e[21]=v=>r.compra.valorBaseIcms=v),"somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"6 md-shrink"},{default:o(()=>e[58]||(e[58]=[x(" Valor ICMS ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:o(()=>[t(n,{dense:"",outlined:"",modelValue:r.compra.valorIcms,"onUpdate:modelValue":e[22]||(e[22]=v=>r.compra.valorIcms=v),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"6 md-shrink"},{default:o(()=>e[59]||(e[59]=[x(" Base ICMS ST ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:o(()=>[t(n,{dense:"",outlined:"",modelValue:r.compra.valorBaseIcmsSt,"onUpdate:modelValue":e[23]||(e[23]=v=>r.compra.valorBaseIcmsSt=v),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"6 md-shrink"},{default:o(()=>e[60]||(e[60]=[x(" ICMS ST ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:o(()=>[t(n,{dense:"",outlined:"",modelValue:r.compra.valorIcmsSt,"onUpdate:modelValue":e[24]||(e[24]=v=>r.compra.valorIcmsSt=v),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),t(I,{items:"center",justify:"end"},{default:o(()=>[t(a,{col:"6 md-shrink"},{default:o(()=>e[61]||(e[61]=[x(" Valor FCP ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:o(()=>[t(n,{dense:"",outlined:"",modelValue:r.compra.valorFcp,"onUpdate:modelValue":e[25]||(e[25]=v=>r.compra.valorFcp=v),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(a,{col:"6 md-shrink"},{default:o(()=>e[62]||(e[62]=[x(" FCP ST ")])),_:1}),t(a,{col:"6 md",text:"right"},{default:o(()=>[t(n,{dense:"",outlined:"",modelValue:r.compra.valorFcpSt,"onUpdate:modelValue":e[26]||(e[26]=v=>r.compra.valorFcpSt=v),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!r.compra.calcularTributacao||r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})])]),_:1})]),_:1}),t(I,{gutter:"md",items:"center",justify:"end"},{default:o(()=>[t(a,{col:"xs12 sm8 md4"},{default:o(()=>[t(I,{items:"center"},{default:o(()=>[t(a,{col:"3",text:"bold"},{default:o(()=>e[63]||(e[63]=[x(" Subtotal ")])),_:1}),t(a,{col:"xs",text:"right bold"},{default:o(()=>[x(ae(r.$filters.numero(r.compra.subTotalProduto,2)),1)]),_:1})]),_:1}),t(ct,{class:"q-mb-md q-mt-xs"}),t(I,{items:"center"},{default:o(()=>[t(a,{col:"xs3"},{default:o(()=>e[64]||(e[64]=[x(" Desconto ")])),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{tipo:"decimal",decimals:"2",modelValue:r.compra.totalPercentualDesconto,"onUpdate:modelValue":e[27]||(e[27]=v=>r.compra.totalPercentualDesconto=v),onBlur:e[28]||(e[28]=v=>s.calcularTotais("totalPercentualDesconto")),suffix:"%",error:r.erroDesconto,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{tipo:"decimal",decimals:"2",modelValue:r.compra.totalDesconto,"onUpdate:modelValue":e[29]||(e[29]=v=>r.compra.totalDesconto=v),onBlur:e[30]||(e[30]=v=>s.calcularTotais("totalDesconto")),error:r.erroDesconto,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1})]),_:1}),t(I,{items:"center"},{default:o(()=>[t(a,{col:"xs3"},{default:o(()=>e[65]||(e[65]=[x(" Frete ")])),_:1}),t(a,{col:"xs"},{default:o(()=>[t(gt,{class:"q-mr-md",label:"CIF",val:"CIF",modelValue:r.compra.tipoFrete,"onUpdate:modelValue":[e[31]||(e[31]=v=>r.compra.tipoFrete=v),s.calcularTotais],dense:"",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"]),t(gt,{label:"FOB",val:"FOB",modelValue:r.compra.tipoFrete,"onUpdate:modelValue":[e[32]||(e[32]=v=>r.compra.tipoFrete=v),s.calcularTotais],dense:"",disable:r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorFrete,"onUpdate:modelValue":e[33]||(e[33]=v=>r.compra.valorFrete=v),onBlur:s.calcularTotais,error:r.erroFrete,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(I,{items:"center"},{default:o(()=>[t(a,{col:"xs3"},{default:o(()=>e[66]||(e[66]=[x(" Seguro ")])),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorSeguro,"onUpdate:modelValue":e[34]||(e[34]=v=>r.compra.valorSeguro=v),onBlur:s.calcularTotais,error:r.erroSeguro,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(I,{items:"center"},{default:o(()=>[t(a,{col:"xs5"},{default:o(()=>e[67]||(e[67]=[x(" Outras despesas ")])),_:1}),t(a,{col:"xs"},{default:o(()=>[t(n,{tipo:"decimal",decimals:"2",modelValue:r.compra.valorOutrasDespesas,"onUpdate:modelValue":e[35]||(e[35]=v=>r.compra.valorOutrasDespesas=v),onBlur:s.calcularTotais,error:r.erroOutrasDespesas,"somente-leitura":r.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(ct,{class:"q-mt-md q-mb-xs"}),t(I,{items:"center"},{default:o(()=>[t(a,{col:"xs4",text:"bold"},{default:o(()=>e[68]||(e[68]=[x(" Total ")])),_:1}),t(a,{col:"xs",text:"right bold"},{default:o(()=>[x(ae(r.$filters.numero(r.compra.totalProduto,2)),1)]),_:1})]),_:1}),r.compra.totalComImposto?(R(),W(I,{key:0,items:"center"},{default:o(()=>[t(a,{col:"xs4",text:"bold"},{default:o(()=>e[69]||(e[69]=[x(" Total IPI ")])),_:1}),t(a,{col:"xs",text:"right bold"},{default:o(()=>[x(ae(r.$filters.numero(r.compra.valorIpi,2)),1)]),_:1})]),_:1})):oe("",!0),t(I,{items:"center"},{default:o(()=>[t(a,{col:"xs5",text:"bold"},{default:o(()=>e[70]||(e[70]=[x(" Total c/ Impostos ")])),_:1}),t(a,{col:"xs-shrink"},{default:o(()=>[t(Me,{disable:r.compra.status!=="Digita\xE7\xE3o",modelValue:r.compra.totalComImposto,"onUpdate:modelValue":[e[36]||(e[36]=v=>r.compra.totalComImposto=v),s.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear"},null,8,["disable","modelValue","onUpdate:modelValue"])]),_:1}),t(a,{col:"xs",text:"right bold"},{default:o(()=>[x(ae(r.$filters.numero(r.compra.totalDocumento,2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(I,{gutter:"sm"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(d,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:o(()=>e[71]||(e[71]=[x("Faturar")])),_:1})]),_:1}),t(a,{col:"12"},{default:o(()=>[t(n,{modelValue:r.compra.observacaoFaturamento,"onUpdate:modelValue":e[37]||(e[37]=v=>r.compra.observacaoFaturamento=v),rows:"4",tipo:"textoArea",rotulo:"Observa\xE7\xE3o faturamento"},null,8,["modelValue"])]),_:1}),t(a,{mg:"md-y",col:"12"},{default:o(()=>[t(lt,{ref:"formAdicionarPagamento"},{default:o(()=>[t(I,{items:"start",justify:"center"},{default:o(()=>[t(a,{col:"12 sm6 md"},{default:o(()=>[t(n,{modelValue:r.compra.formaDePagamento,"onUpdate:modelValue":e[38]||(e[38]=v=>r.compra.formaDePagamento=v),rules:r.formaPagamentoRules,ajuda:"Exemplo: Boleto","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",outlined:"",rotulo:"Forma de pagamento"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(a,{col:"12 sm6 md"},{default:o(()=>[t(n,{modelValue:r.compra.condicaoPagamento,"onUpdate:modelValue":e[39]||(e[39]=v=>r.compra.condicaoPagamento=v),rules:r.condicaoPagamentoRules,ajuda:"Exemplo: 28/56/64","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",outlined:"",rotulo:"Cond. Pag",tipo:"numero"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(a,{col:"shrink sm4 md",text:"bold"},{default:o(()=>[ge("div",Yt,[t(Me,{modelValue:r.compra.freteSeparado,"onUpdate:modelValue":[e[40]||(e[40]=v=>r.compra.freteSeparado=v),s.calcularTotais],disable:r.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-mx-sm"},null,8,["modelValue","onUpdate:modelValue","disable"]),e[72]||(e[72]=x(" Frete Separado "))])]),_:1}),t(a,{col:"shrink sm4 md",text:"bold"},{default:o(()=>[ge("div",Jt,[t(Me,{modelValue:r.compra.naoGerarFinanceiro,"onUpdate:modelValue":[e[41]||(e[41]=v=>r.compra.naoGerarFinanceiro=v),s.calcularTotais],disable:r.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-mx-sm"},null,8,["modelValue","onUpdate:modelValue","disable"]),e[73]||(e[73]=x(" N\xE3o gerar financeiro "))])]),_:1}),t(a,{col:"12 sm4 md",text:"center"},{default:o(()=>[ge("div",ea,[t(ce,{onClick:s.gerarCondicoesDePagamento_click,disable:r.compra.status!=="Digita\xE7\xE3o",color:"positive",icon:"add",label:"Forma de pagamento",outline:"",size:"sm"},null,8,["onClick","disable"])])]),_:1})]),_:1})]),_:1},512)]),_:1}),be(t(a,{col:"12"},{default:o(()=>[t(d,{text:"sub1 medium"},{default:o(()=>e[74]||(e[74]=[x("Condi\xE7\xF5es de pagamento")])),_:1}),(R(!0),_e(Ve,null,Te(r.compraCondicoesDePagamento,v=>(R(),W(qe,{key:v.id},{default:o(()=>[t(I,{gutter:"sm",mg:"sm-y",items:"center",bordered:"","rounded-borders":""},{default:o(()=>[t(a,{col:"xs6 md-shrink"},{default:o(()=>[t(n,{modelValue:v.dataVencimento,"onUpdate:modelValue":V=>v.dataVencimento=V,rotulo:"Data vencimento","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",tipo:"data",dense:""},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(a,{col:"xs6 md2"},{default:o(()=>[t(n,{modelValue:v.valor,"onUpdate:modelValue":V=>v.valor=V,rotulo:"Valor",decimals:"2",zerosDireita:"2","somente-leitura":r.compra.status!=="Digita\xE7\xE3o",align:"left",tipo:"decimal"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(a,{col:"xs-grow"},{default:o(()=>[t(n,{modelValue:v.observacao,"onUpdate:modelValue":V=>v.observacao=V,rotulo:"Observa\xE7\xE3o","somente-leitura":r.compra.status!=="Digita\xE7\xE3o"||v.observacao==="Valor Frete + Seguro"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(a,{col:"xs-shrink",text:"right"},{default:o(()=>[t(ce,{onClick:V=>s.removerPagamento_click(v),color:"tertiary",flat:"",disable:r.compra.status!=="Digita\xE7\xE3o",icon:"delete",round:"",dense:""},null,8,["onClick","disable"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),r.valorTotalPagamento>0?(R(),W(I,{key:0,mg:"md-t",items:"center",justify:"center"},{default:o(()=>[t(a,{col:"shrink",text:"body2 bold"},{default:o(()=>[x(" Valor total: "+ae(r.$filters.numero(r.valorTotalPagamento,2)),1)]),_:1})]),_:1})):oe("",!0)]),_:1},512),[[Oe,r.compraCondicoesDePagamento.length>0]])]),_:1}),r.$db.usuario.desenvolvedor()?(R(),W(I,{key:0,gutter:"sm"},{default:o(()=>[t(a,{col:"12"},{default:o(()=>[t(Xe,{onShow:r.showContabilidade,"expand-separator":"",dense:"","expand-icon-class":"q-px-sm","header-class":"q-pa-sm border-bottom",class:"bg-amber-2 border-full bordered-radius"},{header:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"credit_card",size:"sm"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[75]||(e[75]=[x("Contabilidade")])),_:1}),t(ue,{caption:""},{default:o(()=>e[76]||(e[76]=[x("Apenas desenvolvedores")])),_:1})]),_:1})]),default:o(()=>[r.compraTitulos.length?(R(),W(qe,{key:0,class:"q-pa-xs"},{default:o(()=>[t(d,{icon:"list sm tertiary left",text:"sub2 medium"},{default:o(()=>e[77]||(e[77]=[x("Titulos")])),_:1}),(R(!0),_e(Ve,null,Te(r.compraTitulos,v=>(R(),W(Xe,{key:v.id,dense:"","hide-expand-icon":"","expand-separator":"","header-class":"q-pa-none border-bottom",class:"border-full"},{header:o(()=>[t(I,{gutter:"xs-x",width:"100%",class:"cursor-pointer"},{default:o(()=>[t(a,{col:"6 sm3 md2"},{default:o(()=>[t(n,{modelValue:v.dataVencimento,dense:"",borderless:"","somente-leitura":"",rotulo:"Data vencimento",tipo:"data"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"6 sm3 md2"},{default:o(()=>[t(n,{modelValue:v.dataPagamento||"A pagar",tipo:v.dataPagamento?"data":"texto",dense:"",borderless:"","somente-leitura":"",rotulo:"Data pagamento"},null,8,["modelValue","tipo"])]),_:2},1024),t(a,{col:"6 sm3 md2"},{default:o(()=>[t(n,{modelValue:v.parcela,"somente-leitura":"",borderless:"",align:"left",rotulo:"Parcela"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"6 sm6 md2"},{default:o(()=>[t(n,{modelValue:v.valor,"somente-leitura":"",borderless:"",align:"left",rotulo:"Valor",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"12 sm6 md2"},{default:o(()=>[t(n,{modelValue:v.formaDePagamento,borderless:"","somente-leitura":"",rotulo:"Forma de pagamento"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"12 sm12 md2"},{default:o(()=>[t(n,{modelValue:v.observacao,borderless:"","somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):oe("",!0),r.compraMovimentacoes.length?(R(),W(qe,{key:1,class:"q-pa-xs q-pt-lg"},{default:o(()=>[t(d,{icon:"list sm tertiary left",text:"sub2 medium"},{default:o(()=>e[78]||(e[78]=[x("Movimenta\xE7\xF4es")])),_:1}),(R(!0),_e(Ve,null,Te(r.compraMovimentacoes,v=>(R(),W(Xe,{key:v.id,dense:"","hide-expand-icon":"","expand-separator":"","header-class":"q-pa-none border-bottom",class:"border-full"},{header:o(()=>[t(I,{gutter:"xs-x",width:"100%",class:"cursor-pointer"},{default:o(()=>[t(a,{col:"6 sm12 md-grow"},{default:o(()=>[t(n,{modelValue:v.descricao,ocultarAjuda:"","somente-leitura":"",borderless:"",rotulo:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024),t(a,{col:"6 sm md2"},{default:o(()=>[t(n,{modelValue:v.dataCompetencia,"somente-leitura":"",borderless:"",ocultarAjuda:"",dense:"",rotulo:"Data competencia",tipo:"data"},null,8,["modelValue"])]),_:2},1024),v.valorCredito?(R(),W(a,{key:0,col:"xs sm md2"},{default:o(()=>[t(n,{modelValue:v.valorCredito,"somente-leitura":"",borderless:"",ocultarAjuda:"",align:"left",rotulo:"Valor Credito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):oe("",!0),v.valorDebito?(R(),W(a,{key:1,col:"xs sm md2"},{default:o(()=>[t(n,{modelValue:v.valorDebito,"somente-leitura":"",borderless:"",ocultarAjuda:"",align:"left",rotulo:"Valor Debito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):oe("",!0),t(a,{col:"12 md-grow"},{default:o(()=>[t(n,{modelValue:v.observacao,ocultarAjuda:"",borderless:"","somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):oe("",!0)]),_:1},8,["onShow"])]),_:1})]),_:1})):oe("",!0)])]),_:1})]),_:1}),t(Ke,{class:"bg-white border-top"},{default:o(()=>[t(I,{gutter:"sm",items:"center",class:"u-container"},{default:o(()=>[t(a,{col:"12 sm",color:"text-tertiary"},{default:o(()=>[t(d,{text:"caption medium"},{default:o(()=>[e[79]||(e[79]=x(" Valor Total: ")),ge("span",ta,ae(r.$filters.numero(r.compra.totalDocumento,2)),1)]),_:1}),t(d,{text:"caption medium"},{default:o(()=>[e[80]||(e[80]=x(" SKU: ")),ge("span",aa,ae(s.skus),1),ge("span",oa,ae(s.quantidadeItens?` (${s.quantidadeItens})`:""),1)]),_:1})]),_:1}),t(a,{col:"12 sm-shrink",text:"right"},{default:o(()=>[r.compra.status==="Digita\xE7\xE3o"?(R(),W(ce,{key:0,onClick:s.excluir_click,flat:"",type:"submit",label:"Excluir",color:"white","text-color":"negative",class:"q-px-sm q-ml-sm"},null,8,["onClick"])):oe("",!0),r.compra.status==="Digita\xE7\xE3o"?(R(),W(ce,{key:1,onClick:s.finalizar_click,unelevated:"",label:"Finalizar",color:"primary",type:"submit",class:"q-px-sm q-ml-sm"},null,8,["onClick"])):oe("",!0),r.compra.status==="Finalizado"?(R(),W(ce,{key:2,onClick:s.reabrir_click,flat:"",label:"Reabrir",color:"tertiary",type:"submit",class:"q-px-sm q-ml-sm"},null,8,["onClick"])):oe("",!0),r.compra.status==="Finalizado"&&r.compra.operacao==="Pedido de Compra"?(R(),W(ce,{key:3,onClick:s.transformarEmNotaDeEntrada_click,unelevated:"",type:"submit",color:"primary",label:`${r.tela.pageWidth>=768?"Transformar em Nota de Entrada":"Transf. Nota Entrada"}`,class:"q-px-sm q-ml-sm"},null,8,["onClick","label"])):oe("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(w,{ref:"ModalEditarProdutoCompras",onSalvar:s.fecharEdicaoProduto},null,8,["onSalvar"]),t(u,{modelValue:r.adicionar.modal.value,"onUpdate:modelValue":e[43]||(e[43]=v=>r.adicionar.modal.value=v),filtro:{ativo:!0,idEmpresa:r.compra.idEmpresa},ref:"promptItem",habilitarQuantidade:!0,exibirValorVenda:!1,calculaItemCusto:!0,onSelecionarItens:s.selecionarItens},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var ia=st(Gt,[["render",ra]]);const la={components:{PromptItemV2:yt},data(){return{visivel:!1,termoBusca:"",compra:{},compraItensNaoVinculados:[],edicaoGeral:{marca:"",grupo:"",subGrupo:"",percentualMarkup:0},mostrarItemModal:!1,idxItem:0,tela:{width:0},modalMarkup:{visivel:!1,idItem:"",custo:0,fator:0,lucro:0,markup:0,venda:0,origem:{}},itensNota:[]}},computed:{produtosNaoVinculados(){return(this.compra.documentosItem||[]).reduce((r,e)=>r+(e.vinculado?0:1),0)},quantProdutos(){return(this.compra.documentosItem||[]).length},produtosInativos(){return this.itensNota.filter(r=>{var e;return r.produtoVinculado&&((e=r.produto)==null?void 0:e.ativo)===!1})},temProdutoInativo(){return this.produtosInativos.length>0},termosFormatados(){return(this.termoBusca||"").trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(/\s+/).filter(r=>r)},itensNaoVinculadosFiltrados(){return this.compraItensNaoVinculados.filter(r=>this.atendeBusca(r.item,this.termosFormatados))},produtosInativosFiltrados(){return this.produtosInativos.filter(r=>this.atendeBusca(r.produto,this.termosFormatados))}},mounted(){this.carregarNota()},methods:{abrirVincularItem(r){console.log("cliquei:",r);const e=this.compra.documentosItem.findIndex(f=>f.documentoItem.id===(r.id||r.documentoItem.id));console.log("index:",e),e!==-1?(this.idxItem=e,this.mostrarItemModal=!0):this.$q.notify({type:"negative",message:"Erro ao localizar item na lista mestre."})},atendeBusca(r,e){if(!r)return!1;if(!e.length)return!0;let f=`${r.descricao||""} ${r.marca||""} ${r.grupo||""} ${r.subGrupo||""} `;return f+=`${r.referencia?r.referencia+" Ref"+r.referencia:""} `,f+=`${r.codigoBarras||""} ${r.tipo||""}`,f=f.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),e.every(_=>f.includes(_))},vincularOutroProduto(r,e){r.produtoVinculado=!0,r.produto=e,this.$q.notify({type:"positive",message:"V\xEDnculo atualizado para produto ativo."})},criarValoresEdicao(r){return{valorOutrasDespesas:(r.valorFreteRateado||0)+(r.valorSeguroRateado||0)+(r.valorOutrasDespesasRateado||0),percentualIpi:r.percentualIpi||0,percentualIcmsSt:r.percentualIcmsSt||0,percentualFcpSt:r.percentualFcpSt||0,percentualDifal:0}},carregarNota(){var r,e;!((e=(r=this.compra)==null?void 0:r.documentosItem)!=null&&e.length)||(this.itensNota=this.compra.documentosItem.map(f=>({id:f.documentoItem.id,descricao:f.documentoItem.descricaoItem,produtoVinculado:f.vinculado,produto:f.item||null,original:f,valoresEdicao:f.valoresEdicao||this.criarValoresEdicao(f.documentoItem)})))},async reativarProduto(r){this.$q.dialog({title:"Reativar produto",message:`Deseja reativar o produto: ${r.produto.descricao}?`,persistent:!0,cancel:{label:"N\xE3o",push:!0,class:"bg-negative",textColor:"white",flat:!0},ok:{label:"Sim, reativar",color:"positive",push:!0,noCaps:!0}}).onOk(async()=>{try{this.$q.loading.show();const e=$utils.clonarV2(r.produto);r.produto.ativo=!0,await $db.item.grava({atual:r.produto,original:e}),this.$q.notify({type:"positive",message:"Produto reativado com sucesso!"}),this.itensNota=[...this.itensNota]}catch{r.produto.ativo=!1,this.$q.notify({type:"negative",message:"Erro ao reativar produto."})}finally{this.$q.loading.hide()}})},vincularOutro(r){r.produtoVinculado=!1,r.produto=null},antesDeSalvar(){if(this.temProdutoInativo){this.$q.dialog({title:"Pend\xEAncias Encontradas",message:`Existem ${this.produtosInativos.length} produtos inativos. \xC9 necess\xE1rio reativ\xE1-los ou vincular a outros produtos ativos antes de finalizar.`,persistent:!0,ok:{label:"Entendido",color:"primary",push:!0}});return}this.salvar()},async abrir(r){await this.atualizar(r),this.carregarNota(),this.visivel=!0,this.$nextTick(()=>{this.temProdutoInativo&&this.$q.notify({type:"warning",icon:"warning",message:`Aten\xE7\xE3o: Existem ${this.produtosInativos.length} produtos inativos!`,caption:"Verifique a aba de produtos inativos antes de salvar.",timeout:5e3})})},async fechar(){this.visivel=!1,this.termoBusca="",this.compra={},this.itensNota=[],this.compraItensNaoVinculados=[],this.edicaoGeral={marca:"",grupo:"",subGrupo:"",percentualMarkup:0}},async atualizar(r){var e;this.compra=r;for(const f of this.compra.documentosItem)(e=f.valoresEdicao)!=null||(f.valoresEdicao=this.criarValoresEdicao(f.documentoItem)),this.recalcular(f);this.compraItensNaoVinculados=this.compra.documentosItem.filter(({vinculado:f})=>!f)},async selecionarItens(r){const e=Object.values(r);if(e.length===0)return;const f=e[0].item?e[0].item:e[0];await $tryLoading(async()=>{var s,d;const _=this.compra.documentosItem[this.idxItem];if(!_)throw new Error("Falha ao identificar alvo do v\xEDnculo");$utils.verificarErro(!_,"Item da nota n\xE3o localizado para v\xEDnculo."),$utils.verificarErro(!f.id,"Produto selecionado \xE9 inv\xE1lido."),_.vinculado=!0,_.item=f,_.documentoItem.idItem=f.id,_.documentoItem.descricaoItem=f.descricao;const i={id:$utils.uuid(),idItem:f.id,idContato:this.compra.documento.idContato,referencia:_.nfeProd.cProd,descricao:_.nfeProd.xProd};(d=(s=this.compra)==null?void 0:s.fornecedor)!=null&&d.contato&&await $db.compra.gravaFornecedor({atual:this.compra.fornecedor}),await $db.hibrido.grava("itemFornecedor",{atual:i}),this.compraItensNaoVinculados=this.compra.documentosItem.filter(({vinculado:a})=>!a),this.carregarNota(),$q.notifyPositive(`Produto vinculado com sucesso: ${f.descricao}`)},{mensagem:"Vinculando produto..."}),this.mostrarItemModal=!1},aplicarPropriedades(){try{for(const r of this.itensNaoVinculadosFiltrados){const e=this.edicaoGeral;let f=!1;e.marca&&(r.item.marca=e.marca,f=!0),e.grupo&&(r.item.grupo=e.grupo,f=!0),e.subGrupo&&(r.item.subGrupo=e.subGrupo,f=!0),e.percentualMarkup&&(r.item.percentualMarkup=e.percentualMarkup,this.recalcular(r),f=!0)}this.$q.notify({type:"positive",message:"Propriedades aplicadas com sucesso."})}catch(r){this.$q.notify({type:"negative",message:"Erro ao aplicar as propriedades aos itens."}),console.error("Erro ao aplicar as propriedades aos itens.",r)}},async recalcular(r){var y;const{item:f,documentoItem:_,itemAnterior:i=$utils.clonarV2(r.item)}=r;r.valoresEdicao||(y=r.valoresEdicao)!=null||(r.valoresEdicao=this.criarValoresEdicao(f.documentoItem));const{valorOutrasDespesas:s,percentualIpi:d,percentualIcmsSt:a,percentualFcpSt:m,percentualDifal:h}=r.valoresEdicao,{valorCusto:I=0,percentualMarkup:b=0,valorVenda:n=0}=f,l=I+s,C=l*d/100,g=l*a/100,w=l*m/100,u=l*h/100;f.valorCustoReposicao=$utils.arredondar(l+C+g+w+u,2),n!==i.valorVenda?f.percentualMarkup=$utils.arredondar(100*(n-f.valorCustoReposicao)/n,2):f.valorVenda=$utils.arredondar(f.valorCustoReposicao/(1-b/100),2),f.valorVenda===0&&(f.percentualMarkup=(f.valorVenda-f.valorCustoReposicao)/(f.valorVenda+1e-9)*100),r.itemAnterior=$utils.clonarV2(f)},async adicionarItens(){for(const r of this.compra.documentosItem)r.vinculado||await this.adicionarItem(r)},async adicionarItem(r){r.buttonLoading=!0,await this.$nextTick(),await $tryLoading(async()=>{var i,s;const e=await $db.hibrido.lista({table:"item",where:{referencia:r.item.referencia}});$utils.verificarErro(e.length,"Referencia j\xE1 utilizada por outro produto"),r.documentoItem.descricaoItem=r.item.descricao,r.item.descricaoConcatenada=r.item.descricao;const f=r.nfeProd,_={id:$utils.uuid(),idItem:r.item.id,idContato:this.compra.documento.idContato,referencia:f.cProd,descricao:f.xProd};r.item.percentualMarkup=Math.max(r.item.percentualMarkup,-1e10),await $db.hibrido.grava("item",{atual:r.item}),await $db.item.carregarMemoria(r.item.id),(s=(i=this.compra)==null?void 0:i.fornecedor)!=null&&s.contato&&$db.compra.gravaFornecedor({atual:this.compra.fornecedor}),await $db.hibrido.grava("itemFornecedor",{atual:_}),r.vinculado=!0,this.$q.notify({type:"positive",message:`Item criado com sucesso: ${r.item.descricao}`})},{mensagem:"Cadastrando produto..."}),r.buttonLoading=!1},async salvar(){try{if(this.compra.documentosItem.some(({vinculado:r})=>!r)){this.$q.notify({type:"warning",message:"Verifique todos os itens n\xE3o vinculados!"});return}this.visivel=!1,this.$emit("concluirImportacao",this.compra),this.$q.notify({type:"positive",message:"Importa\xE7\xE3o conclu\xEDda com sucesso!"})}catch{this.$q.notify({type:"negative",message:"Erro ao salvar importa\xE7\xE3o."})}},edicaoGeralMarkup(){this.edicaoGeral.percentualMarkup=this.edicaoGeral.percentualMarkup>99.99?99.99:this.edicaoGeral.percentualMarkup},rules(r,e){if(r==="lucro"){e.item.valorVenda=e.item.valorCustoReposicao/(1-e.item.percentualMarkup/100),this.$nextTick(()=>{e.item.percentualMarkup>99.99&&(e.item.percentualMarkup=99.99,this.rules("lucro",e))});return}if(r==="venda"){e.item.valorVenda<0&&this.$nextTick(()=>{e.item.valorVenda=e.item.valorCustoReposicao,this.rules("venda",e)}),e.item.valorVenda===0?e.item.percentualMarkup=(e.item.valorVenda-e.item.valorCustoReposicao)/(e.item.valorVenda+1e-9)*100:e.item.percentualMarkup=(e.item.valorVenda-e.item.valorCustoReposicao)/e.item.valorVenda*100,this.$nextTick(()=>{e.item.percentualMarkup>99.99&&(e.item.percentualMarkup=99.99,this.rules("lucro",e))});return}},abrirModalMarkup(r){this.modalMarkup={visivel:!0,idItem:r.item.id,custo:r.item.valorCustoReposicao,fator:r.item.valorVenda===0?0:r.item.valorVenda/r.item.valorCustoReposicao,lucro:r.item.valorVenda===0?(r.item.valorVenda-r.item.valorCustoReposicao)/(r.item.valorVenda+1e-9)*100:(r.item.valorVenda-r.item.valorCustoReposicao)/r.item.valorVenda*100,markup:r.item.valorVenda&&r.item.valorCustoReposicao?(r.item.valorVenda/r.item.valorCustoReposicao-1)*100:0,venda:r.item.valorVenda,origem:{custo:r.item.valorCustoReposicao,venda:r.item.valorVenda,lucro:r.item.percentualMarkup}}},fecharModalMarkup(r=!1){const e=this.compraItensNaoVinculados.find(f=>f.item.id===this.modalMarkup.idItem);if(!e){this.modalMarkup={visivel:!1,idItem:"",custo:0,fator:0,lucro:0,markup:0,venda:0,origem:{}};return}r?(e.item.valorCustoReposicao=this.modalMarkup.custo,e.item.valorVenda=this.modalMarkup.venda,e.item.percentualMarkup=this.modalMarkup.lucro):(e.item.valorCustoReposicao=this.modalMarkup.origem.custo,e.item.valorVenda=this.modalMarkup.origem.venda,e.item.percentualMarkup=this.modalMarkup.origem.lucro),this.modalMarkup={visivel:!1,idItem:"",custo:0,fator:0,lucro:0,markup:0,venda:0,origem:{}}},calcularModalMarkup(r){const e=this.modalMarkup,f=1e-9;if(r==="custo"){e.custo<0&&this.$nextTick(()=>{e.custo=0,e.fator=0,e.lucro=0,e.markup=0,e.venda=0}),e.markup=(e.venda/e.custo-1)*100,e.venda===0?(e.lucro=(e.venda-e.custo)/(e.venda+f)*100,e.fator=0):(e.lucro=(e.venda-e.custo)/e.venda*100,e.fator=e.venda/e.custo),this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(r==="fator"){e.fator===0?(e.venda=0,e.lucro=(e.venda-e.custo)/(e.venda+f)*100):(e.venda=e.custo*e.fator,e.lucro=(e.venda-e.custo)/e.venda*100),e.markup=(e.venda/e.custo-1)*100,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(r==="lucro"){e.venda=e.custo/(1-e.lucro/100),e.markup=(e.venda/e.custo-1)*100,e.fator=e.venda/e.custo,this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(r==="markup"){e.markup<-100&&this.$nextTick(()=>{e.markup=-100,this.calcularModalMarkup("markup")}),e.venda=e.custo+e.markup/100*e.custo,e.venda===0?(e.lucro=(e.venda-e.custo)/(e.venda+f)*100,e.fator=0):(e.lucro=(e.venda-e.custo)/e.venda*100,e.fator=e.venda/e.custo),this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}if(r==="venda"){e.venda<0&&this.$nextTick(()=>{e.venda=e.custo,this.calcularModalMarkup("venda")}),e.markup=(e.venda/e.custo-1)*100,e.venda===0?(e.lucro=(e.venda-e.custo)/(e.venda+f)*100,e.fator=0):(e.lucro=(e.venda-e.custo)/e.venda*100,e.fator=e.venda/e.custo),this.$nextTick(()=>{e.lucro>99.99&&(e.lucro=99.99,this.calcularModalMarkup("lucro"))});return}},resize(){this.tela={width:$utils.tela("ImportacaoXML").width}}}},sa={class:"bg-white q-pa-sm rounded-borders shadow fit"},na={class:"q-mb-md q-mx-sm rounded-borders shadow"},da={class:"text-weight-bold"},ua={class:"text-weight-bold"};function ca(r,e,f,_,i,s){const d=pe("ajuda"),a=pe("g-label"),m=pe("campo"),h=pe("g-col"),I=pe("g-row"),b=pe("PromptItemV2");return R(),W($e,{modelValue:i.visivel,"onUpdate:modelValue":e[21]||(e[21]=n=>i.visivel=n),persistent:"",maximized:"",onKeyup:mt(s.fechar,["esc"])},{default:o(()=>[t(je,{container:"",view:"hHh LpR fFf",class:"bg-light",id:"ImportacaoXML"},{default:o(()=>[t(wt,{onResize:e[0]||(e[0]=n=>s.resize())}),t(He,{class:"bg-transparent"},{default:o(()=>[t(xe,{class:"bg-primary"},{default:o(()=>[t(ce,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:s.fechar},null,8,["onClick"]),t(Le,null,{default:o(()=>e[22]||(e[22]=[x("Importar XML x Cadastro")])),_:1}),t(d)]),_:1}),t(xe,{class:"u-container bg-light q-px-sm q-py-md"},{default:o(()=>[ge("div",sa,[t(Qe,{modelValue:i.termoBusca,"onUpdate:modelValue":e[1]||(e[1]=n=>i.termoBusca=n),debounce:500,label:"Buscar","clear-icon":"close",standout:"",outlined:"",clearable:"",dense:""},{prepend:o(()=>[t(ie,{name:"mdi-filter"})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),t(Ze,null,{default:o(()=>[t(Ge,{class:"u-container"},{default:o(()=>[ge("div",na,[t(I,{gutter:"sm",bg:"bg-white"},{default:o(()=>[t(h,{col:"12"},{default:o(()=>[t(a,{icon:"mdi-set-none sm tertiary left",text:"body1 medium",class:"q-mb-md"},{default:o(()=>e[23]||(e[23]=[x(" Propriedades para todos os produtos ")])),_:1}),t(I,null,{default:o(()=>[t(h,{col:"12 md"},{default:o(()=>[t(m,{modelValue:i.edicaoGeral.marca,"onUpdate:modelValue":e[2]||(e[2]=n=>i.edicaoGeral.marca=n),dense:"",outlined:"",rotulo:"Marca",tipo:"texto"},null,8,["modelValue"])]),_:1}),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:i.edicaoGeral.grupo,"onUpdate:modelValue":e[3]||(e[3]=n=>i.edicaoGeral.grupo=n),dense:"",outlined:"",rotulo:"Grupo",tipo:"texto"},null,8,["modelValue"])]),_:1}),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:i.edicaoGeral.subGrupo,"onUpdate:modelValue":e[4]||(e[4]=n=>i.edicaoGeral.subGrupo=n),dense:"",outlined:"",rotulo:"SubGrupo",tipo:"texto"},null,8,["modelValue"])]),_:1})]),_:1}),t(I,{items:"center",justify:"end"},{default:o(()=>[t(h,{col:"6 sm-shrink"},{default:o(()=>[t(m,{modelValue:i.edicaoGeral.percentualMarkup,"onUpdate:modelValue":e[5]||(e[5]=n=>i.edicaoGeral.percentualMarkup=n),opcoes:{maximumValue:99.99},rules:s.edicaoGeralMarkup(),"lazy-rules":"",dense:"",outlined:"",rotulo:"Margem de Lucro",suffix:"%",tipo:"decimal",decimals:"2",col:"2"},null,8,["modelValue","rules"])]),_:1}),t(h,{col:"6 sm-shrink",text:"right"},{default:o(()=>[t(ce,{onClick:s.aplicarPropriedades,unelevated:"",color:"primary",class:"q-px-sm"},{default:o(()=>[t(ie,{name:"play_arrow",class:"q-mr-xs"}),e[24]||(e[24]=x(" Aplicar "))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),t(Xe,{"default-opened":"",class:"q-mb-md q-mx-sm rounded-borders shadow bg-white"},{default:o(()=>[t(bt,{items:s.itensNaoVinculadosFiltrados,separator:""},{default:o(({item:n})=>[t(I,{gutter:"sm",bg:"bg-white"},{default:o(()=>[t(h,{col:"12"},{default:o(()=>[t(I,null,{default:o(()=>[t(h,{col:"12 md"},{default:o(()=>[t(m,{modelValue:n.item.descricao,"onUpdate:modelValue":l=>n.item.descricao=l,"somente-leitura":!!n.vinculado,outlined:"",dense:"",rotulo:"Descri\xE7\xE3o Item",tipo:"texto",align:"left",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(h,{col:"12 md"},{default:o(()=>[t(m,{modelValue:n.item.referencia,"onUpdate:modelValue":l=>n.item.referencia=l,"somente-leitura":!!n.vinculado,outlined:"",dense:"",rotulo:"Referencia",tipo:"texto",maxlength:"30",align:"left",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(I,null,{default:o(()=>[t(h,{col:"12 md"},{default:o(()=>[t(m,{modelValue:n.item.marca,"onUpdate:modelValue":l=>n.item.marca=l,"somente-leitura":!!n.vinculado,outlined:"",dense:"",rotulo:"Marca",tipo:"texto",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.item.grupo,"onUpdate:modelValue":l=>n.item.grupo=l,"somente-leitura":!!n.vinculado,outlined:"",dense:"",rotulo:"Grupo",tipo:"texto",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.item.subGrupo,"onUpdate:modelValue":l=>n.item.subGrupo=l,"somente-leitura":!!n.vinculado,outlined:"",dense:"",rotulo:"SubGrupo",tipo:"texto",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(I,null,{default:o(()=>[t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.item.valorCusto,"onUpdate:modelValue":l=>n.item.valorCusto=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"Valor pr\xE9 custo",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.valorOutrasDespesas,"onUpdate:modelValue":l=>n.valoresEdicao.valorOutrasDespesas=l,onBlur:l=>s.recalcular(n),"somente-leitura":!!n.vinculado,dense:"",outlined:"",rotulo:"Outras Despesas",tipo:"decimal",decimals:"4",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.percentualIpi,"onUpdate:modelValue":l=>n.valoresEdicao.percentualIpi=l,onBlur:l=>s.recalcular(n),"somente-leitura":!!n.vinculado,opcoes:{maximumValue:100},outlined:"",dense:"",rotulo:"IPI",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.percentualIcmsSt,"onUpdate:modelValue":l=>n.valoresEdicao.percentualIcmsSt=l,onBlur:l=>s.recalcular(n),opcoes:{maximumValue:100},"somente-leitura":!!n.vinculado,dense:"",outlined:"",rotulo:"ST",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.percentualFcpSt,"onUpdate:modelValue":l=>n.valoresEdicao.percentualFcpSt=l,onBlur:l=>s.recalcular(n),opcoes:{maximumValue:100},"somente-leitura":!!n.vinculado,dense:"",outlined:"",rotulo:"FCP ST",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.percentualDifal,"onUpdate:modelValue":l=>n.valoresEdicao.percentualDifal=l,onBlur:l=>s.recalcular(n),opcoes:{maximumValue:100},"somente-leitura":!!n.vinculado,dense:"",outlined:"",rotulo:"DIFAL",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.item.valorCustoReposicao,"onUpdate:modelValue":l=>n.item.valorCustoReposicao=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Custo de reposi\xE7\xE3o",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.item.percentualMarkup,"onUpdate:modelValue":l=>n.item.percentualMarkup=l,onBlur:l=>s.recalcular(n),rules:[l=>{l>99.99&&s.abrirModalMarkup(n)}],"somente-leitura":!!n.vinculado,opcoes:{maximumValue:99.99},after:[{icon:"calculate",color:"primary",round:!0,dense:!0,flat:!0,handler:()=>s.abrirModalMarkup(n)}],dense:"",outlined:"",rotulo:"Margem de Lucro",tipo:"decimal",suffix:"%",decimals:"2"},null,8,["modelValue","onUpdate:modelValue","onBlur","rules","somente-leitura","after"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.item.valorVenda,"onUpdate:modelValue":l=>n.item.valorVenda=l,onBlur:l=>s.recalcular(n),"somente-leitura":!!n.vinculado,rules:s.rules("venda",n),dense:"",outlined:"",rotulo:"Valor de Venda",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura","rules"])]),_:2},1024)]),_:2},1024),r.$db.usuario.desenvolvedor()?(R(),W(I,{key:0,class:"bg-amber-2"},{default:o(()=>[t(h,{col:"6 md"},{default:o(()=>e[25]||(e[25]=[x("Detalhes da nota (Apenas desenvolvedores)")])),_:1}),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorBaseIcms,"onUpdate:modelValue":l=>n.documentoItem.valorBaseIcms=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Base ICMS",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.percentualIcms,"onUpdate:modelValue":l=>n.documentoItem.percentualIcms=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"ICMS %",tipo:"decimal",decimals:"2",suffix:"%",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorIcms,"onUpdate:modelValue":l=>n.documentoItem.valorIcms=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Valor ICMS",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorBaseIcmsSt,"onUpdate:modelValue":l=>n.documentoItem.valorBaseIcmsSt=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Base ICMS ST",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.percentualIcmsSt,"onUpdate:modelValue":l=>n.documentoItem.percentualIcmsSt=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"ICMS ST %",tipo:"decimal",decimals:"2",suffix:"%",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorIcmsSt,"onUpdate:modelValue":l=>n.documentoItem.valorIcmsSt=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Valor ICMS ST",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):oe("",!0),r.$db.usuario.desenvolvedor()?(R(),W(I,{key:1,class:"bg-amber-2"},{default:o(()=>[t(h,{col:"6 md"}),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorBaseFcp,"onUpdate:modelValue":l=>n.documentoItem.valorBaseFcp=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Base FCP",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.percentualFcp,"onUpdate:modelValue":l=>n.documentoItem.percentualFcp=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"FCP %",tipo:"decimal",decimals:"2",suffix:"%",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorFcp,"onUpdate:modelValue":l=>n.documentoItem.valorFcp=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Valor FCP",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorBaseFcpSt,"onUpdate:modelValue":l=>n.documentoItem.valorBaseFcpSt=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Base FCP ST",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.percentualFcpSt,"onUpdate:modelValue":l=>n.documentoItem.percentualFcpSt=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"FCP ST %",tipo:"decimal",decimals:"2",suffix:"%",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.documentoItem.valorFcpSt,"onUpdate:modelValue":l=>n.documentoItem.valorFcpSt=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Valor FCP ST",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):oe("",!0),n.vinculado?(R(),W(I,{key:3,items:"center",justify:"end"},{default:o(()=>e[29]||(e[29]=[x(" Produto vinculado ")])),_:1})):(R(),W(I,{key:2,items:"center",justify:"end"},{default:o(()=>[t(h,{col:"shrink"},{default:o(()=>[t(ce,{onClick:l=>s.abrirVincularItem(n),unelevated:"",color:"primary",class:"q-px-sm"},{default:o(()=>[t(ie,{name:"search",class:"q-mr-xs"}),e[26]||(e[26]=x(" Vincular "))]),_:2},1032,["onClick"])]),_:2},1024),t(h,{col:"shrink"},{default:o(()=>[t(a,{text:"body1 center"},{default:o(()=>e[27]||(e[27]=[x("OU")])),_:1})]),_:1}),t(h,{col:"shrink"},{default:o(()=>[t(ce,{onClick:l=>s.adicionarItem(n),loading:n.buttonLoading,unelevated:"",color:"primary",class:"q-px-sm"},{default:o(()=>[t(ie,{name:"add",class:"q-mr-xs"}),e[28]||(e[28]=x(" Novo "))]),_:2},1032,["onClick","loading"])]),_:2},1024)]),_:2},1024))]),_:2},1024)]),_:2},1024)]),_:1},8,["items"])]),_:1}),s.produtosInativos.length?(R(),W(Xe,{key:0,class:"q-mb-md q-mx-sm rounded-borders shadow bg-orange-1","expand-separator":"","default-opened":"",label:"Produto vinculado est\xE1 inativo"},{default:o(()=>[t(bt,{items:s.produtosInativosFiltrados,separator:""},{default:o(({item:n})=>[t(I,{gutter:"sm",bg:"bg-white"},{default:o(()=>[t(h,{col:"12"},{default:o(()=>[t(I,null,{default:o(()=>[t(h,{col:"12 md"},{default:o(()=>[t(m,{modelValue:n.produto.descricao,"onUpdate:modelValue":l=>n.produto.descricao=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"Descri\xE7\xE3o Item",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"12 md"},{default:o(()=>[t(m,{modelValue:n.produto.referencia,"onUpdate:modelValue":l=>n.produto.referencia=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"Referencia",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(I,null,{default:o(()=>[t(h,{col:"12 md"},{default:o(()=>[t(m,{modelValue:n.produto.marca,"onUpdate:modelValue":l=>n.produto.marca=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"Marca",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.produto.grupo,"onUpdate:modelValue":l=>n.produto.grupo=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"Grupo",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.produto.subGrupo,"onUpdate:modelValue":l=>n.produto.subGrupo=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"SubGrupo",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(I,null,{default:o(()=>[t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.produto.valorCusto,"onUpdate:modelValue":l=>n.produto.valorCusto=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"Valor pr\xE9 custo",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.valorOutrasDespesas,"onUpdate:modelValue":l=>n.valoresEdicao.valorOutrasDespesas=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Outras Despesas",tipo:"decimal",decimals:"4",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.percentualIpi,"onUpdate:modelValue":l=>n.valoresEdicao.percentualIpi=l,"somente-leitura":"",outlined:"",dense:"",rotulo:"IPI",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.percentualIcmsSt,"onUpdate:modelValue":l=>n.valoresEdicao.percentualIcmsSt=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"ST",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.valoresEdicao.percentualDifal,"onUpdate:modelValue":l=>n.valoresEdicao.percentualDifal=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"DIFAL",suffix:"%",tipo:"decimal",decimals:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.produto.valorCustoReposicao,"onUpdate:modelValue":l=>n.produto.valorCustoReposicao=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Custo de reposi\xE7\xE3o",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.produto.percentualMarkup,"onUpdate:modelValue":l=>n.produto.percentualMarkup=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Margem de Lucro",tipo:"decimal",suffix:"%",decimals:"2"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(h,{col:"6 md"},{default:o(()=>[t(m,{modelValue:n.produto.valorVenda,"onUpdate:modelValue":l=>n.produto.valorVenda=l,"somente-leitura":"",dense:"",outlined:"",rotulo:"Valor de Venda",tipo:"decimal",decimals:"4",zerosDireita:"2",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),t(I,{items:"center",justify:"end"},{default:o(()=>[t(h,{col:"shrink"},{default:o(()=>[t(ce,{onClick:l=>s.abrirVincularItem(n),unelevated:"",color:"primary",class:"q-px-sm"},{default:o(()=>[t(ie,{name:"search",class:"q-mr-xs"}),e[30]||(e[30]=x(" Vincular "))]),_:2},1032,["onClick"])]),_:2},1024),t(h,{col:"shrink"},{default:o(()=>[t(a,{text:"body1 center"},{default:o(()=>e[31]||(e[31]=[x("OU")])),_:1})]),_:1}),t(h,{col:"shrink"},{default:o(()=>[t(ce,{onClick:l=>s.reativarProduto(n),unelevated:"",color:"positive",class:"q-px-sm"},{default:o(()=>[t(ie,{name:"restart_alt",class:"q-mr-xs"}),e[32]||(e[32]=x(" Reativar Cadastro "))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["items"])]),_:1})):oe("",!0)]),_:1})]),_:1}),t(Ke,{class:"bg-white border-top"},{default:o(()=>[t(xe,{class:"u-container"},{default:o(()=>[t(fe,{class:"q-pa-none"},{default:o(()=>[t(Y,null,{default:o(()=>[t(ue,{caption:"",class:"text-weight-medium"},{default:o(()=>[e[33]||(e[33]=x(" Produtos: ")),ge("span",da,ae(s.quantProdutos),1)]),_:1}),t(ue,{caption:"",class:"text-weight-medium"},{default:o(()=>[e[34]||(e[34]=x(" N\xE3o vinculados: ")),ge("span",ua,ae(s.produtosNaoVinculados),1)]),_:1})]),_:1})]),_:1}),t(tt),s.produtosNaoVinculados?(R(),W(ce,{key:0,onClick:s.adicionarItens,unelevated:"",color:"primary",class:"q-px-sm q-ml-sm"},{default:o(()=>[t(ie,{name:"add"}),e[35]||(e[35]=x(" Incluir Todos "))]),_:1},8,["onClick"])):(R(),W(ce,{key:1,onClick:s.antesDeSalvar,unelevated:"",color:"primary",class:"q-px-sm q-ml-sm"},{default:o(()=>[t(ie,{name:"save",class:"q-mr-xs"}),e[36]||(e[36]=x(" Salvar "))]),_:1},8,["onClick"]))]),_:1})]),_:1}),t(b,{modelValue:i.mostrarItemModal,"onUpdate:modelValue":e[6]||(e[6]=n=>i.mostrarItemModal=n),onSelecionarItens:s.selecionarItens,filtro:{ativo:!0,idEmpresa:i.compra.idEmpresa},exibirValorVenda:!1,habilitarQuantidade:!1,ref:"promptItem"},null,8,["modelValue","onSelecionarItens","filtro"]),t($e,{modelValue:i.modalMarkup.visivel,"onUpdate:modelValue":e[19]||(e[19]=n=>i.modalMarkup.visivel=n),onKeyup:e[20]||(e[20]=mt(n=>s.fecharModalMarkup(),["esc"])),persistent:""},{default:o(()=>[t(je,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:_t(i.tela.width<=550?"height:100%; max-height:560px;":"height:100%; max-height:480px; max-width:550px;")},{default:o(()=>[t(He,null,{default:o(()=>[t(xe,null,{default:o(()=>[t(ie,{name:"calculate",size:"sm",flat:""}),t(Le,null,{default:o(()=>e[37]||(e[37]=[x("Markup X Margem de Lucro")])),_:1})]),_:1})]),_:1}),t(Ze,null,{default:o(()=>[t(Ge,null,{default:o(()=>[t(I,{gutter:"md",class:"q-mb-lg"},{default:o(()=>[t(h,{col:"12"},{default:o(()=>[t(a,{bordered:"","rounded-borders":"",text:"caption",class:"q-pa-sm"},{default:o(()=>e[38]||(e[38]=[ge("strong",null,"N\xE3o \xE9 para ter margem\xA0de\xA0lucro superior a 99.99%",-1),x(", o c\xE1lculo do lucro \xE9 sempre sobre o valor da venda, a explica\xE7\xE3o vem da an\xE1lise que o lucro da "),ge("strong",null,"EMPRESA",-1),x(" sempre \xE9 c\xE1lculado com base no "),ge("strong",null,"LUCRO",-1),x(" x "),ge("strong",null,"FATURAMENTO",-1),x(". ")])),_:1})]),_:1})]),_:1}),t(I,{gutter:"md-x",justify:"center"},{default:o(()=>[t(h,{col:"11 sm5"},{default:o(()=>[t(m,{modelValue:i.modalMarkup.custo,"onUpdate:modelValue":[e[7]||(e[7]=n=>i.modalMarkup.custo=n),e[8]||(e[8]=n=>s.calcularModalMarkup("custo"))],debounce:500,somenteLeitura:"",dense:"",filled:"","lazy-rules":"","hide-bottom-space":"",rotulo:"Custo de reposi\xE7\xE3o",tipo:"decimal",decimals:"2",zerosDireita:"2",class:"q-mb-lg"},null,8,["modelValue"])]),_:1})]),_:1}),t(I,{gutter:"md-x",justify:"center"},{default:o(()=>[t(h,{col:"11 sm4"},{default:o(()=>[t(m,{modelValue:i.modalMarkup.fator,"onUpdate:modelValue":[e[9]||(e[9]=n=>i.modalMarkup.fator=n),e[10]||(e[10]=n=>s.calcularModalMarkup("fator"))],somenteLeitura:!(i.modalMarkup.custo>0),debounce:500,filled:"",dense:"","lazy-rules":"","hide-bottom-space":"",rotulo:"Fator Markup",tipo:"decimal",decimals:"2",zerosDireita:"2"},null,8,["modelValue","somenteLeitura"]),t(a,{class:"q-pa-xs",style:{"font-size":"11px","line-height":"1.1"}},{default:o(()=>e[39]||(e[39]=[x(" \xC9 um fator aplicado sobre o pre\xE7o de custo para determinar o pre\xE7o de venda. ")])),_:1})]),_:1}),t(h,{col:"11 sm4"},{default:o(()=>[t(m,{modelValue:i.modalMarkup.lucro,"onUpdate:modelValue":[e[11]||(e[11]=n=>i.modalMarkup.lucro=n),e[12]||(e[12]=n=>s.calcularModalMarkup("lucro"))],somenteLeitura:!(i.modalMarkup.custo>0),debounce:500,filled:"",dense:"","lazy-rules":"","hide-bottom-space":"",tipo:"decimal",rotulo:"Margem de Lucro",suffix:"%",decimals:"2",zerosDireita:"2"},null,8,["modelValue","somenteLeitura"]),t(a,{class:"q-pa-xs",style:{"font-size":"11px","line-height":"1.1"}},{default:o(()=>e[40]||(e[40]=[x(" \xC9 o percentual do pre\xE7o de venda correspondente ao lucro da opera\xE7\xE3o. ")])),_:1})]),_:1}),t(h,{col:"11 sm4"},{default:o(()=>[t(m,{modelValue:i.modalMarkup.markup,"onUpdate:modelValue":[e[13]||(e[13]=n=>i.modalMarkup.markup=n),e[14]||(e[14]=n=>s.calcularModalMarkup("markup"))],somenteLeitura:!(i.modalMarkup.custo>0),debounce:500,filled:"",dense:"","lazy-rules":"","hide-bottom-space":"",rotulo:"Percentual Markup",tipo:"decimal",decimals:"2",zerosDireita:"2",suffix:"%"},null,8,["modelValue","somenteLeitura"]),t(a,{class:"q-pa-xs",style:{"font-size":"11px","line-height":"1.1"}},{default:o(()=>e[41]||(e[41]=[x(" \xC9 um \xEDndice aplicado sobre o pre\xE7o de custo para determinar o pre\xE7o de venda. ")])),_:1})]),_:1})]),_:1}),t(I,{gutter:"md-x",justify:"center"},{default:o(()=>[t(h,{col:"11 sm5"},{default:o(()=>[t(m,{modelValue:i.modalMarkup.venda,"onUpdate:modelValue":[e[15]||(e[15]=n=>i.modalMarkup.venda=n),e[16]||(e[16]=n=>s.calcularModalMarkup("venda"))],somenteLeitura:!(i.modalMarkup.custo>0),debounce:500,filled:"",dense:"","lazy-rules":"","hide-bottom-space":"",rotulo:"Valor de Venda",tipo:"decimal",decimals:"2",zerosDireita:"2",class:"q-mt-md"},null,8,["modelValue","somenteLeitura"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Ke,{class:"bg-light"},{default:o(()=>[t(xe,null,{default:o(()=>[t(tt),t(ce,{onClick:e[17]||(e[17]=n=>s.fecharModalMarkup()),flat:"",label:"Cancelar",color:"tertiary"}),t(ce,{onClick:e[18]||(e[18]=n=>s.fecharModalMarkup(!0)),unelevated:"",label:"Aplicar",color:"primary",class:"q-ml-sm"})]),_:1})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","onKeyup"])}var ma=st(la,[["render",ca]]),kt={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,e){(function(f){r.exports=f()})(function(){return function f(_,i,s){function d(h,I){if(!i[h]){if(!_[h]){var b=typeof it=="function"&&it;if(!I&&b)return b(h,!0);if(a)return a(h,!0);var n=new Error("Cannot find module '"+h+"'");throw n.code="MODULE_NOT_FOUND",n}var l=i[h]={exports:{}};_[h][0].call(l.exports,function(C){var g=_[h][1][C];return d(g||C)},l,l.exports,f,_,i,s)}return i[h].exports}for(var a=typeof it=="function"&&it,m=0;m<s.length;m++)d(s[m]);return d}({1:[function(f,_,i){var s=f("./utils"),d=f("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(m){for(var h,I,b,n,l,C,g,w=[],u=0,y=m.length,v=y,V=s.getTypeOf(m)!=="string";u<m.length;)v=y-u,b=V?(h=m[u++],I=u<y?m[u++]:0,u<y?m[u++]:0):(h=m.charCodeAt(u++),I=u<y?m.charCodeAt(u++):0,u<y?m.charCodeAt(u++):0),n=h>>2,l=(3&h)<<4|I>>4,C=1<v?(15&I)<<2|b>>6:64,g=2<v?63&b:64,w.push(a.charAt(n)+a.charAt(l)+a.charAt(C)+a.charAt(g));return w.join("")},i.decode=function(m){var h,I,b,n,l,C,g=0,w=0,u="data:";if(m.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var y,v=3*(m=m.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(m.charAt(m.length-1)===a.charAt(64)&&v--,m.charAt(m.length-2)===a.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=d.uint8array?new Uint8Array(0|v):new Array(0|v);g<m.length;)h=a.indexOf(m.charAt(g++))<<2|(n=a.indexOf(m.charAt(g++)))>>4,I=(15&n)<<4|(l=a.indexOf(m.charAt(g++)))>>2,b=(3&l)<<6|(C=a.indexOf(m.charAt(g++))),y[w++]=h,l!==64&&(y[w++]=I),C!==64&&(y[w++]=b);return y}},{"./support":30,"./utils":32}],2:[function(f,_,i){var s=f("./external"),d=f("./stream/DataWorker"),a=f("./stream/Crc32Probe"),m=f("./stream/DataLengthProbe");function h(I,b,n,l,C){this.compressedSize=I,this.uncompressedSize=b,this.crc32=n,this.compression=l,this.compressedContent=C}h.prototype={getContentWorker:function(){var I=new d(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new m("data_length")),b=this;return I.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),I},getCompressedWorker:function(){return new d(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(I,b,n){return I.pipe(new a).pipe(new m("uncompressedSize")).pipe(b.compressWorker(n)).pipe(new m("compressedSize")).withStreamInfo("compression",b)},_.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(f,_,i){var s=f("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=f("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(f,_,i){var s=f("./utils"),d=function(){for(var a,m=[],h=0;h<256;h++){a=h;for(var I=0;I<8;I++)a=1&a?3988292384^a>>>1:a>>>1;m[h]=a}return m}();_.exports=function(a,m){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?function(h,I,b,n){var l=d,C=n+b;h^=-1;for(var g=n;g<C;g++)h=h>>>8^l[255&(h^I[g])];return-1^h}(0|m,a,a.length,0):function(h,I,b,n){var l=d,C=n+b;h^=-1;for(var g=n;g<C;g++)h=h>>>8^l[255&(h^I.charCodeAt(g))];return-1^h}(0|m,a,a.length,0):0}},{"./utils":32}],5:[function(f,_,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(f,_,i){var s=null;s=typeof Promise!="undefined"?Promise:f("lie"),_.exports={Promise:s}},{lie:37}],7:[function(f,_,i){var s=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",d=f("pako"),a=f("./utils"),m=f("./stream/GenericWorker"),h=s?"uint8array":"array";function I(b,n){m.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=n,this.meta={}}i.magic="\b\0",a.inherits(I,m),I.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(h,b.data),!1)},I.prototype.flush=function(){m.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},I.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this._pako=null},I.prototype._createPako=function(){this._pako=new d[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(n){b.push({data:n,meta:b.meta})}},i.compressWorker=function(b){return new I("Deflate",b)},i.uncompressWorker=function(){return new I("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(f,_,i){function s(l,C){var g,w="";for(g=0;g<C;g++)w+=String.fromCharCode(255&l),l>>>=8;return w}function d(l,C,g,w,u,y){var v,V,D=l.file,z=l.compression,A=y!==h.utf8encode,$=a.transformTo("string",y(D.name)),T=a.transformTo("string",h.utf8encode(D.name)),Z=D.comment,re=a.transformTo("string",y(Z)),E=a.transformTo("string",h.utf8encode(Z)),U=T.length!==D.name.length,p=E.length!==Z.length,O="",ne="",G="",me=D.dir,L=D.date,se={crc32:0,compressedSize:0,uncompressedSize:0};C&&!g||(se.crc32=l.crc32,se.compressedSize=l.compressedSize,se.uncompressedSize=l.uncompressedSize);var q=0;C&&(q|=8),A||!U&&!p||(q|=2048);var N=0,ee=0;me&&(N|=16),u==="UNIX"?(ee=798,N|=function(J,Ie){var ke=J;return J||(ke=Ie?16893:33204),(65535&ke)<<16}(D.unixPermissions,me)):(ee=20,N|=function(J){return 63&(J||0)}(D.dosPermissions)),v=L.getUTCHours(),v<<=6,v|=L.getUTCMinutes(),v<<=5,v|=L.getUTCSeconds()/2,V=L.getUTCFullYear()-1980,V<<=4,V|=L.getUTCMonth()+1,V<<=5,V|=L.getUTCDate(),U&&(ne=s(1,1)+s(I($),4)+T,O+="up"+s(ne.length,2)+ne),p&&(G=s(1,1)+s(I(re),4)+E,O+="uc"+s(G.length,2)+G);var X="";return X+=`
\0`,X+=s(q,2),X+=z.magic,X+=s(v,2),X+=s(V,2),X+=s(se.crc32,4),X+=s(se.compressedSize,4),X+=s(se.uncompressedSize,4),X+=s($.length,2),X+=s(O.length,2),{fileRecord:b.LOCAL_FILE_HEADER+X+$+O,dirRecord:b.CENTRAL_FILE_HEADER+s(ee,2)+X+s(re.length,2)+"\0\0\0\0"+s(N,4)+s(w,4)+$+O+re}}var a=f("../utils"),m=f("../stream/GenericWorker"),h=f("../utf8"),I=f("../crc32"),b=f("../signature");function n(l,C,g,w){m.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=C,this.zipPlatform=g,this.encodeFileName=w,this.streamFiles=l,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(n,m),n.prototype.push=function(l){var C=l.meta.percent||0,g=this.entriesCount,w=this._sources.length;this.accumulate?this.contentBuffer.push(l):(this.bytesWritten+=l.data.length,m.prototype.push.call(this,{data:l.data,meta:{currentFile:this.currentFile,percent:g?(C+100*(g-w-1))/g:100}}))},n.prototype.openedSource=function(l){this.currentSourceOffset=this.bytesWritten,this.currentFile=l.file.name;var C=this.streamFiles&&!l.file.dir;if(C){var g=d(l,C,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},n.prototype.closedSource=function(l){this.accumulate=!1;var C=this.streamFiles&&!l.file.dir,g=d(l,C,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),C)this.push({data:function(w){return b.DATA_DESCRIPTOR+s(w.crc32,4)+s(w.compressedSize,4)+s(w.uncompressedSize,4)}(l),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},n.prototype.flush=function(){for(var l=this.bytesWritten,C=0;C<this.dirRecords.length;C++)this.push({data:this.dirRecords[C],meta:{percent:100}});var g=this.bytesWritten-l,w=function(u,y,v,V,D){var z=a.transformTo("string",D(V));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(u,2)+s(u,2)+s(y,4)+s(v,4)+s(z.length,2)+z}(this.dirRecords.length,g,l,this.zipComment,this.encodeFileName);this.push({data:w,meta:{percent:100}})},n.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},n.prototype.registerPrevious=function(l){this._sources.push(l);var C=this;return l.on("data",function(g){C.processChunk(g)}),l.on("end",function(){C.closedSource(C.previous.streamInfo),C._sources.length?C.prepareNextSource():C.end()}),l.on("error",function(g){C.error(g)}),this},n.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},n.prototype.error=function(l){var C=this._sources;if(!m.prototype.error.call(this,l))return!1;for(var g=0;g<C.length;g++)try{C[g].error(l)}catch{}return!0},n.prototype.lock=function(){m.prototype.lock.call(this);for(var l=this._sources,C=0;C<l.length;C++)l[C].lock()},_.exports=n},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(f,_,i){var s=f("../compressions"),d=f("./ZipFileWorker");i.generateWorker=function(a,m,h){var I=new d(m.streamFiles,h,m.platform,m.encodeFileName),b=0;try{a.forEach(function(n,l){b++;var C=function(y,v){var V=y||v,D=s[V];if(!D)throw new Error(V+" is not a valid compression method !");return D}(l.options.compression,m.compression),g=l.options.compressionOptions||m.compressionOptions||{},w=l.dir,u=l.date;l._compressWorker(C,g).withStreamInfo("file",{name:n,dir:w,date:u,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(I)}),I.entriesCount=b}catch(n){I.error(n)}return I}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(f,_,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var d=new s;for(var a in this)typeof this[a]!="function"&&(d[a]=this[a]);return d}}(s.prototype=f("./object")).loadAsync=f("./load"),s.support=f("./support"),s.defaults=f("./defaults"),s.version="3.10.1",s.loadAsync=function(d,a){return new s().loadAsync(d,a)},s.external=f("./external"),_.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(f,_,i){var s=f("./utils"),d=f("./external"),a=f("./utf8"),m=f("./zipEntries"),h=f("./stream/Crc32Probe"),I=f("./nodejsUtils");function b(n){return new d.Promise(function(l,C){var g=n.decompressed.getContentWorker().pipe(new h);g.on("error",function(w){C(w)}).on("end",function(){g.streamInfo.crc32!==n.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):l()}).resume()})}_.exports=function(n,l){var C=this;return l=s.extend(l||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),I.isNode&&I.isStream(n)?d.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",n,!0,l.optimizedBinaryString,l.base64).then(function(g){var w=new m(l);return w.load(g),w}).then(function(g){var w=[d.Promise.resolve(g)],u=g.files;if(l.checkCRC32)for(var y=0;y<u.length;y++)w.push(b(u[y]));return d.Promise.all(w)}).then(function(g){for(var w=g.shift(),u=w.files,y=0;y<u.length;y++){var v=u[y],V=v.fileNameStr,D=s.resolve(v.fileNameStr);C.file(D,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:l.createFolders}),v.dir||(C.file(D).unsafeOriginalName=V)}return w.zipComment.length&&(C.comment=w.zipComment),C})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(f,_,i){var s=f("../utils"),d=f("../stream/GenericWorker");function a(m,h){d.call(this,"Nodejs stream input adapter for "+m),this._upstreamEnded=!1,this._bindStream(h)}s.inherits(a,d),a.prototype._bindStream=function(m){var h=this;(this._stream=m).pause(),m.on("data",function(I){h.push({data:I,meta:{percent:0}})}).on("error",function(I){h.isPaused?this.generatedError=I:h.error(I)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},a.prototype.pause=function(){return!!d.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},_.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(f,_,i){var s=f("readable-stream").Readable;function d(a,m,h){s.call(this,m),this._helper=a;var I=this;a.on("data",function(b,n){I.push(b)||I._helper.pause(),h&&h(n)}).on("error",function(b){I.emit("error",b)}).on("end",function(){I.push(null)})}f("../utils").inherits(d,s),d.prototype._read=function(){this._helper.resume()},_.exports=d},{"../utils":32,"readable-stream":16}],14:[function(f,_,i){_.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(s,d){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,d);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,d)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var d=new Buffer(s);return d.fill(0),d},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(f,_,i){function s(D,z,A){var $,T=a.getTypeOf(z),Z=a.extend(A||{},I);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(D=u(D)),Z.createFolders&&($=w(D))&&y.call(this,$,!0);var re=T==="string"&&Z.binary===!1&&Z.base64===!1;A&&A.binary!==void 0||(Z.binary=!re),(z instanceof b&&z.uncompressedSize===0||Z.dir||!z||z.length===0)&&(Z.base64=!1,Z.binary=!0,z="",Z.compression="STORE",T="string");var E=null;E=z instanceof b||z instanceof m?z:C.isNode&&C.isStream(z)?new g(D,z):a.prepareContent(D,z,Z.binary,Z.optimizedBinaryString,Z.base64);var U=new n(D,E,Z);this.files[D]=U}var d=f("./utf8"),a=f("./utils"),m=f("./stream/GenericWorker"),h=f("./stream/StreamHelper"),I=f("./defaults"),b=f("./compressedObject"),n=f("./zipObject"),l=f("./generate"),C=f("./nodejsUtils"),g=f("./nodejs/NodejsStreamInputAdapter"),w=function(D){D.slice(-1)==="/"&&(D=D.substring(0,D.length-1));var z=D.lastIndexOf("/");return 0<z?D.substring(0,z):""},u=function(D){return D.slice(-1)!=="/"&&(D+="/"),D},y=function(D,z){return z=z!==void 0?z:I.createFolders,D=u(D),this.files[D]||s.call(this,D,null,{dir:!0,createFolders:z}),this.files[D]};function v(D){return Object.prototype.toString.call(D)==="[object RegExp]"}var V={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(D){var z,A,$;for(z in this.files)$=this.files[z],(A=z.slice(this.root.length,z.length))&&z.slice(0,this.root.length)===this.root&&D(A,$)},filter:function(D){var z=[];return this.forEach(function(A,$){D(A,$)&&z.push($)}),z},file:function(D,z,A){if(arguments.length!==1)return D=this.root+D,s.call(this,D,z,A),this;if(v(D)){var $=D;return this.filter(function(Z,re){return!re.dir&&$.test(Z)})}var T=this.files[this.root+D];return T&&!T.dir?T:null},folder:function(D){if(!D)return this;if(v(D))return this.filter(function(T,Z){return Z.dir&&D.test(T)});var z=this.root+D,A=y.call(this,z),$=this.clone();return $.root=A.name,$},remove:function(D){D=this.root+D;var z=this.files[D];if(z||(D.slice(-1)!=="/"&&(D+="/"),z=this.files[D]),z&&!z.dir)delete this.files[D];else for(var A=this.filter(function(T,Z){return Z.name.slice(0,D.length)===D}),$=0;$<A.length;$++)delete this.files[A[$].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(D){var z,A={};try{if((A=a.extend(D||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");a.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var $=A.comment||this.comment||"";z=l.generateWorker(this,A,$)}catch(T){(z=new m("error")).error(T)}return new h(z,A.type||"string",A.mimeType)},generateAsync:function(D,z){return this.generateInternalStream(D).accumulate(z)},generateNodeStream:function(D,z){return(D=D||{}).type||(D.type="nodebuffer"),this.generateInternalStream(D).toNodejsStream(z)}};_.exports=V},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(f,_,i){_.exports=f("stream")},{stream:void 0}],17:[function(f,_,i){var s=f("./DataReader");function d(a){s.call(this,a);for(var m=0;m<this.data.length;m++)a[m]=255&a[m]}f("../utils").inherits(d,s),d.prototype.byteAt=function(a){return this.data[this.zero+a]},d.prototype.lastIndexOfSignature=function(a){for(var m=a.charCodeAt(0),h=a.charCodeAt(1),I=a.charCodeAt(2),b=a.charCodeAt(3),n=this.length-4;0<=n;--n)if(this.data[n]===m&&this.data[n+1]===h&&this.data[n+2]===I&&this.data[n+3]===b)return n-this.zero;return-1},d.prototype.readAndCheckSignature=function(a){var m=a.charCodeAt(0),h=a.charCodeAt(1),I=a.charCodeAt(2),b=a.charCodeAt(3),n=this.readData(4);return m===n[0]&&h===n[1]&&I===n[2]&&b===n[3]},d.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var m=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,m},_.exports=d},{"../utils":32,"./DataReader":18}],18:[function(f,_,i){var s=f("../utils");function d(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}d.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var m,h=0;for(this.checkOffset(a),m=this.index+a-1;m>=this.index;m--)h=(h<<8)+this.byteAt(m);return this.index+=a,h},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},_.exports=d},{"../utils":32}],19:[function(f,_,i){var s=f("./Uint8ArrayReader");function d(a){s.call(this,a)}f("../utils").inherits(d,s),d.prototype.readData=function(a){this.checkOffset(a);var m=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,m},_.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(f,_,i){var s=f("./DataReader");function d(a){s.call(this,a)}f("../utils").inherits(d,s),d.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},d.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},d.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},d.prototype.readData=function(a){this.checkOffset(a);var m=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,m},_.exports=d},{"../utils":32,"./DataReader":18}],21:[function(f,_,i){var s=f("./ArrayReader");function d(a){s.call(this,a)}f("../utils").inherits(d,s),d.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var m=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,m},_.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(f,_,i){var s=f("../utils"),d=f("../support"),a=f("./ArrayReader"),m=f("./StringReader"),h=f("./NodeBufferReader"),I=f("./Uint8ArrayReader");_.exports=function(b){var n=s.getTypeOf(b);return s.checkSupport(n),n!=="string"||d.uint8array?n==="nodebuffer"?new h(b):d.uint8array?new I(s.transformTo("uint8array",b)):new a(s.transformTo("array",b)):new m(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(f,_,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(f,_,i){var s=f("./GenericWorker"),d=f("../utils");function a(m){s.call(this,"ConvertWorker to "+m),this.destType=m}d.inherits(a,s),a.prototype.processChunk=function(m){this.push({data:d.transformTo(this.destType,m.data),meta:m.meta})},_.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(f,_,i){var s=f("./GenericWorker"),d=f("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}f("../utils").inherits(a,s),a.prototype.processChunk=function(m){this.streamInfo.crc32=d(m.data,this.streamInfo.crc32||0),this.push(m)},_.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(f,_,i){var s=f("../utils"),d=f("./GenericWorker");function a(m){d.call(this,"DataLengthProbe for "+m),this.propName=m,this.withStreamInfo(m,0)}s.inherits(a,d),a.prototype.processChunk=function(m){if(m){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+m.data.length}d.prototype.processChunk.call(this,m)},_.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(f,_,i){var s=f("../utils"),d=f("./GenericWorker");function a(m){d.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,m.then(function(I){h.dataIsReady=!0,h.data=I,h.max=I&&I.length||0,h.type=s.getTypeOf(I),h.isPaused||h._tickAndRepeat()},function(I){h.error(I)})}s.inherits(a,d),a.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var m=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":m=this.data.substring(this.index,h);break;case"uint8array":m=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":m=this.data.slice(this.index,h)}return this.index=h,this.push({data:m,meta:{percent:this.max?this.index/this.max*100:0}})},_.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(f,_,i){function s(d){this.name=d||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(d){this.emit("data",d)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(d){this.emit("error",d)}return!0},error:function(d){return!this.isFinished&&(this.isPaused?this.generatedError=d:(this.isFinished=!0,this.emit("error",d),this.previous&&this.previous.error(d),this.cleanUp()),!0)},on:function(d,a){return this._listeners[d].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(d,a){if(this._listeners[d])for(var m=0;m<this._listeners[d].length;m++)this._listeners[d][m].call(this,a)},pipe:function(d){return d.registerPrevious(this)},registerPrevious:function(d){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=d.streamInfo,this.mergeStreamInfo(),this.previous=d;var a=this;return d.on("data",function(m){a.processChunk(m)}),d.on("end",function(){a.end()}),d.on("error",function(m){a.error(m)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var d=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),d=!0),this.previous&&this.previous.resume(),!d},flush:function(){},processChunk:function(d){this.push(d)},withStreamInfo:function(d,a){return this.extraStreamInfo[d]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var d in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,d)&&(this.streamInfo[d]=this.extraStreamInfo[d])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var d="Worker "+this.name;return this.previous?this.previous+" -> "+d:d}},_.exports=s},{}],29:[function(f,_,i){var s=f("../utils"),d=f("./ConvertWorker"),a=f("./GenericWorker"),m=f("../base64"),h=f("../support"),I=f("../external"),b=null;if(h.nodestream)try{b=f("../nodejs/NodejsStreamOutputAdapter")}catch{}function n(C,g){return new I.Promise(function(w,u){var y=[],v=C._internalType,V=C._outputType,D=C._mimeType;C.on("data",function(z,A){y.push(z),g&&g(A)}).on("error",function(z){y=[],u(z)}).on("end",function(){try{var z=function(A,$,T){switch(A){case"blob":return s.newBlob(s.transformTo("arraybuffer",$),T);case"base64":return m.encode($);default:return s.transformTo(A,$)}}(V,function(A,$){var T,Z=0,re=null,E=0;for(T=0;T<$.length;T++)E+=$[T].length;switch(A){case"string":return $.join("");case"array":return Array.prototype.concat.apply([],$);case"uint8array":for(re=new Uint8Array(E),T=0;T<$.length;T++)re.set($[T],Z),Z+=$[T].length;return re;case"nodebuffer":return Buffer.concat($);default:throw new Error("concat : unsupported type '"+A+"'")}}(v,y),D);w(z)}catch(A){u(A)}y=[]}).resume()})}function l(C,g,w){var u=g;switch(g){case"blob":case"arraybuffer":u="uint8array";break;case"base64":u="string"}try{this._internalType=u,this._outputType=g,this._mimeType=w,s.checkSupport(u),this._worker=C.pipe(new d(u)),C.lock()}catch(y){this._worker=new a("error"),this._worker.error(y)}}l.prototype={accumulate:function(C){return n(this,C)},on:function(C,g){var w=this;return C==="data"?this._worker.on(C,function(u){g.call(w,u.data,u.meta)}):this._worker.on(C,function(){s.delay(g,arguments,w)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(C){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},C)}},_.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(f,_,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",i.nodebuffer=typeof Buffer!="undefined",i.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);d.append(s),i.blob=d.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!f("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(f,_,i){for(var s=f("./utils"),d=f("./support"),a=f("./nodejsUtils"),m=f("./stream/GenericWorker"),h=new Array(256),I=0;I<256;I++)h[I]=252<=I?6:248<=I?5:240<=I?4:224<=I?3:192<=I?2:1;h[254]=h[254]=1;function b(){m.call(this,"utf-8 decode"),this.leftOver=null}function n(){m.call(this,"utf-8 encode")}i.utf8encode=function(l){return d.nodebuffer?a.newBufferFrom(l,"utf-8"):function(C){var g,w,u,y,v,V=C.length,D=0;for(y=0;y<V;y++)(64512&(w=C.charCodeAt(y)))==55296&&y+1<V&&(64512&(u=C.charCodeAt(y+1)))==56320&&(w=65536+(w-55296<<10)+(u-56320),y++),D+=w<128?1:w<2048?2:w<65536?3:4;for(g=d.uint8array?new Uint8Array(D):new Array(D),y=v=0;v<D;y++)(64512&(w=C.charCodeAt(y)))==55296&&y+1<V&&(64512&(u=C.charCodeAt(y+1)))==56320&&(w=65536+(w-55296<<10)+(u-56320),y++),w<128?g[v++]=w:(w<2048?g[v++]=192|w>>>6:(w<65536?g[v++]=224|w>>>12:(g[v++]=240|w>>>18,g[v++]=128|w>>>12&63),g[v++]=128|w>>>6&63),g[v++]=128|63&w);return g}(l)},i.utf8decode=function(l){return d.nodebuffer?s.transformTo("nodebuffer",l).toString("utf-8"):function(C){var g,w,u,y,v=C.length,V=new Array(2*v);for(g=w=0;g<v;)if((u=C[g++])<128)V[w++]=u;else if(4<(y=h[u]))V[w++]=65533,g+=y-1;else{for(u&=y===2?31:y===3?15:7;1<y&&g<v;)u=u<<6|63&C[g++],y--;1<y?V[w++]=65533:u<65536?V[w++]=u:(u-=65536,V[w++]=55296|u>>10&1023,V[w++]=56320|1023&u)}return V.length!==w&&(V.subarray?V=V.subarray(0,w):V.length=w),s.applyFromCharCode(V)}(l=s.transformTo(d.uint8array?"uint8array":"array",l))},s.inherits(b,m),b.prototype.processChunk=function(l){var C=s.transformTo(d.uint8array?"uint8array":"array",l.data);if(this.leftOver&&this.leftOver.length){if(d.uint8array){var g=C;(C=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),C.set(g,this.leftOver.length)}else C=this.leftOver.concat(C);this.leftOver=null}var w=function(y,v){var V;for((v=v||y.length)>y.length&&(v=y.length),V=v-1;0<=V&&(192&y[V])==128;)V--;return V<0||V===0?v:V+h[y[V]]>v?V:v}(C),u=C;w!==C.length&&(d.uint8array?(u=C.subarray(0,w),this.leftOver=C.subarray(w,C.length)):(u=C.slice(0,w),this.leftOver=C.slice(w,C.length))),this.push({data:i.utf8decode(u),meta:l.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=b,s.inherits(n,m),n.prototype.processChunk=function(l){this.push({data:i.utf8encode(l.data),meta:l.meta})},i.Utf8EncodeWorker=n},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(f,_,i){var s=f("./support"),d=f("./base64"),a=f("./nodejsUtils"),m=f("./external");function h(g){return g}function I(g,w){for(var u=0;u<g.length;++u)w[u]=255&g.charCodeAt(u);return w}f("setimmediate"),i.newBlob=function(g,w){i.checkSupport("blob");try{return new Blob([g],{type:w})}catch{try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return u.append(g),u.getBlob(w)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(g,w,u){var y=[],v=0,V=g.length;if(V<=u)return String.fromCharCode.apply(null,g);for(;v<V;)w==="array"||w==="nodebuffer"?y.push(String.fromCharCode.apply(null,g.slice(v,Math.min(v+u,V)))):y.push(String.fromCharCode.apply(null,g.subarray(v,Math.min(v+u,V)))),v+=u;return y.join("")},stringifyByChar:function(g){for(var w="",u=0;u<g.length;u++)w+=String.fromCharCode(g[u]);return w},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function n(g){var w=65536,u=i.getTypeOf(g),y=!0;if(u==="uint8array"?y=b.applyCanBeUsed.uint8array:u==="nodebuffer"&&(y=b.applyCanBeUsed.nodebuffer),y)for(;1<w;)try{return b.stringifyByChunk(g,u,w)}catch{w=Math.floor(w/2)}return b.stringifyByChar(g)}function l(g,w){for(var u=0;u<g.length;u++)w[u]=g[u];return w}i.applyFromCharCode=n;var C={};C.string={string:h,array:function(g){return I(g,new Array(g.length))},arraybuffer:function(g){return C.string.uint8array(g).buffer},uint8array:function(g){return I(g,new Uint8Array(g.length))},nodebuffer:function(g){return I(g,a.allocBuffer(g.length))}},C.array={string:n,array:h,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(g)}},C.arraybuffer={string:function(g){return n(new Uint8Array(g))},array:function(g){return l(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:h,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(new Uint8Array(g))}},C.uint8array={string:n,array:function(g){return l(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:h,nodebuffer:function(g){return a.newBufferFrom(g)}},C.nodebuffer={string:n,array:function(g){return l(g,new Array(g.length))},arraybuffer:function(g){return C.nodebuffer.uint8array(g).buffer},uint8array:function(g){return l(g,new Uint8Array(g.length))},nodebuffer:h},i.transformTo=function(g,w){if(w=w||"",!g)return w;i.checkSupport(g);var u=i.getTypeOf(w);return C[u][g](w)},i.resolve=function(g){for(var w=g.split("/"),u=[],y=0;y<w.length;y++){var v=w[y];v==="."||v===""&&y!==0&&y!==w.length-1||(v===".."?u.pop():u.push(v))}return u.join("/")},i.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(g)?"nodebuffer":s.uint8array&&g instanceof Uint8Array?"uint8array":s.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(g){if(!s[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(g){var w,u,y="";for(u=0;u<(g||"").length;u++)y+="\\x"+((w=g.charCodeAt(u))<16?"0":"")+w.toString(16).toUpperCase();return y},i.delay=function(g,w,u){setImmediate(function(){g.apply(u||null,w||[])})},i.inherits=function(g,w){function u(){}u.prototype=w.prototype,g.prototype=new u},i.extend=function(){var g,w,u={};for(g=0;g<arguments.length;g++)for(w in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],w)&&u[w]===void 0&&(u[w]=arguments[g][w]);return u},i.prepareContent=function(g,w,u,y,v){return m.Promise.resolve(w).then(function(V){return s.blob&&(V instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(V))!==-1)&&typeof FileReader!="undefined"?new m.Promise(function(D,z){var A=new FileReader;A.onload=function($){D($.target.result)},A.onerror=function($){z($.target.error)},A.readAsArrayBuffer(V)}):V}).then(function(V){var D=i.getTypeOf(V);return D?(D==="arraybuffer"?V=i.transformTo("uint8array",V):D==="string"&&(v?V=d.decode(V):u&&y!==!0&&(V=function(z){return I(z,s.uint8array?new Uint8Array(z.length):new Array(z.length))}(V))),V):m.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(f,_,i){var s=f("./reader/readerFor"),d=f("./utils"),a=f("./signature"),m=f("./zipEntry"),h=f("./support");function I(b){this.files=[],this.loadOptions=b}I.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var n=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+d.pretty(n)+", expected "+d.pretty(b)+")")}},isSignature:function(b,n){var l=this.reader.index;this.reader.setIndex(b);var C=this.reader.readString(4)===n;return this.reader.setIndex(l),C},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),n=h.uint8array?"uint8array":"array",l=d.transformTo(n,b);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,n,l,C=this.zip64EndOfCentralSize-44;0<C;)b=this.reader.readInt(2),n=this.reader.readInt(4),l=this.reader.readData(n),this.zip64ExtensibleData[b]={id:b,length:n,value:l}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,n;for(b=0;b<this.files.length;b++)n=this.files[b],this.reader.setIndex(n.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),n.readLocalPart(this.reader),n.handleUTF8(),n.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(b=new m({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var n=b;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===d.MAX_VALUE_16BITS||this.diskWithCentralDirStart===d.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===d.MAX_VALUE_16BITS||this.centralDirRecords===d.MAX_VALUE_16BITS||this.centralDirSize===d.MAX_VALUE_32BITS||this.centralDirOffset===d.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var l=this.centralDirOffset+this.centralDirSize;this.zip64&&(l+=20,l+=12+this.zip64EndOfCentralSize);var C=n-l;if(0<C)this.isSignature(n,a.CENTRAL_FILE_HEADER)||(this.reader.zero=C);else if(C<0)throw new Error("Corrupted zip: missing "+Math.abs(C)+" bytes.")},prepareReader:function(b){this.reader=s(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},_.exports=I},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(f,_,i){var s=f("./reader/readerFor"),d=f("./utils"),a=f("./compressedObject"),m=f("./crc32"),h=f("./utf8"),I=f("./compressions"),b=f("./support");function n(l,C){this.options=l,this.loadOptions=C}n.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(l){var C,g;if(l.skip(22),this.fileNameLength=l.readInt(2),g=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((C=function(w){for(var u in I)if(Object.prototype.hasOwnProperty.call(I,u)&&I[u].magic===w)return I[u];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+d.pretty(this.compressionMethod)+" unknown (inner file : "+d.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,C,l.readData(this.compressedSize))},readCentralPart:function(l){this.versionMadeBy=l.readInt(2),l.skip(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4);var C=l.readInt(2);if(this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");l.skip(C),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l==0&&(this.dosPermissions=63&this.externalFileAttributes),l==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var l=s(this.extraFields[1].value);this.uncompressedSize===d.MAX_VALUE_32BITS&&(this.uncompressedSize=l.readInt(8)),this.compressedSize===d.MAX_VALUE_32BITS&&(this.compressedSize=l.readInt(8)),this.localHeaderOffset===d.MAX_VALUE_32BITS&&(this.localHeaderOffset=l.readInt(8)),this.diskNumberStart===d.MAX_VALUE_32BITS&&(this.diskNumberStart=l.readInt(4))}},readExtraFields:function(l){var C,g,w,u=l.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});l.index+4<u;)C=l.readInt(2),g=l.readInt(2),w=l.readData(g),this.extraFields[C]={id:C,length:g,value:w};l.setIndex(u)},handleUTF8:function(){var l=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var C=this.findExtraFieldUnicodePath();if(C!==null)this.fileNameStr=C;else{var g=d.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var u=d.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(u)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var C=s(l.value);return C.readInt(1)!==1||m(this.fileName)!==C.readInt(4)?null:h.utf8decode(C.readData(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var C=s(l.value);return C.readInt(1)!==1||m(this.fileComment)!==C.readInt(4)?null:h.utf8decode(C.readData(l.length-5))}return null}},_.exports=n},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(f,_,i){function s(C,g,w){this.name=C,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=g,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}}var d=f("./stream/StreamHelper"),a=f("./stream/DataWorker"),m=f("./utf8"),h=f("./compressedObject"),I=f("./stream/GenericWorker");s.prototype={internalStream:function(C){var g=null,w="string";try{if(!C)throw new Error("No output type specified.");var u=(w=C.toLowerCase())==="string"||w==="text";w!=="binarystring"&&w!=="text"||(w="string"),g=this._decompressWorker();var y=!this._dataBinary;y&&!u&&(g=g.pipe(new m.Utf8EncodeWorker)),!y&&u&&(g=g.pipe(new m.Utf8DecodeWorker))}catch(v){(g=new I("error")).error(v)}return new d(g,w,"")},async:function(C,g){return this.internalStream(C).accumulate(g)},nodeStream:function(C,g){return this.internalStream(C||"nodebuffer").toNodejsStream(g)},_compressWorker:function(C,g){if(this._data instanceof h&&this._data.compression.magic===C.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new m.Utf8EncodeWorker)),h.createWorkerFrom(w,C,g)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof I?this._data:new a(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],n=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<b.length;l++)s.prototype[b[l]]=n;_.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(f,_,i){(function(s){var d,a,m=s.MutationObserver||s.WebKitMutationObserver;if(m){var h=0,I=new m(C),b=s.document.createTextNode("");I.observe(b,{characterData:!0}),d=function(){b.data=h=++h%2}}else if(s.setImmediate||s.MessageChannel===void 0)d="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var g=s.document.createElement("script");g.onreadystatechange=function(){C(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},s.document.documentElement.appendChild(g)}:function(){setTimeout(C,0)};else{var n=new s.MessageChannel;n.port1.onmessage=C,d=function(){n.port2.postMessage(0)}}var l=[];function C(){var g,w;a=!0;for(var u=l.length;u;){for(w=l,l=[],g=-1;++g<u;)w[g]();u=l.length}a=!1}_.exports=function(g){l.push(g)!==1||a||d()}}).call(this,typeof rt!="undefined"?rt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(f,_,i){var s=f("immediate");function d(){}var a={},m=["REJECTED"],h=["FULFILLED"],I=["PENDING"];function b(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,u!==d&&g(this,u)}function n(u,y,v){this.promise=u,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function l(u,y,v){s(function(){var V;try{V=y(v)}catch(D){return a.reject(u,D)}V===u?a.reject(u,new TypeError("Cannot resolve promise with itself")):a.resolve(u,V)})}function C(u){var y=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof y=="function")return function(){y.apply(u,arguments)}}function g(u,y){var v=!1;function V(A){v||(v=!0,a.reject(u,A))}function D(A){v||(v=!0,a.resolve(u,A))}var z=w(function(){y(D,V)});z.status==="error"&&V(z.value)}function w(u,y){var v={};try{v.value=u(y),v.status="success"}catch(V){v.status="error",v.value=V}return v}(_.exports=b).prototype.finally=function(u){if(typeof u!="function")return this;var y=this.constructor;return this.then(function(v){return y.resolve(u()).then(function(){return v})},function(v){return y.resolve(u()).then(function(){throw v})})},b.prototype.catch=function(u){return this.then(null,u)},b.prototype.then=function(u,y){if(typeof u!="function"&&this.state===h||typeof y!="function"&&this.state===m)return this;var v=new this.constructor(d);return this.state!==I?l(v,this.state===h?u:y,this.outcome):this.queue.push(new n(v,u,y)),v},n.prototype.callFulfilled=function(u){a.resolve(this.promise,u)},n.prototype.otherCallFulfilled=function(u){l(this.promise,this.onFulfilled,u)},n.prototype.callRejected=function(u){a.reject(this.promise,u)},n.prototype.otherCallRejected=function(u){l(this.promise,this.onRejected,u)},a.resolve=function(u,y){var v=w(C,y);if(v.status==="error")return a.reject(u,v.value);var V=v.value;if(V)g(u,V);else{u.state=h,u.outcome=y;for(var D=-1,z=u.queue.length;++D<z;)u.queue[D].callFulfilled(y)}return u},a.reject=function(u,y){u.state=m,u.outcome=y;for(var v=-1,V=u.queue.length;++v<V;)u.queue[v].callRejected(y);return u},b.resolve=function(u){return u instanceof this?u:a.resolve(new this(d),u)},b.reject=function(u){var y=new this(d);return a.reject(y,u)},b.all=function(u){var y=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=u.length,V=!1;if(!v)return this.resolve([]);for(var D=new Array(v),z=0,A=-1,$=new this(d);++A<v;)T(u[A],A);return $;function T(Z,re){y.resolve(Z).then(function(E){D[re]=E,++z!==v||V||(V=!0,a.resolve($,D))},function(E){V||(V=!0,a.reject($,E))})}},b.race=function(u){var y=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=u.length,V=!1;if(!v)return this.resolve([]);for(var D=-1,z=new this(d);++D<v;)A=u[D],y.resolve(A).then(function($){V||(V=!0,a.resolve(z,$))},function($){V||(V=!0,a.reject(z,$))});var A;return z}},{immediate:36}],38:[function(f,_,i){var s={};(0,f("./lib/utils/common").assign)(s,f("./lib/deflate"),f("./lib/inflate"),f("./lib/zlib/constants")),_.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(f,_,i){var s=f("./zlib/deflate"),d=f("./utils/common"),a=f("./utils/strings"),m=f("./zlib/messages"),h=f("./zlib/zstream"),I=Object.prototype.toString,b=0,n=-1,l=0,C=8;function g(u){if(!(this instanceof g))return new g(u);this.options=d.assign({level:n,method:C,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},u||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var v=s.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(v!==b)throw new Error(m[v]);if(y.header&&s.deflateSetHeader(this.strm,y.header),y.dictionary){var V;if(V=typeof y.dictionary=="string"?a.string2buf(y.dictionary):I.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(v=s.deflateSetDictionary(this.strm,V))!==b)throw new Error(m[v]);this._dict_set=!0}}function w(u,y){var v=new g(y);if(v.push(u,!0),v.err)throw v.msg||m[v.err];return v.result}g.prototype.push=function(u,y){var v,V,D=this.strm,z=this.options.chunkSize;if(this.ended)return!1;V=y===~~y?y:y===!0?4:0,typeof u=="string"?D.input=a.string2buf(u):I.call(u)==="[object ArrayBuffer]"?D.input=new Uint8Array(u):D.input=u,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new d.Buf8(z),D.next_out=0,D.avail_out=z),(v=s.deflate(D,V))!==1&&v!==b)return this.onEnd(v),!(this.ended=!0);D.avail_out!==0&&(D.avail_in!==0||V!==4&&V!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(d.shrinkBuf(D.output,D.next_out))):this.onData(d.shrinkBuf(D.output,D.next_out)))}while((0<D.avail_in||D.avail_out===0)&&v!==1);return V===4?(v=s.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===b):V!==2||(this.onEnd(b),!(D.avail_out=0))},g.prototype.onData=function(u){this.chunks.push(u)},g.prototype.onEnd=function(u){u===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg},i.Deflate=g,i.deflate=w,i.deflateRaw=function(u,y){return(y=y||{}).raw=!0,w(u,y)},i.gzip=function(u,y){return(y=y||{}).gzip=!0,w(u,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(f,_,i){var s=f("./zlib/inflate"),d=f("./utils/common"),a=f("./utils/strings"),m=f("./zlib/constants"),h=f("./zlib/messages"),I=f("./zlib/zstream"),b=f("./zlib/gzheader"),n=Object.prototype.toString;function l(g){if(!(this instanceof l))return new l(g);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},g||{});var w=this.options;w.raw&&0<=w.windowBits&&w.windowBits<16&&(w.windowBits=-w.windowBits,w.windowBits===0&&(w.windowBits=-15)),!(0<=w.windowBits&&w.windowBits<16)||g&&g.windowBits||(w.windowBits+=32),15<w.windowBits&&w.windowBits<48&&(15&w.windowBits)==0&&(w.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var u=s.inflateInit2(this.strm,w.windowBits);if(u!==m.Z_OK)throw new Error(h[u]);this.header=new b,s.inflateGetHeader(this.strm,this.header)}function C(g,w){var u=new l(w);if(u.push(g,!0),u.err)throw u.msg||h[u.err];return u.result}l.prototype.push=function(g,w){var u,y,v,V,D,z,A=this.strm,$=this.options.chunkSize,T=this.options.dictionary,Z=!1;if(this.ended)return!1;y=w===~~w?w:w===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof g=="string"?A.input=a.binstring2buf(g):n.call(g)==="[object ArrayBuffer]"?A.input=new Uint8Array(g):A.input=g,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new d.Buf8($),A.next_out=0,A.avail_out=$),(u=s.inflate(A,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&T&&(z=typeof T=="string"?a.string2buf(T):n.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,u=s.inflateSetDictionary(this.strm,z)),u===m.Z_BUF_ERROR&&Z===!0&&(u=m.Z_OK,Z=!1),u!==m.Z_STREAM_END&&u!==m.Z_OK)return this.onEnd(u),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&u!==m.Z_STREAM_END&&(A.avail_in!==0||y!==m.Z_FINISH&&y!==m.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=a.utf8border(A.output,A.next_out),V=A.next_out-v,D=a.buf2string(A.output,v),A.next_out=V,A.avail_out=$-V,V&&d.arraySet(A.output,A.output,v,V,0),this.onData(D)):this.onData(d.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(Z=!0)}while((0<A.avail_in||A.avail_out===0)&&u!==m.Z_STREAM_END);return u===m.Z_STREAM_END&&(y=m.Z_FINISH),y===m.Z_FINISH?(u=s.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===m.Z_OK):y!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(A.avail_out=0))},l.prototype.onData=function(g){this.chunks.push(g)},l.prototype.onEnd=function(g){g===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},i.Inflate=l,i.inflate=C,i.inflateRaw=function(g,w){return(w=w||{}).raw=!0,C(g,w)},i.ungzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(f,_,i){var s=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";i.assign=function(m){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var I=h.shift();if(I){if(typeof I!="object")throw new TypeError(I+"must be non-object");for(var b in I)I.hasOwnProperty(b)&&(m[b]=I[b])}}return m},i.shrinkBuf=function(m,h){return m.length===h?m:m.subarray?m.subarray(0,h):(m.length=h,m)};var d={arraySet:function(m,h,I,b,n){if(h.subarray&&m.subarray)m.set(h.subarray(I,I+b),n);else for(var l=0;l<b;l++)m[n+l]=h[I+l]},flattenChunks:function(m){var h,I,b,n,l,C;for(h=b=0,I=m.length;h<I;h++)b+=m[h].length;for(C=new Uint8Array(b),h=n=0,I=m.length;h<I;h++)l=m[h],C.set(l,n),n+=l.length;return C}},a={arraySet:function(m,h,I,b,n){for(var l=0;l<b;l++)m[n+l]=h[I+l]},flattenChunks:function(m){return[].concat.apply([],m)}};i.setTyped=function(m){m?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,d)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(s)},{}],42:[function(f,_,i){var s=f("./common"),d=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var m=new s.Buf8(256),h=0;h<256;h++)m[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function I(b,n){if(n<65537&&(b.subarray&&a||!b.subarray&&d))return String.fromCharCode.apply(null,s.shrinkBuf(b,n));for(var l="",C=0;C<n;C++)l+=String.fromCharCode(b[C]);return l}m[254]=m[254]=1,i.string2buf=function(b){var n,l,C,g,w,u=b.length,y=0;for(g=0;g<u;g++)(64512&(l=b.charCodeAt(g)))==55296&&g+1<u&&(64512&(C=b.charCodeAt(g+1)))==56320&&(l=65536+(l-55296<<10)+(C-56320),g++),y+=l<128?1:l<2048?2:l<65536?3:4;for(n=new s.Buf8(y),g=w=0;w<y;g++)(64512&(l=b.charCodeAt(g)))==55296&&g+1<u&&(64512&(C=b.charCodeAt(g+1)))==56320&&(l=65536+(l-55296<<10)+(C-56320),g++),l<128?n[w++]=l:(l<2048?n[w++]=192|l>>>6:(l<65536?n[w++]=224|l>>>12:(n[w++]=240|l>>>18,n[w++]=128|l>>>12&63),n[w++]=128|l>>>6&63),n[w++]=128|63&l);return n},i.buf2binstring=function(b){return I(b,b.length)},i.binstring2buf=function(b){for(var n=new s.Buf8(b.length),l=0,C=n.length;l<C;l++)n[l]=b.charCodeAt(l);return n},i.buf2string=function(b,n){var l,C,g,w,u=n||b.length,y=new Array(2*u);for(l=C=0;l<u;)if((g=b[l++])<128)y[C++]=g;else if(4<(w=m[g]))y[C++]=65533,l+=w-1;else{for(g&=w===2?31:w===3?15:7;1<w&&l<u;)g=g<<6|63&b[l++],w--;1<w?y[C++]=65533:g<65536?y[C++]=g:(g-=65536,y[C++]=55296|g>>10&1023,y[C++]=56320|1023&g)}return I(y,C)},i.utf8border=function(b,n){var l;for((n=n||b.length)>b.length&&(n=b.length),l=n-1;0<=l&&(192&b[l])==128;)l--;return l<0||l===0?n:l+m[b[l]]>n?l:n}},{"./common":41}],43:[function(f,_,i){_.exports=function(s,d,a,m){for(var h=65535&s|0,I=s>>>16&65535|0,b=0;a!==0;){for(a-=b=2e3<a?2e3:a;I=I+(h=h+d[m++]|0)|0,--b;);h%=65521,I%=65521}return h|I<<16|0}},{}],44:[function(f,_,i){_.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(f,_,i){var s=function(){for(var d,a=[],m=0;m<256;m++){d=m;for(var h=0;h<8;h++)d=1&d?3988292384^d>>>1:d>>>1;a[m]=d}return a}();_.exports=function(d,a,m,h){var I=s,b=h+m;d^=-1;for(var n=h;n<b;n++)d=d>>>8^I[255&(d^a[n])];return-1^d}},{}],46:[function(f,_,i){var s,d=f("../utils/common"),a=f("./trees"),m=f("./adler32"),h=f("./crc32"),I=f("./messages"),b=0,n=4,l=0,C=-2,g=-1,w=4,u=2,y=8,v=9,V=286,D=30,z=19,A=2*V+1,$=15,T=3,Z=258,re=Z+T+1,E=42,U=113,p=1,O=2,ne=3,G=4;function me(c,M){return c.msg=I[M],M}function L(c){return(c<<1)-(4<c?9:0)}function se(c){for(var M=c.length;0<=--M;)c[M]=0}function q(c){var M=c.state,B=M.pending;B>c.avail_out&&(B=c.avail_out),B!==0&&(d.arraySet(c.output,M.pending_buf,M.pending_out,B,c.next_out),c.next_out+=B,M.pending_out+=B,c.total_out+=B,c.avail_out-=B,M.pending-=B,M.pending===0&&(M.pending_out=0))}function N(c,M){a._tr_flush_block(c,0<=c.block_start?c.block_start:-1,c.strstart-c.block_start,M),c.block_start=c.strstart,q(c.strm)}function ee(c,M){c.pending_buf[c.pending++]=M}function X(c,M){c.pending_buf[c.pending++]=M>>>8&255,c.pending_buf[c.pending++]=255&M}function J(c,M){var B,S,k=c.max_chain_length,F=c.strstart,j=c.prev_length,H=c.nice_match,P=c.strstart>c.w_size-re?c.strstart-(c.w_size-re):0,Q=c.window,te=c.w_mask,K=c.prev,le=c.strstart+Z,we=Q[F+j-1],ve=Q[F+j];c.prev_length>=c.good_match&&(k>>=2),H>c.lookahead&&(H=c.lookahead);do if(Q[(B=M)+j]===ve&&Q[B+j-1]===we&&Q[B]===Q[F]&&Q[++B]===Q[F+1]){F+=2,B++;do;while(Q[++F]===Q[++B]&&Q[++F]===Q[++B]&&Q[++F]===Q[++B]&&Q[++F]===Q[++B]&&Q[++F]===Q[++B]&&Q[++F]===Q[++B]&&Q[++F]===Q[++B]&&Q[++F]===Q[++B]&&F<le);if(S=Z-(le-F),F=le-Z,j<S){if(c.match_start=M,H<=(j=S))break;we=Q[F+j-1],ve=Q[F+j]}}while((M=K[M&te])>P&&--k!=0);return j<=c.lookahead?j:c.lookahead}function Ie(c){var M,B,S,k,F,j,H,P,Q,te,K=c.w_size;do{if(k=c.window_size-c.lookahead-c.strstart,c.strstart>=K+(K-re)){for(d.arraySet(c.window,c.window,K,K,0),c.match_start-=K,c.strstart-=K,c.block_start-=K,M=B=c.hash_size;S=c.head[--M],c.head[M]=K<=S?S-K:0,--B;);for(M=B=K;S=c.prev[--M],c.prev[M]=K<=S?S-K:0,--B;);k+=K}if(c.strm.avail_in===0)break;if(j=c.strm,H=c.window,P=c.strstart+c.lookahead,Q=k,te=void 0,te=j.avail_in,Q<te&&(te=Q),B=te===0?0:(j.avail_in-=te,d.arraySet(H,j.input,j.next_in,te,P),j.state.wrap===1?j.adler=m(j.adler,H,te,P):j.state.wrap===2&&(j.adler=h(j.adler,H,te,P)),j.next_in+=te,j.total_in+=te,te),c.lookahead+=B,c.lookahead+c.insert>=T)for(F=c.strstart-c.insert,c.ins_h=c.window[F],c.ins_h=(c.ins_h<<c.hash_shift^c.window[F+1])&c.hash_mask;c.insert&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[F+T-1])&c.hash_mask,c.prev[F&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=F,F++,c.insert--,!(c.lookahead+c.insert<T)););}while(c.lookahead<re&&c.strm.avail_in!==0)}function ke(c,M){for(var B,S;;){if(c.lookahead<re){if(Ie(c),c.lookahead<re&&M===b)return p;if(c.lookahead===0)break}if(B=0,c.lookahead>=T&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+T-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),B!==0&&c.strstart-B<=c.w_size-re&&(c.match_length=J(c,B)),c.match_length>=T)if(S=a._tr_tally(c,c.strstart-c.match_start,c.match_length-T),c.lookahead-=c.match_length,c.match_length<=c.max_lazy_match&&c.lookahead>=T){for(c.match_length--;c.strstart++,c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+T-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart,--c.match_length!=0;);c.strstart++}else c.strstart+=c.match_length,c.match_length=0,c.ins_h=c.window[c.strstart],c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+1])&c.hash_mask;else S=a._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++;if(S&&(N(c,!1),c.strm.avail_out===0))return p}return c.insert=c.strstart<T-1?c.strstart:T-1,M===n?(N(c,!0),c.strm.avail_out===0?ne:G):c.last_lit&&(N(c,!1),c.strm.avail_out===0)?p:O}function de(c,M){for(var B,S,k;;){if(c.lookahead<re){if(Ie(c),c.lookahead<re&&M===b)return p;if(c.lookahead===0)break}if(B=0,c.lookahead>=T&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+T-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),c.prev_length=c.match_length,c.prev_match=c.match_start,c.match_length=T-1,B!==0&&c.prev_length<c.max_lazy_match&&c.strstart-B<=c.w_size-re&&(c.match_length=J(c,B),c.match_length<=5&&(c.strategy===1||c.match_length===T&&4096<c.strstart-c.match_start)&&(c.match_length=T-1)),c.prev_length>=T&&c.match_length<=c.prev_length){for(k=c.strstart+c.lookahead-T,S=a._tr_tally(c,c.strstart-1-c.prev_match,c.prev_length-T),c.lookahead-=c.prev_length-1,c.prev_length-=2;++c.strstart<=k&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+T-1])&c.hash_mask,B=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),--c.prev_length!=0;);if(c.match_available=0,c.match_length=T-1,c.strstart++,S&&(N(c,!1),c.strm.avail_out===0))return p}else if(c.match_available){if((S=a._tr_tally(c,0,c.window[c.strstart-1]))&&N(c,!1),c.strstart++,c.lookahead--,c.strm.avail_out===0)return p}else c.match_available=1,c.strstart++,c.lookahead--}return c.match_available&&(S=a._tr_tally(c,0,c.window[c.strstart-1]),c.match_available=0),c.insert=c.strstart<T-1?c.strstart:T-1,M===n?(N(c,!0),c.strm.avail_out===0?ne:G):c.last_lit&&(N(c,!1),c.strm.avail_out===0)?p:O}function he(c,M,B,S,k){this.good_length=c,this.max_lazy=M,this.nice_length=B,this.max_chain=S,this.func=k}function Ce(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new d.Buf16(2*A),this.dyn_dtree=new d.Buf16(2*(2*D+1)),this.bl_tree=new d.Buf16(2*(2*z+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new d.Buf16($+1),this.heap=new d.Buf16(2*V+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new d.Buf16(2*V+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ye(c){var M;return c&&c.state?(c.total_in=c.total_out=0,c.data_type=u,(M=c.state).pending=0,M.pending_out=0,M.wrap<0&&(M.wrap=-M.wrap),M.status=M.wrap?E:U,c.adler=M.wrap===2?0:1,M.last_flush=b,a._tr_init(M),l):me(c,C)}function De(c){var M=ye(c);return M===l&&function(B){B.window_size=2*B.w_size,se(B.head),B.max_lazy_match=s[B.level].max_lazy,B.good_match=s[B.level].good_length,B.nice_match=s[B.level].nice_length,B.max_chain_length=s[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=T-1,B.match_available=0,B.ins_h=0}(c.state),M}function Ne(c,M,B,S,k,F){if(!c)return C;var j=1;if(M===g&&(M=6),S<0?(j=0,S=-S):15<S&&(j=2,S-=16),k<1||v<k||B!==y||S<8||15<S||M<0||9<M||F<0||w<F)return me(c,C);S===8&&(S=9);var H=new Ce;return(c.state=H).strm=c,H.wrap=j,H.gzhead=null,H.w_bits=S,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=k+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+T-1)/T),H.window=new d.Buf8(2*H.w_size),H.head=new d.Buf16(H.hash_size),H.prev=new d.Buf16(H.w_size),H.lit_bufsize=1<<k+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new d.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=M,H.strategy=F,H.method=B,De(c)}s=[new he(0,0,0,0,function(c,M){var B=65535;for(B>c.pending_buf_size-5&&(B=c.pending_buf_size-5);;){if(c.lookahead<=1){if(Ie(c),c.lookahead===0&&M===b)return p;if(c.lookahead===0)break}c.strstart+=c.lookahead,c.lookahead=0;var S=c.block_start+B;if((c.strstart===0||c.strstart>=S)&&(c.lookahead=c.strstart-S,c.strstart=S,N(c,!1),c.strm.avail_out===0)||c.strstart-c.block_start>=c.w_size-re&&(N(c,!1),c.strm.avail_out===0))return p}return c.insert=0,M===n?(N(c,!0),c.strm.avail_out===0?ne:G):(c.strstart>c.block_start&&(N(c,!1),c.strm.avail_out),p)}),new he(4,4,8,4,ke),new he(4,5,16,8,ke),new he(4,6,32,32,ke),new he(4,4,16,16,de),new he(8,16,32,32,de),new he(8,16,128,128,de),new he(8,32,128,256,de),new he(32,128,258,1024,de),new he(32,258,258,4096,de)],i.deflateInit=function(c,M){return Ne(c,M,y,15,8,0)},i.deflateInit2=Ne,i.deflateReset=De,i.deflateResetKeep=ye,i.deflateSetHeader=function(c,M){return c&&c.state?c.state.wrap!==2?C:(c.state.gzhead=M,l):C},i.deflate=function(c,M){var B,S,k,F;if(!c||!c.state||5<M||M<0)return c?me(c,C):C;if(S=c.state,!c.output||!c.input&&c.avail_in!==0||S.status===666&&M!==n)return me(c,c.avail_out===0?-5:C);if(S.strm=c,B=S.last_flush,S.last_flush=M,S.status===E)if(S.wrap===2)c.adler=0,ee(S,31),ee(S,139),ee(S,8),S.gzhead?(ee(S,(S.gzhead.text?1:0)+(S.gzhead.hcrc?2:0)+(S.gzhead.extra?4:0)+(S.gzhead.name?8:0)+(S.gzhead.comment?16:0)),ee(S,255&S.gzhead.time),ee(S,S.gzhead.time>>8&255),ee(S,S.gzhead.time>>16&255),ee(S,S.gzhead.time>>24&255),ee(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),ee(S,255&S.gzhead.os),S.gzhead.extra&&S.gzhead.extra.length&&(ee(S,255&S.gzhead.extra.length),ee(S,S.gzhead.extra.length>>8&255)),S.gzhead.hcrc&&(c.adler=h(c.adler,S.pending_buf,S.pending,0)),S.gzindex=0,S.status=69):(ee(S,0),ee(S,0),ee(S,0),ee(S,0),ee(S,0),ee(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),ee(S,3),S.status=U);else{var j=y+(S.w_bits-8<<4)<<8;j|=(2<=S.strategy||S.level<2?0:S.level<6?1:S.level===6?2:3)<<6,S.strstart!==0&&(j|=32),j+=31-j%31,S.status=U,X(S,j),S.strstart!==0&&(X(S,c.adler>>>16),X(S,65535&c.adler)),c.adler=1}if(S.status===69)if(S.gzhead.extra){for(k=S.pending;S.gzindex<(65535&S.gzhead.extra.length)&&(S.pending!==S.pending_buf_size||(S.gzhead.hcrc&&S.pending>k&&(c.adler=h(c.adler,S.pending_buf,S.pending-k,k)),q(c),k=S.pending,S.pending!==S.pending_buf_size));)ee(S,255&S.gzhead.extra[S.gzindex]),S.gzindex++;S.gzhead.hcrc&&S.pending>k&&(c.adler=h(c.adler,S.pending_buf,S.pending-k,k)),S.gzindex===S.gzhead.extra.length&&(S.gzindex=0,S.status=73)}else S.status=73;if(S.status===73)if(S.gzhead.name){k=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>k&&(c.adler=h(c.adler,S.pending_buf,S.pending-k,k)),q(c),k=S.pending,S.pending===S.pending_buf_size)){F=1;break}F=S.gzindex<S.gzhead.name.length?255&S.gzhead.name.charCodeAt(S.gzindex++):0,ee(S,F)}while(F!==0);S.gzhead.hcrc&&S.pending>k&&(c.adler=h(c.adler,S.pending_buf,S.pending-k,k)),F===0&&(S.gzindex=0,S.status=91)}else S.status=91;if(S.status===91)if(S.gzhead.comment){k=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>k&&(c.adler=h(c.adler,S.pending_buf,S.pending-k,k)),q(c),k=S.pending,S.pending===S.pending_buf_size)){F=1;break}F=S.gzindex<S.gzhead.comment.length?255&S.gzhead.comment.charCodeAt(S.gzindex++):0,ee(S,F)}while(F!==0);S.gzhead.hcrc&&S.pending>k&&(c.adler=h(c.adler,S.pending_buf,S.pending-k,k)),F===0&&(S.status=103)}else S.status=103;if(S.status===103&&(S.gzhead.hcrc?(S.pending+2>S.pending_buf_size&&q(c),S.pending+2<=S.pending_buf_size&&(ee(S,255&c.adler),ee(S,c.adler>>8&255),c.adler=0,S.status=U)):S.status=U),S.pending!==0){if(q(c),c.avail_out===0)return S.last_flush=-1,l}else if(c.avail_in===0&&L(M)<=L(B)&&M!==n)return me(c,-5);if(S.status===666&&c.avail_in!==0)return me(c,-5);if(c.avail_in!==0||S.lookahead!==0||M!==b&&S.status!==666){var H=S.strategy===2?function(P,Q){for(var te;;){if(P.lookahead===0&&(Ie(P),P.lookahead===0)){if(Q===b)return p;break}if(P.match_length=0,te=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,te&&(N(P,!1),P.strm.avail_out===0))return p}return P.insert=0,Q===n?(N(P,!0),P.strm.avail_out===0?ne:G):P.last_lit&&(N(P,!1),P.strm.avail_out===0)?p:O}(S,M):S.strategy===3?function(P,Q){for(var te,K,le,we,ve=P.window;;){if(P.lookahead<=Z){if(Ie(P),P.lookahead<=Z&&Q===b)return p;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=T&&0<P.strstart&&(K=ve[le=P.strstart-1])===ve[++le]&&K===ve[++le]&&K===ve[++le]){we=P.strstart+Z;do;while(K===ve[++le]&&K===ve[++le]&&K===ve[++le]&&K===ve[++le]&&K===ve[++le]&&K===ve[++le]&&K===ve[++le]&&K===ve[++le]&&le<we);P.match_length=Z-(we-le),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=T?(te=a._tr_tally(P,1,P.match_length-T),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(te=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),te&&(N(P,!1),P.strm.avail_out===0))return p}return P.insert=0,Q===n?(N(P,!0),P.strm.avail_out===0?ne:G):P.last_lit&&(N(P,!1),P.strm.avail_out===0)?p:O}(S,M):s[S.level].func(S,M);if(H!==ne&&H!==G||(S.status=666),H===p||H===ne)return c.avail_out===0&&(S.last_flush=-1),l;if(H===O&&(M===1?a._tr_align(S):M!==5&&(a._tr_stored_block(S,0,0,!1),M===3&&(se(S.head),S.lookahead===0&&(S.strstart=0,S.block_start=0,S.insert=0))),q(c),c.avail_out===0))return S.last_flush=-1,l}return M!==n?l:S.wrap<=0?1:(S.wrap===2?(ee(S,255&c.adler),ee(S,c.adler>>8&255),ee(S,c.adler>>16&255),ee(S,c.adler>>24&255),ee(S,255&c.total_in),ee(S,c.total_in>>8&255),ee(S,c.total_in>>16&255),ee(S,c.total_in>>24&255)):(X(S,c.adler>>>16),X(S,65535&c.adler)),q(c),0<S.wrap&&(S.wrap=-S.wrap),S.pending!==0?l:1)},i.deflateEnd=function(c){var M;return c&&c.state?(M=c.state.status)!==E&&M!==69&&M!==73&&M!==91&&M!==103&&M!==U&&M!==666?me(c,C):(c.state=null,M===U?me(c,-3):l):C},i.deflateSetDictionary=function(c,M){var B,S,k,F,j,H,P,Q,te=M.length;if(!c||!c.state||(F=(B=c.state).wrap)===2||F===1&&B.status!==E||B.lookahead)return C;for(F===1&&(c.adler=m(c.adler,M,te,0)),B.wrap=0,te>=B.w_size&&(F===0&&(se(B.head),B.strstart=0,B.block_start=0,B.insert=0),Q=new d.Buf8(B.w_size),d.arraySet(Q,M,te-B.w_size,B.w_size,0),M=Q,te=B.w_size),j=c.avail_in,H=c.next_in,P=c.input,c.avail_in=te,c.next_in=0,c.input=M,Ie(B);B.lookahead>=T;){for(S=B.strstart,k=B.lookahead-(T-1);B.ins_h=(B.ins_h<<B.hash_shift^B.window[S+T-1])&B.hash_mask,B.prev[S&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=S,S++,--k;);B.strstart=S,B.lookahead=T-1,Ie(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=T-1,B.match_available=0,c.next_in=H,c.input=P,c.avail_in=j,B.wrap=F,l},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(f,_,i){_.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(f,_,i){_.exports=function(s,d){var a,m,h,I,b,n,l,C,g,w,u,y,v,V,D,z,A,$,T,Z,re,E,U,p,O;a=s.state,m=s.next_in,p=s.input,h=m+(s.avail_in-5),I=s.next_out,O=s.output,b=I-(d-s.avail_out),n=I+(s.avail_out-257),l=a.dmax,C=a.wsize,g=a.whave,w=a.wnext,u=a.window,y=a.hold,v=a.bits,V=a.lencode,D=a.distcode,z=(1<<a.lenbits)-1,A=(1<<a.distbits)-1;e:do{v<15&&(y+=p[m++]<<v,v+=8,y+=p[m++]<<v,v+=8),$=V[y&z];t:for(;;){if(y>>>=T=$>>>24,v-=T,(T=$>>>16&255)===0)O[I++]=65535&$;else{if(!(16&T)){if((64&T)==0){$=V[(65535&$)+(y&(1<<T)-1)];continue t}if(32&T){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}Z=65535&$,(T&=15)&&(v<T&&(y+=p[m++]<<v,v+=8),Z+=y&(1<<T)-1,y>>>=T,v-=T),v<15&&(y+=p[m++]<<v,v+=8,y+=p[m++]<<v,v+=8),$=D[y&A];a:for(;;){if(y>>>=T=$>>>24,v-=T,!(16&(T=$>>>16&255))){if((64&T)==0){$=D[(65535&$)+(y&(1<<T)-1)];continue a}s.msg="invalid distance code",a.mode=30;break e}if(re=65535&$,v<(T&=15)&&(y+=p[m++]<<v,(v+=8)<T&&(y+=p[m++]<<v,v+=8)),l<(re+=y&(1<<T)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(y>>>=T,v-=T,(T=I-b)<re){if(g<(T=re-T)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(U=u,(E=0)===w){if(E+=C-T,T<Z){for(Z-=T;O[I++]=u[E++],--T;);E=I-re,U=O}}else if(w<T){if(E+=C+w-T,(T-=w)<Z){for(Z-=T;O[I++]=u[E++],--T;);if(E=0,w<Z){for(Z-=T=w;O[I++]=u[E++],--T;);E=I-re,U=O}}}else if(E+=w-T,T<Z){for(Z-=T;O[I++]=u[E++],--T;);E=I-re,U=O}for(;2<Z;)O[I++]=U[E++],O[I++]=U[E++],O[I++]=U[E++],Z-=3;Z&&(O[I++]=U[E++],1<Z&&(O[I++]=U[E++]))}else{for(E=I-re;O[I++]=O[E++],O[I++]=O[E++],O[I++]=O[E++],2<(Z-=3););Z&&(O[I++]=O[E++],1<Z&&(O[I++]=O[E++]))}break}}break}}while(m<h&&I<n);m-=Z=v>>3,y&=(1<<(v-=Z<<3))-1,s.next_in=m,s.next_out=I,s.avail_in=m<h?h-m+5:5-(m-h),s.avail_out=I<n?n-I+257:257-(I-n),a.hold=y,a.bits=v}},{}],49:[function(f,_,i){var s=f("../utils/common"),d=f("./adler32"),a=f("./crc32"),m=f("./inffast"),h=f("./inftrees"),I=1,b=2,n=0,l=-2,C=1,g=852,w=592;function u(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(E){var U;return E&&E.state?(U=E.state,E.total_in=E.total_out=U.total=0,E.msg="",U.wrap&&(E.adler=1&U.wrap),U.mode=C,U.last=0,U.havedict=0,U.dmax=32768,U.head=null,U.hold=0,U.bits=0,U.lencode=U.lendyn=new s.Buf32(g),U.distcode=U.distdyn=new s.Buf32(w),U.sane=1,U.back=-1,n):l}function V(E){var U;return E&&E.state?((U=E.state).wsize=0,U.whave=0,U.wnext=0,v(E)):l}function D(E,U){var p,O;return E&&E.state?(O=E.state,U<0?(p=0,U=-U):(p=1+(U>>4),U<48&&(U&=15)),U&&(U<8||15<U)?l:(O.window!==null&&O.wbits!==U&&(O.window=null),O.wrap=p,O.wbits=U,V(E))):l}function z(E,U){var p,O;return E?(O=new y,(E.state=O).window=null,(p=D(E,U))!==n&&(E.state=null),p):l}var A,$,T=!0;function Z(E){if(T){var U;for(A=new s.Buf32(512),$=new s.Buf32(32),U=0;U<144;)E.lens[U++]=8;for(;U<256;)E.lens[U++]=9;for(;U<280;)E.lens[U++]=7;for(;U<288;)E.lens[U++]=8;for(h(I,E.lens,0,288,A,0,E.work,{bits:9}),U=0;U<32;)E.lens[U++]=5;h(b,E.lens,0,32,$,0,E.work,{bits:5}),T=!1}E.lencode=A,E.lenbits=9,E.distcode=$,E.distbits=5}function re(E,U,p,O){var ne,G=E.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new s.Buf8(G.wsize)),O>=G.wsize?(s.arraySet(G.window,U,p-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(O<(ne=G.wsize-G.wnext)&&(ne=O),s.arraySet(G.window,U,p-O,ne,G.wnext),(O-=ne)?(s.arraySet(G.window,U,p-O,O,0),G.wnext=O,G.whave=G.wsize):(G.wnext+=ne,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=ne))),0}i.inflateReset=V,i.inflateReset2=D,i.inflateResetKeep=v,i.inflateInit=function(E){return z(E,15)},i.inflateInit2=z,i.inflate=function(E,U){var p,O,ne,G,me,L,se,q,N,ee,X,J,Ie,ke,de,he,Ce,ye,De,Ne,c,M,B,S,k=0,F=new s.Buf8(4),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return l;(p=E.state).mode===12&&(p.mode=13),me=E.next_out,ne=E.output,se=E.avail_out,G=E.next_in,O=E.input,L=E.avail_in,q=p.hold,N=p.bits,ee=L,X=se,M=n;e:for(;;)switch(p.mode){case C:if(p.wrap===0){p.mode=13;break}for(;N<16;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(2&p.wrap&&q===35615){F[p.check=0]=255&q,F[1]=q>>>8&255,p.check=a(p.check,F,2,0),N=q=0,p.mode=2;break}if(p.flags=0,p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&q)<<8)+(q>>8))%31){E.msg="incorrect header check",p.mode=30;break}if((15&q)!=8){E.msg="unknown compression method",p.mode=30;break}if(N-=4,c=8+(15&(q>>>=4)),p.wbits===0)p.wbits=c;else if(c>p.wbits){E.msg="invalid window size",p.mode=30;break}p.dmax=1<<c,E.adler=p.check=1,p.mode=512&q?10:12,N=q=0;break;case 2:for(;N<16;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(p.flags=q,(255&p.flags)!=8){E.msg="unknown compression method",p.mode=30;break}if(57344&p.flags){E.msg="unknown header flags set",p.mode=30;break}p.head&&(p.head.text=q>>8&1),512&p.flags&&(F[0]=255&q,F[1]=q>>>8&255,p.check=a(p.check,F,2,0)),N=q=0,p.mode=3;case 3:for(;N<32;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}p.head&&(p.head.time=q),512&p.flags&&(F[0]=255&q,F[1]=q>>>8&255,F[2]=q>>>16&255,F[3]=q>>>24&255,p.check=a(p.check,F,4,0)),N=q=0,p.mode=4;case 4:for(;N<16;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}p.head&&(p.head.xflags=255&q,p.head.os=q>>8),512&p.flags&&(F[0]=255&q,F[1]=q>>>8&255,p.check=a(p.check,F,2,0)),N=q=0,p.mode=5;case 5:if(1024&p.flags){for(;N<16;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}p.length=q,p.head&&(p.head.extra_len=q),512&p.flags&&(F[0]=255&q,F[1]=q>>>8&255,p.check=a(p.check,F,2,0)),N=q=0}else p.head&&(p.head.extra=null);p.mode=6;case 6:if(1024&p.flags&&(L<(J=p.length)&&(J=L),J&&(p.head&&(c=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Array(p.head.extra_len)),s.arraySet(p.head.extra,O,G,J,c)),512&p.flags&&(p.check=a(p.check,O,J,G)),L-=J,G+=J,p.length-=J),p.length))break e;p.length=0,p.mode=7;case 7:if(2048&p.flags){if(L===0)break e;for(J=0;c=O[G+J++],p.head&&c&&p.length<65536&&(p.head.name+=String.fromCharCode(c)),c&&J<L;);if(512&p.flags&&(p.check=a(p.check,O,J,G)),L-=J,G+=J,c)break e}else p.head&&(p.head.name=null);p.length=0,p.mode=8;case 8:if(4096&p.flags){if(L===0)break e;for(J=0;c=O[G+J++],p.head&&c&&p.length<65536&&(p.head.comment+=String.fromCharCode(c)),c&&J<L;);if(512&p.flags&&(p.check=a(p.check,O,J,G)),L-=J,G+=J,c)break e}else p.head&&(p.head.comment=null);p.mode=9;case 9:if(512&p.flags){for(;N<16;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(q!==(65535&p.check)){E.msg="header crc mismatch",p.mode=30;break}N=q=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),E.adler=p.check=0,p.mode=12;break;case 10:for(;N<32;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}E.adler=p.check=u(q),N=q=0,p.mode=11;case 11:if(p.havedict===0)return E.next_out=me,E.avail_out=se,E.next_in=G,E.avail_in=L,p.hold=q,p.bits=N,2;E.adler=p.check=1,p.mode=12;case 12:if(U===5||U===6)break e;case 13:if(p.last){q>>>=7&N,N-=7&N,p.mode=27;break}for(;N<3;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}switch(p.last=1&q,N-=1,3&(q>>>=1)){case 0:p.mode=14;break;case 1:if(Z(p),p.mode=20,U!==6)break;q>>>=2,N-=2;break e;case 2:p.mode=17;break;case 3:E.msg="invalid block type",p.mode=30}q>>>=2,N-=2;break;case 14:for(q>>>=7&N,N-=7&N;N<32;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if((65535&q)!=(q>>>16^65535)){E.msg="invalid stored block lengths",p.mode=30;break}if(p.length=65535&q,N=q=0,p.mode=15,U===6)break e;case 15:p.mode=16;case 16:if(J=p.length){if(L<J&&(J=L),se<J&&(J=se),J===0)break e;s.arraySet(ne,O,G,J,me),L-=J,G+=J,se-=J,me+=J,p.length-=J;break}p.mode=12;break;case 17:for(;N<14;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(p.nlen=257+(31&q),q>>>=5,N-=5,p.ndist=1+(31&q),q>>>=5,N-=5,p.ncode=4+(15&q),q>>>=4,N-=4,286<p.nlen||30<p.ndist){E.msg="too many length or distance symbols",p.mode=30;break}p.have=0,p.mode=18;case 18:for(;p.have<p.ncode;){for(;N<3;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}p.lens[j[p.have++]]=7&q,q>>>=3,N-=3}for(;p.have<19;)p.lens[j[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,B={bits:p.lenbits},M=h(0,p.lens,0,19,p.lencode,0,p.work,B),p.lenbits=B.bits,M){E.msg="invalid code lengths set",p.mode=30;break}p.have=0,p.mode=19;case 19:for(;p.have<p.nlen+p.ndist;){for(;he=(k=p.lencode[q&(1<<p.lenbits)-1])>>>16&255,Ce=65535&k,!((de=k>>>24)<=N);){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(Ce<16)q>>>=de,N-=de,p.lens[p.have++]=Ce;else{if(Ce===16){for(S=de+2;N<S;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(q>>>=de,N-=de,p.have===0){E.msg="invalid bit length repeat",p.mode=30;break}c=p.lens[p.have-1],J=3+(3&q),q>>>=2,N-=2}else if(Ce===17){for(S=de+3;N<S;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}N-=de,c=0,J=3+(7&(q>>>=de)),q>>>=3,N-=3}else{for(S=de+7;N<S;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}N-=de,c=0,J=11+(127&(q>>>=de)),q>>>=7,N-=7}if(p.have+J>p.nlen+p.ndist){E.msg="invalid bit length repeat",p.mode=30;break}for(;J--;)p.lens[p.have++]=c}}if(p.mode===30)break;if(p.lens[256]===0){E.msg="invalid code -- missing end-of-block",p.mode=30;break}if(p.lenbits=9,B={bits:p.lenbits},M=h(I,p.lens,0,p.nlen,p.lencode,0,p.work,B),p.lenbits=B.bits,M){E.msg="invalid literal/lengths set",p.mode=30;break}if(p.distbits=6,p.distcode=p.distdyn,B={bits:p.distbits},M=h(b,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,B),p.distbits=B.bits,M){E.msg="invalid distances set",p.mode=30;break}if(p.mode=20,U===6)break e;case 20:p.mode=21;case 21:if(6<=L&&258<=se){E.next_out=me,E.avail_out=se,E.next_in=G,E.avail_in=L,p.hold=q,p.bits=N,m(E,X),me=E.next_out,ne=E.output,se=E.avail_out,G=E.next_in,O=E.input,L=E.avail_in,q=p.hold,N=p.bits,p.mode===12&&(p.back=-1);break}for(p.back=0;he=(k=p.lencode[q&(1<<p.lenbits)-1])>>>16&255,Ce=65535&k,!((de=k>>>24)<=N);){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(he&&(240&he)==0){for(ye=de,De=he,Ne=Ce;he=(k=p.lencode[Ne+((q&(1<<ye+De)-1)>>ye)])>>>16&255,Ce=65535&k,!(ye+(de=k>>>24)<=N);){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}q>>>=ye,N-=ye,p.back+=ye}if(q>>>=de,N-=de,p.back+=de,p.length=Ce,he===0){p.mode=26;break}if(32&he){p.back=-1,p.mode=12;break}if(64&he){E.msg="invalid literal/length code",p.mode=30;break}p.extra=15&he,p.mode=22;case 22:if(p.extra){for(S=p.extra;N<S;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}p.length+=q&(1<<p.extra)-1,q>>>=p.extra,N-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=23;case 23:for(;he=(k=p.distcode[q&(1<<p.distbits)-1])>>>16&255,Ce=65535&k,!((de=k>>>24)<=N);){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if((240&he)==0){for(ye=de,De=he,Ne=Ce;he=(k=p.distcode[Ne+((q&(1<<ye+De)-1)>>ye)])>>>16&255,Ce=65535&k,!(ye+(de=k>>>24)<=N);){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}q>>>=ye,N-=ye,p.back+=ye}if(q>>>=de,N-=de,p.back+=de,64&he){E.msg="invalid distance code",p.mode=30;break}p.offset=Ce,p.extra=15&he,p.mode=24;case 24:if(p.extra){for(S=p.extra;N<S;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}p.offset+=q&(1<<p.extra)-1,q>>>=p.extra,N-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){E.msg="invalid distance too far back",p.mode=30;break}p.mode=25;case 25:if(se===0)break e;if(J=X-se,p.offset>J){if((J=p.offset-J)>p.whave&&p.sane){E.msg="invalid distance too far back",p.mode=30;break}Ie=J>p.wnext?(J-=p.wnext,p.wsize-J):p.wnext-J,J>p.length&&(J=p.length),ke=p.window}else ke=ne,Ie=me-p.offset,J=p.length;for(se<J&&(J=se),se-=J,p.length-=J;ne[me++]=ke[Ie++],--J;);p.length===0&&(p.mode=21);break;case 26:if(se===0)break e;ne[me++]=p.length,se--,p.mode=21;break;case 27:if(p.wrap){for(;N<32;){if(L===0)break e;L--,q|=O[G++]<<N,N+=8}if(X-=se,E.total_out+=X,p.total+=X,X&&(E.adler=p.check=p.flags?a(p.check,ne,X,me-X):d(p.check,ne,X,me-X)),X=se,(p.flags?q:u(q))!==p.check){E.msg="incorrect data check",p.mode=30;break}N=q=0}p.mode=28;case 28:if(p.wrap&&p.flags){for(;N<32;){if(L===0)break e;L--,q+=O[G++]<<N,N+=8}if(q!==(4294967295&p.total)){E.msg="incorrect length check",p.mode=30;break}N=q=0}p.mode=29;case 29:M=1;break e;case 30:M=-3;break e;case 31:return-4;case 32:default:return l}return E.next_out=me,E.avail_out=se,E.next_in=G,E.avail_in=L,p.hold=q,p.bits=N,(p.wsize||X!==E.avail_out&&p.mode<30&&(p.mode<27||U!==4))&&re(E,E.output,E.next_out,X-E.avail_out)?(p.mode=31,-4):(ee-=E.avail_in,X-=E.avail_out,E.total_in+=ee,E.total_out+=X,p.total+=X,p.wrap&&X&&(E.adler=p.check=p.flags?a(p.check,ne,X,E.next_out-X):d(p.check,ne,X,E.next_out-X)),E.data_type=p.bits+(p.last?64:0)+(p.mode===12?128:0)+(p.mode===20||p.mode===15?256:0),(ee==0&&X===0||U===4)&&M===n&&(M=-5),M)},i.inflateEnd=function(E){if(!E||!E.state)return l;var U=E.state;return U.window&&(U.window=null),E.state=null,n},i.inflateGetHeader=function(E,U){var p;return E&&E.state?(2&(p=E.state).wrap)==0?l:((p.head=U).done=!1,n):l},i.inflateSetDictionary=function(E,U){var p,O=U.length;return E&&E.state?(p=E.state).wrap!==0&&p.mode!==11?l:p.mode===11&&d(1,U,O,0)!==p.check?-3:re(E,U,O,O)?(p.mode=31,-4):(p.havedict=1,n):l},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(f,_,i){var s=f("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];_.exports=function(I,b,n,l,C,g,w,u){var y,v,V,D,z,A,$,T,Z,re=u.bits,E=0,U=0,p=0,O=0,ne=0,G=0,me=0,L=0,se=0,q=0,N=null,ee=0,X=new s.Buf16(16),J=new s.Buf16(16),Ie=null,ke=0;for(E=0;E<=15;E++)X[E]=0;for(U=0;U<l;U++)X[b[n+U]]++;for(ne=re,O=15;1<=O&&X[O]===0;O--);if(O<ne&&(ne=O),O===0)return C[g++]=20971520,C[g++]=20971520,u.bits=1,0;for(p=1;p<O&&X[p]===0;p++);for(ne<p&&(ne=p),E=L=1;E<=15;E++)if(L<<=1,(L-=X[E])<0)return-1;if(0<L&&(I===0||O!==1))return-1;for(J[1]=0,E=1;E<15;E++)J[E+1]=J[E]+X[E];for(U=0;U<l;U++)b[n+U]!==0&&(w[J[b[n+U]]++]=U);if(A=I===0?(N=Ie=w,19):I===1?(N=d,ee-=257,Ie=a,ke-=257,256):(N=m,Ie=h,-1),E=p,z=g,me=U=q=0,V=-1,D=(se=1<<(G=ne))-1,I===1&&852<se||I===2&&592<se)return 1;for(;;){for($=E-me,Z=w[U]<A?(T=0,w[U]):w[U]>A?(T=Ie[ke+w[U]],N[ee+w[U]]):(T=96,0),y=1<<E-me,p=v=1<<G;C[z+(q>>me)+(v-=y)]=$<<24|T<<16|Z|0,v!==0;);for(y=1<<E-1;q&y;)y>>=1;if(y!==0?(q&=y-1,q+=y):q=0,U++,--X[E]==0){if(E===O)break;E=b[n+w[U]]}if(ne<E&&(q&D)!==V){for(me===0&&(me=ne),z+=p,L=1<<(G=E-me);G+me<O&&!((L-=X[G+me])<=0);)G++,L<<=1;if(se+=1<<G,I===1&&852<se||I===2&&592<se)return 1;C[V=q&D]=ne<<24|G<<16|z-g|0}}return q!==0&&(C[z+q]=E-me<<24|64<<16|0),u.bits=ne,0}},{"../utils/common":41}],51:[function(f,_,i){_.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(f,_,i){var s=f("../utils/common"),d=0,a=1;function m(k){for(var F=k.length;0<=--F;)k[F]=0}var h=0,I=29,b=256,n=b+1+I,l=30,C=19,g=2*n+1,w=15,u=16,y=7,v=256,V=16,D=17,z=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=new Array(2*(n+2));m(re);var E=new Array(2*l);m(E);var U=new Array(512);m(U);var p=new Array(256);m(p);var O=new Array(I);m(O);var ne,G,me,L=new Array(l);function se(k,F,j,H,P){this.static_tree=k,this.extra_bits=F,this.extra_base=j,this.elems=H,this.max_length=P,this.has_stree=k&&k.length}function q(k,F){this.dyn_tree=k,this.max_code=0,this.stat_desc=F}function N(k){return k<256?U[k]:U[256+(k>>>7)]}function ee(k,F){k.pending_buf[k.pending++]=255&F,k.pending_buf[k.pending++]=F>>>8&255}function X(k,F,j){k.bi_valid>u-j?(k.bi_buf|=F<<k.bi_valid&65535,ee(k,k.bi_buf),k.bi_buf=F>>u-k.bi_valid,k.bi_valid+=j-u):(k.bi_buf|=F<<k.bi_valid&65535,k.bi_valid+=j)}function J(k,F,j){X(k,j[2*F],j[2*F+1])}function Ie(k,F){for(var j=0;j|=1&k,k>>>=1,j<<=1,0<--F;);return j>>>1}function ke(k,F,j){var H,P,Q=new Array(w+1),te=0;for(H=1;H<=w;H++)Q[H]=te=te+j[H-1]<<1;for(P=0;P<=F;P++){var K=k[2*P+1];K!==0&&(k[2*P]=Ie(Q[K]++,K))}}function de(k){var F;for(F=0;F<n;F++)k.dyn_ltree[2*F]=0;for(F=0;F<l;F++)k.dyn_dtree[2*F]=0;for(F=0;F<C;F++)k.bl_tree[2*F]=0;k.dyn_ltree[2*v]=1,k.opt_len=k.static_len=0,k.last_lit=k.matches=0}function he(k){8<k.bi_valid?ee(k,k.bi_buf):0<k.bi_valid&&(k.pending_buf[k.pending++]=k.bi_buf),k.bi_buf=0,k.bi_valid=0}function Ce(k,F,j,H){var P=2*F,Q=2*j;return k[P]<k[Q]||k[P]===k[Q]&&H[F]<=H[j]}function ye(k,F,j){for(var H=k.heap[j],P=j<<1;P<=k.heap_len&&(P<k.heap_len&&Ce(F,k.heap[P+1],k.heap[P],k.depth)&&P++,!Ce(F,H,k.heap[P],k.depth));)k.heap[j]=k.heap[P],j=P,P<<=1;k.heap[j]=H}function De(k,F,j){var H,P,Q,te,K=0;if(k.last_lit!==0)for(;H=k.pending_buf[k.d_buf+2*K]<<8|k.pending_buf[k.d_buf+2*K+1],P=k.pending_buf[k.l_buf+K],K++,H===0?J(k,P,F):(J(k,(Q=p[P])+b+1,F),(te=A[Q])!==0&&X(k,P-=O[Q],te),J(k,Q=N(--H),j),(te=$[Q])!==0&&X(k,H-=L[Q],te)),K<k.last_lit;);J(k,v,F)}function Ne(k,F){var j,H,P,Q=F.dyn_tree,te=F.stat_desc.static_tree,K=F.stat_desc.has_stree,le=F.stat_desc.elems,we=-1;for(k.heap_len=0,k.heap_max=g,j=0;j<le;j++)Q[2*j]!==0?(k.heap[++k.heap_len]=we=j,k.depth[j]=0):Q[2*j+1]=0;for(;k.heap_len<2;)Q[2*(P=k.heap[++k.heap_len]=we<2?++we:0)]=1,k.depth[P]=0,k.opt_len--,K&&(k.static_len-=te[2*P+1]);for(F.max_code=we,j=k.heap_len>>1;1<=j;j--)ye(k,Q,j);for(P=le;j=k.heap[1],k.heap[1]=k.heap[k.heap_len--],ye(k,Q,1),H=k.heap[1],k.heap[--k.heap_max]=j,k.heap[--k.heap_max]=H,Q[2*P]=Q[2*j]+Q[2*H],k.depth[P]=(k.depth[j]>=k.depth[H]?k.depth[j]:k.depth[H])+1,Q[2*j+1]=Q[2*H+1]=P,k.heap[1]=P++,ye(k,Q,1),2<=k.heap_len;);k.heap[--k.heap_max]=k.heap[1],function(ve,Pe){var Ye,Ae,Je,Se,at,nt,Be=Pe.dyn_tree,ft=Pe.max_code,Ct=Pe.stat_desc.static_tree,St=Pe.stat_desc.has_stree,Et=Pe.stat_desc.extra_bits,pt=Pe.stat_desc.extra_base,et=Pe.stat_desc.max_length,ot=0;for(Se=0;Se<=w;Se++)ve.bl_count[Se]=0;for(Be[2*ve.heap[ve.heap_max]+1]=0,Ye=ve.heap_max+1;Ye<g;Ye++)et<(Se=Be[2*Be[2*(Ae=ve.heap[Ye])+1]+1]+1)&&(Se=et,ot++),Be[2*Ae+1]=Se,ft<Ae||(ve.bl_count[Se]++,at=0,pt<=Ae&&(at=Et[Ae-pt]),nt=Be[2*Ae],ve.opt_len+=nt*(Se+at),St&&(ve.static_len+=nt*(Ct[2*Ae+1]+at)));if(ot!==0){do{for(Se=et-1;ve.bl_count[Se]===0;)Se--;ve.bl_count[Se]--,ve.bl_count[Se+1]+=2,ve.bl_count[et]--,ot-=2}while(0<ot);for(Se=et;Se!==0;Se--)for(Ae=ve.bl_count[Se];Ae!==0;)ft<(Je=ve.heap[--Ye])||(Be[2*Je+1]!==Se&&(ve.opt_len+=(Se-Be[2*Je+1])*Be[2*Je],Be[2*Je+1]=Se),Ae--)}}(k,F),ke(Q,we,k.bl_count)}function c(k,F,j){var H,P,Q=-1,te=F[1],K=0,le=7,we=4;for(te===0&&(le=138,we=3),F[2*(j+1)+1]=65535,H=0;H<=j;H++)P=te,te=F[2*(H+1)+1],++K<le&&P===te||(K<we?k.bl_tree[2*P]+=K:P!==0?(P!==Q&&k.bl_tree[2*P]++,k.bl_tree[2*V]++):K<=10?k.bl_tree[2*D]++:k.bl_tree[2*z]++,Q=P,we=(K=0)===te?(le=138,3):P===te?(le=6,3):(le=7,4))}function M(k,F,j){var H,P,Q=-1,te=F[1],K=0,le=7,we=4;for(te===0&&(le=138,we=3),H=0;H<=j;H++)if(P=te,te=F[2*(H+1)+1],!(++K<le&&P===te)){if(K<we)for(;J(k,P,k.bl_tree),--K!=0;);else P!==0?(P!==Q&&(J(k,P,k.bl_tree),K--),J(k,V,k.bl_tree),X(k,K-3,2)):K<=10?(J(k,D,k.bl_tree),X(k,K-3,3)):(J(k,z,k.bl_tree),X(k,K-11,7));Q=P,we=(K=0)===te?(le=138,3):P===te?(le=6,3):(le=7,4)}}m(L);var B=!1;function S(k,F,j,H){X(k,(h<<1)+(H?1:0),3),function(P,Q,te,K){he(P),K&&(ee(P,te),ee(P,~te)),s.arraySet(P.pending_buf,P.window,Q,te,P.pending),P.pending+=te}(k,F,j,!0)}i._tr_init=function(k){B||(function(){var F,j,H,P,Q,te=new Array(w+1);for(P=H=0;P<I-1;P++)for(O[P]=H,F=0;F<1<<A[P];F++)p[H++]=P;for(p[H-1]=P,P=Q=0;P<16;P++)for(L[P]=Q,F=0;F<1<<$[P];F++)U[Q++]=P;for(Q>>=7;P<l;P++)for(L[P]=Q<<7,F=0;F<1<<$[P]-7;F++)U[256+Q++]=P;for(j=0;j<=w;j++)te[j]=0;for(F=0;F<=143;)re[2*F+1]=8,F++,te[8]++;for(;F<=255;)re[2*F+1]=9,F++,te[9]++;for(;F<=279;)re[2*F+1]=7,F++,te[7]++;for(;F<=287;)re[2*F+1]=8,F++,te[8]++;for(ke(re,n+1,te),F=0;F<l;F++)E[2*F+1]=5,E[2*F]=Ie(F,5);ne=new se(re,A,b+1,n,w),G=new se(E,$,0,l,w),me=new se(new Array(0),T,0,C,y)}(),B=!0),k.l_desc=new q(k.dyn_ltree,ne),k.d_desc=new q(k.dyn_dtree,G),k.bl_desc=new q(k.bl_tree,me),k.bi_buf=0,k.bi_valid=0,de(k)},i._tr_stored_block=S,i._tr_flush_block=function(k,F,j,H){var P,Q,te=0;0<k.level?(k.strm.data_type===2&&(k.strm.data_type=function(K){var le,we=4093624447;for(le=0;le<=31;le++,we>>>=1)if(1&we&&K.dyn_ltree[2*le]!==0)return d;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return a;for(le=32;le<b;le++)if(K.dyn_ltree[2*le]!==0)return a;return d}(k)),Ne(k,k.l_desc),Ne(k,k.d_desc),te=function(K){var le;for(c(K,K.dyn_ltree,K.l_desc.max_code),c(K,K.dyn_dtree,K.d_desc.max_code),Ne(K,K.bl_desc),le=C-1;3<=le&&K.bl_tree[2*Z[le]+1]===0;le--);return K.opt_len+=3*(le+1)+5+5+4,le}(k),P=k.opt_len+3+7>>>3,(Q=k.static_len+3+7>>>3)<=P&&(P=Q)):P=Q=j+5,j+4<=P&&F!==-1?S(k,F,j,H):k.strategy===4||Q===P?(X(k,2+(H?1:0),3),De(k,re,E)):(X(k,4+(H?1:0),3),function(K,le,we,ve){var Pe;for(X(K,le-257,5),X(K,we-1,5),X(K,ve-4,4),Pe=0;Pe<ve;Pe++)X(K,K.bl_tree[2*Z[Pe]+1],3);M(K,K.dyn_ltree,le-1),M(K,K.dyn_dtree,we-1)}(k,k.l_desc.max_code+1,k.d_desc.max_code+1,te+1),De(k,k.dyn_ltree,k.dyn_dtree)),de(k),H&&he(k)},i._tr_tally=function(k,F,j){return k.pending_buf[k.d_buf+2*k.last_lit]=F>>>8&255,k.pending_buf[k.d_buf+2*k.last_lit+1]=255&F,k.pending_buf[k.l_buf+k.last_lit]=255&j,k.last_lit++,F===0?k.dyn_ltree[2*j]++:(k.matches++,F--,k.dyn_ltree[2*(p[j]+b+1)]++,k.dyn_dtree[2*N(F)]++),k.last_lit===k.lit_bufsize-1},i._tr_align=function(k){X(k,2,3),J(k,v,re),function(F){F.bi_valid===16?(ee(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):8<=F.bi_valid&&(F.pending_buf[F.pending++]=255&F.bi_buf,F.bi_buf>>=8,F.bi_valid-=8)}(k)}},{"../utils/common":41}],53:[function(f,_,i){_.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(f,_,i){(function(s){(function(d,a){if(!d.setImmediate){var m,h,I,b,n=1,l={},C=!1,g=d.document,w=Object.getPrototypeOf&&Object.getPrototypeOf(d);w=w&&w.setTimeout?w:d,m={}.toString.call(d.process)==="[object process]"?function(V){process.nextTick(function(){y(V)})}:function(){if(d.postMessage&&!d.importScripts){var V=!0,D=d.onmessage;return d.onmessage=function(){V=!1},d.postMessage("","*"),d.onmessage=D,V}}()?(b="setImmediate$"+Math.random()+"$",d.addEventListener?d.addEventListener("message",v,!1):d.attachEvent("onmessage",v),function(V){d.postMessage(b+V,"*")}):d.MessageChannel?((I=new MessageChannel).port1.onmessage=function(V){y(V.data)},function(V){I.port2.postMessage(V)}):g&&"onreadystatechange"in g.createElement("script")?(h=g.documentElement,function(V){var D=g.createElement("script");D.onreadystatechange=function(){y(V),D.onreadystatechange=null,h.removeChild(D),D=null},h.appendChild(D)}):function(V){setTimeout(y,0,V)},w.setImmediate=function(V){typeof V!="function"&&(V=new Function(""+V));for(var D=new Array(arguments.length-1),z=0;z<D.length;z++)D[z]=arguments[z+1];var A={callback:V,args:D};return l[n]=A,m(n),n++},w.clearImmediate=u}function u(V){delete l[V]}function y(V){if(C)setTimeout(y,0,V);else{var D=l[V];if(D){C=!0;try{(function(z){var A=z.callback,$=z.args;switch($.length){case 0:A();break;case 1:A($[0]);break;case 2:A($[0],$[1]);break;case 3:A($[0],$[1],$[2]);break;default:A.apply(a,$)}})(D)}finally{u(V),C=!1}}}}function v(V){V.source===d&&typeof V.data=="string"&&V.data.indexOf(b)===0&&y(+V.data.slice(b.length))}})(typeof self=="undefined"?s===void 0?this:s:self)}).call(this,typeof rt!="undefined"?rt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(kt);var fa=kt.exports;const We={paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{numero:"",numeroCompra:null,destinatario:null,periodoEmissao:{ini:"",fim:""},periodoFinalizado:{ini:"",fim:""},fornecedor:{nome:""},ordenacao:"dataHoraFinalizado",direcao:"desc",ordenacaoSefaz:"dhRecbto",direcaoSefaz:"desc"}},pa={components:{Lista:Bt,ComprasFicha:ia,ComprasImportacaoXML:ma},data(){return{usuario:"",clienteSistema:"",lista:[],contatos:{},destinatarioOpcoes:[],destinatarioSelecionado:null,mostrar:{header:!0,barraTopo:!0,toolbarTitulo:!0,icone:"factory",titulo:"Compras",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:"",conexao:{icone:"hibrido",iconeTamanho:"xs",cor:"grey-5",rotulo:null,dica:"H\xEDbrido",denso:!0,flat:!0,escuro:!1}},resultado:{},busca:"",filtros:$utils.clonar(We.filtros),ordenacaoOpcoes:[{value:"dataHoraEmissao",label:"Data Emiss\xE3o"},{value:"dataHoraFinalizado",label:"Data Finalizado"}],ordenacaoSefaz:[{value:"dhRecbto",label:"Data Recebimento"}],direcaoOpcoes:[{value:"desc",label:"Decrescente"},{value:"asc",label:"Crescente"}],tabSelecionada:{valor:"Pedido de Compra"},tabs:[],tabSelecionada2:{valor:"Digita\xE7\xE3o"},tabs2:[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}],paginacao:$utils.clonar(We.paginacao),xmlDevolucao:!1,xmlEstrangeiro:!1,modalXMLNotaEntrada:!1,xmlNotaEntrada:{},abrirNotadeEntrada:null,modalPrevisaoEntrega:{},configImpressao:[],configImpressaoPedidoCompra:[{valor:"ped_compra",texto:"Pedido de Compra",observacao:"Modelo 1"},{valor:"pedidoCompra",texto:"Pedido de Compra",observacao:"Modelo 2"}],dialogEtiquetas:{impressao:!1,adicionar:!1,limpar:!1,item:{}},opcoesModelo:[],modeloSelecionado:"",emBranco:0,opcoesEmpresas:[],empresaSelecionada:"",tabelasPreco:[],opcoesTabelasPreco:[],tabelaPrecoSelecionada:""}},methods:{aoSelecionarDestinatario(){this.filtros.destinatario=$utils.clonar(this.destinatarioSelecionado)},async atualizar(r){var f;const e=$utils.logarIni("ComprasLista");await $tryLoading(async()=>{var I,b,n,l,C,g,w,u,y,v,V,D,z,A,$,T,Z,re,E,U,p,O,ne,G,me;let{buscarTabsRecentes:_,buscarDadosRecentes:i}=r!=null?r:{},s,d,a,m,h;if(_?(s=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:"ComprasLista_"+((I=this.usuario)==null?void 0:I.id)}),this.tabSelecionada.valor=(s==null?void 0:s.tabSelecionada)||"Pedido de Compra",this.setOpcoesTabs(this.tabSelecionada.valor)):this.setOpcoesTabs(this.tabSelecionada.valor),this.tabSelecionadaAnterior&&this.tabSelecionadaAnterior!==this.tabSelecionada.valor&&(this.filtros=$utils.clonarV2(We.filtros),this.paginacao=$utils.clonarV2(We.paginacao),this.busca="",i=!0),this.tabSelecionadaAnterior=this.tabSelecionada.valor,i&&(d=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:"ComprasLista_"+this.tabSelecionada.valor+((b=this.usuario)==null?void 0:b.id)}),d!=null&&d._id?(this.tabSelecionada2.valor=d==null?void 0:d.tabSelecionada2,this.destinatarioSelecionado=(n=d==null?void 0:d.filtros)==null?void 0:n.destinatario,this.busca=(d==null?void 0:d.busca)||"",this.paginacao.limite=(d==null?void 0:d.limite)||25,this.filtros={numero:((l=d==null?void 0:d.filtros)==null?void 0:l.numero)||"",numeroCompra:((C=d==null?void 0:d.filtros)==null?void 0:C.numeroCompra)||null,destinatario:((g=d==null?void 0:d.filtros)==null?void 0:g.destinatario)||null,periodoEmissao:{ini:((u=(w=d==null?void 0:d.filtros)==null?void 0:w.periodoEmissao)==null?void 0:u.ini)||"",fim:((v=(y=d==null?void 0:d.filtros)==null?void 0:y.periodoEmissao)==null?void 0:v.fim)||""},periodoFinalizado:{ini:((D=(V=d==null?void 0:d.filtros)==null?void 0:V.periodoFinalizado)==null?void 0:D.ini)||"",fim:((A=(z=d==null?void 0:d.filtros)==null?void 0:z.periodoFinalizado)==null?void 0:A.fim)||""},fornecedor:{nome:((T=($=d==null?void 0:d.filtros)==null?void 0:$.fornecedor)==null?void 0:T.nome)||""},ordenacao:((Z=d==null?void 0:d.filtros)==null?void 0:Z.ordenacao)||"dataHoraFinalizado",direcao:((re=d==null?void 0:d.filtros)==null?void 0:re.direcao)||"desc",ordenacaoSefaz:((E=d==null?void 0:d.filtros)==null?void 0:E.ordenacaoSefaz)||"dhRecbto",direcaoSefaz:((U=d==null?void 0:d.filtros)==null?void 0:U.direcaoSefaz)||"desc"},this.compareObject(We.filtros,this.filtros,["ordenacao","direcao","ordenacaoSefaz","direcaoSefaz"])&&(this.$refs.comprasLista.filtros=!0)):this.tabSelecionada.valor!=="Nota na SEFAZ"?this.tabSelecionada2.valor="Digita\xE7\xE3o":this.tabSelecionada2.valor="N\xE3o Importada",this.tabSelecionada2Anterior=this.tabSelecionada2.valor),a=$utils.eliminarVazios(this.filtros),m=this.paginacao.limite,h=this.paginacao.atual,a.status=this.tabSelecionada2.valor,a.operacao=this.tabSelecionada.valor,delete a.termoBusca,this.busca&&(a.termoBusca=this.busca,this.buscaAnterior!==this.busca&&(this.paginacao.atual=1),this.buscaAnterior=this.busca),this.tabSelecionada2.valor==="Todos"&&delete a.status,a.operacao==="Nota na SEFAZ"){let L=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","xNomeEmitente","cpfCnpjEmitente","xNomeDestinatario","cpfCnpjDestinatario","vNF","situacao","nNF"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});if(a.numero&&(L=L.filter(ee=>parseInt(ee.nNF)===parseInt(a.numero))),(p=a.fornecedor)!=null&&p.nome&&(L=L.filter(ee=>ee.xNomeEmitente.toLowerCase().includes(a.fornecedor.nome.toLowerCase()))),(O=a.destinatario)!=null&&O.numeroDocumentoNacional&&(L=L.filter(ee=>{var X;return((X=ee.cpfCnpjDestinatario)==null?void 0:X.replace(/\D/g,""))===a.destinatario.numeroDocumentoNacional.replace(/\D/g,"")})),a.termoBusca)if(/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/.test(a.termoBusca))L=L.filter(X=>X.id===a.termoBusca);else{const X=$utils.removerAcentos(a.termoBusca.toUpperCase()).split(" ").filter(Boolean),J=X.filter(de=>de.match(/^\d+$/)),Ie=X.filter(de=>!de.match(/^\d+$/)),ke=[];for(const de of L){const he=$utils.removerAcentos([de.xNomeEmitente,de.xNomeDestinatario,de.cpfCnpjEmitente,de.cpfCnpjDestinatario].join(" ").toUpperCase()),Ce=[de.nNF].map(String);let ye=!0;for(const De of J)ye=ye&&Ce.includes(De);for(const De of Ie)ye=ye&&he.includes(De);ye&&ke.push(de)}L=ke}const se=await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","dhRecbto"],whereIn:{idDocumentoFiscalEletronico:L.map(ee=>ee.id)}}),q=[];se.forEach(ee=>{var de,he;const X=L.find(Ce=>Ce.id===ee.idDocumentoFiscalEletronico),J=new Date(ee.dhRecbto).setHours(0,0,0,0),Ie=new Date((de=a.periodoEmissao)==null?void 0:de.ini).setHours(0,0,0,0),ke=new Date((he=a.periodoEmissao)==null?void 0:he.fim).setHours(0,0,0,0);(Ie||ke)&&J&&(Ie&&J<Ie||ke&&J>ke)||X&&q.push({id:X.id,descricaoContato:X.xNomeEmitente,numeroDocumentoContato:this.$filters.cpfCnpj(X.cpfCnpjEmitente)||"",descricaoEmpresa:X.xNomeDestinatario,numeroDocumentoEmpresa:this.$filters.cpfCnpj(X.cpfCnpjDestinatario)||"",dhRecbto:ee.dhRecbto,totalDocumento:X.vNF,status:X.situacao,notaNumero:X.nNF})});const N=(h-1)*m;this.paginacao.total=q.length,this.paginacao.maximo=Math.ceil(this.paginacao.total/m)||1,a.direcaoSefaz==="desc"?q.sort((ee,X)=>ee[a.ordenacaoSefaz]<X[a.ordenacaoSefaz]?1:-1):q.sort((ee,X)=>ee[a.ordenacaoSefaz]>X[a.ordenacaoSefaz]?1:-1),this.lista=q.splice(N,m)}else{const L=[a.ordenacao],se=[a.direcao];(ne=a.destinatario)!=null&&ne.value&&(a.idContatoEmpresa=a.destinatario.value);const q=await $db.compra.leListaCompleta({filtros:a,limit:m,page:h,sort:L,dir:se});this.paginacao.total=q.total,this.paginacao.maximo=q.totalPages,this.lista=q.data.compras}for(const{idContato:L}of this.lista)L&&!this.contatos[L]&&(this.contatos[L]={});this.carregarImagensContatos(this.contatos),this.configuraImpressao(a.idEmpresa),s={_id:"ComprasLista_"+((G=this.usuario)==null?void 0:G.id),tabSelecionada:this.tabSelecionada.valor},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:s}),d={_id:"ComprasLista_"+this.tabSelecionada.valor+((me=this.usuario)==null?void 0:me.id),tabSelecionada:this.tabSelecionada.valor,tabSelecionada2:this.tabSelecionada2.valor,filtros:$utils.clonar(this.filtros),busca:this.busca,limite:this.paginacao.limite},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:d})}),$utils.logarFim(e,((f=this.paginacao)==null?void 0:f.total)||1)},async carregarImagensContatos(r){const e=Object.keys(r);if(!!e.length){await $utils.dormir(200);try{const f=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:e}});for(const _ of f)r[_.id].imagem=_.imagem||""}catch(f){console.error("Erro ao carregar imagens de contatos - ",f)}}},adicionarXml(r){this.xmlNotaEntrada.arquivo=r[0]},async concluirImportacao(r){await $tryLoading(async()=>{await $db.compra.grava({atual:r}),$q.notifyPositive("Importa\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Nota de Entrada",await this.$refs.comprasFicha.mostrar({id:r.documento.id})},{mensagem:"Gravando importa\xE7\xE3o..."})},async importarXmlNotaDeEntrada(){var i,s,d,a,m,h,I,b,n,l,C,g;let r;try{$utils.verificarErro(!this.xmlNotaEntrada.arquivo,"Adicione um arquivo XML antes de enviar!"),r=await new Promise((w,u)=>{const y=new FileReader;y.readAsText(this.xmlNotaEntrada.arquivo,"UTF-8"),y.onload=()=>w(y.result),y.onerror=v=>u(v)})}catch(w){return console.error(w),$q.notifyError("Ocorreu um erro na importa\xE7\xE3o"),!1}let e;try{e=await Pt.parseStringPromise(r)}catch(w){return console.error(w),$q.notifyError("Arquivo inv\xE1lido ou corrompido"),!1}const f=(h=(m=(a=(d=(s=(i=e==null?void 0:e.nfeProc)==null?void 0:i.NFe)==null?void 0:s[0])==null?void 0:d.infNFe)==null?void 0:a[0])==null?void 0:m.$.Id)==null?void 0:h.substring(3);if($utils.verificarErro(!f,"N\xE3o foi poss\xEDvel encontrar a chave de acesso do XML. Arquivo inv\xE1lido!"),!((g=(C=(l=(n=(b=(I=e==null?void 0:e.nfeProc)==null?void 0:I.protNFe)==null?void 0:b[0])==null?void 0:n.infProt)==null?void 0:l[0])==null?void 0:C.nProt)==null?void 0:g[0])&&!await $q.dialogSimNao({title:"Aviso importante",message:"O XML que est\xE1 sendo importado n\xE3o foi protocolado pela Sefaz, gostaria de importar o XML sem o protocolo?",html:!0})){$q.notifyError("Opera\xE7\xE3o para importa\xE7\xE3o de XML n\xE3o realizada!",erro);return}await $tryLoading(async()=>{const w=(await $db.hibrido.lista({table:"documento",whereFilter:{chaveAcesso:f}}))[0];$utils.verificarErro(w==null?void 0:w.id,"Esse xml j\xE1 foi importado!");const u=await $db.compra.importaXml({xmlString:r,xmlEstrangeiro:Boolean(this.xmlEstrangeiro)});u.documentosItem.find(({vinculado:y})=>!y)?this.$refs.comprasImportacaoXML.abrir(u):await this.concluirImportacao(u)},{mensagem:"Importando..."}),delete this.xmlNotaEntrada.arquivo,this.modalXMLNotaEntrada=!1,this.xmlEstrangeiro=!1},async fecharXmlNotaDeEntrada(){delete this.xmlNotaEntrada.arquivo},async abrir(r){this.tabSelecionada.valor!=="Nota na SEFAZ"&&this.$refs.comprasFicha.mostrar({id:r})},criarClick(){this.$refs.comprasFicha.criar()},importarXmlClick(){this.modalXMLNotaEntrada=!0},async limparFiltrosClick(){this.filtros=$utils.clonarV2(We.filtros),this.destinatarioSelecionado=null,await this.atualizar()},compareObject(r,e,f=[]){const _=Object.keys(r);for(const i of _)if(!f.includes(i)){if(typeof r[i]=="object"&&r[i]!==null){if(!this.compareObject(r[i],e[i],f))continue;return!0}else if(r[i]!==e[i])return!0}return!1},setOpcoesTabs(r){r!=="Nota na SEFAZ"?this.tabs2=[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}]:this.tabs2=[{valor:"N\xE3o Importada",rotulo:"N\xE3o Importada"},{valor:"Importada",rotulo:"Importada"},{valor:"Todos",rotulo:"Todas"}],this.tabSelecionada2Anterior!==this.tabSelecionada2.valor&&(this.paginacao.atual=1),this.tabSelecionada2Anterior=this.tabSelecionada2.valor},async duplicarDocumento_click(r){!await $q.dialogSimNao({title:"Duplicar",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const e=await $db.hibrido.le({table:"documento",id:r.id});$utils.verificarErro(!e.id,"Compra n\xE3o encontrada");const f=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:r.id}})).sort((s,d)=>new Date(s.dataHoraEmissao||0)-new Date(d.dataHoraEmissao||0)),_=[],i=$utils.uuid();await $db.hibrido.preGrava(_,"documento",{atual:{...e,id:i,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,dataHoraPrevisto:void 0,status:"Digita\xE7\xE3o",operacao:"Pedido de Compra"}}),await $db.hibrido.preGravaLista(_,"documentoItem",{atual:f.map(s=>({...s,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:i,codigoDocumento:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"}))}),await $db.hibrido.enviaLote(_),$q.notifyPositive("Duplica\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Pedido de Compra",await this.$refs.comprasFicha.mostrar({id:i})},{mensagem:"Duplicando..."})},async trocarCfop_click(r){!await $q.dialogSimNao({title:"Confirma\xE7\xE3o",message:"Deseja trocar os CFOP iniciados em 5 para 1556 e 6 para 2556?"})||await $tryLoading(async()=>{var d,a;const e=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:r.id}}),f=$utils.clonarV2(e),_=await $db.hibrido.lista({table:"cfop",whereIn:{id:$utils.unicos(f,"idCfop")}});let i=0;for(const m of _){const h=String((d=m.cfop)!=null?d:""),I=["5401","5402","5403","5405"].includes(h)?"1407":["6401","6402","6403","6405"].includes(h)?"2407":h.charAt(0)==="5"?"1556":h.charAt(0)==="6"?"2556":h;if(I!==h){const b=(a=(await $db.hibrido.lista({table:"cfop",where:{cfop:I}}))[0])==null?void 0:a.id;$utils.verificarErro(!b,`CFOP ${I} n\xE3o encontrado`);for(const n of f)n.idCfop===m.id&&(n.idCfop=b,i++)}}$utils.verificarErro(!i,"N\xE3o h\xE1 CFOPs com inicial 5 ou 6 para realizar trocas");const s=[];await $db.hibrido.preGravaLista(s,"documentoItem",{atual:f,original:e}),await $db.hibrido.enviaLote(s),$q.notifyPositive(`Troca de CFOP realizada com sucesso em ${i} itens!`)},{mensagem:"Processando..."})},async alterarPrevisaoEntrega_click(r){var e,f;this.modalPrevisaoEntrega={visivel:!0,dataPrevistaEntrega:(e=r.dataHoraPrevisto)==null?void 0:e.slice(0,10),horaPrevistaEntrega:(f=r.dataHoraPrevisto)==null?void 0:f.slice(11,16),compra:r}},async alterarPrevisaoEntrega(){await $tryLoading(async()=>{const{compra:r,dataPrevistaEntrega:e,horaPrevistaEntrega:f}=this.modalPrevisaoEntrega;$utils.verificarErro(!e,"\xC9 necess\xE1rio preencher a data");const _=ze.formatDate(`${e} ${f||"00:00:00"}`);$utils.verificarErro(!_,"Data Inv\xE1lida"),_!==ze.formatDate(r.dataHoraPrevisto)?(await $db.hibrido.grava("documento",{atual:{id:r.id,dataHoraPrevisto:_}}),r.dataHoraPrevisto=_,$q.notifyPositive("A previs\xE3o foi salva com sucesso"),this.modalPrevisaoEntrega={}):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")})},async downloadXmlDFeFiltrados(){var r,e,f,_,i;if(!!await $q.dialogSimNao({title:"Download XML's filtrados",message:"Deseja prosseguir com a opera\xE7\xE3o?"}))try{$q.loading.show();let s=[];if($db.hibrido.isOnline())s=(i=(_=(f=await $utils.geeksApi({downloadDFe:{funcao:"2D9F9B43-47D3-491E-AD49-528EC9547BDC",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{},fornecedor:(r=this.filtros.fornecedor)==null?void 0:r.nome,numeroDocumentoNacionalDestinatario:(e=this.filtros.destinatario)==null?void 0:e.numeroDocumentoNacional,periodoRecbto:this.filtros.periodoEmissao}}))==null?void 0:f.data)==null?void 0:_.downloadDFe)!=null?i:[];else{let d=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","dhEmi","cpfCnpjEmitente","cpfCnpjDestinatario","xNomeEmitente","xNomeDestinatario"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});d=d.filter(m=>{var h,I,b;return!(((h=this.filtros.fornecedor)==null?void 0:h.nome)&&!m.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((I=this.filtros.destinatario)==null?void 0:I.numeroDocumentoNacional)&&((b=m.cpfCnpjDestinatario)==null?void 0:b.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))}),(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","chNFe","dhRecbto","xmlProt"],whereIn:{idDocumentoFiscalEletronico:d.map(m=>m.id)}})).forEach(m=>{var l,C;const h=d.find(g=>g.id===m.idDocumentoFiscalEletronico),I=new Date(m.dhRecbto).setHours(0,0,0,0),b=new Date((l=this.filtros.periodoEmissao)==null?void 0:l.ini).setHours(0,0,0,0),n=new Date((C=this.filtros.periodoEmissao)==null?void 0:C.fim).setHours(0,0,0,0);(b||n)&&I&&(b&&I<b||n&&I>n)||h&&s.push({chNFe:m.chNFe,xml:m.xmlProt,cnpj:h.cpfCnpjDestinatario})})}if((s==null?void 0:s.length)>0){const d=Array.from(new Set(s.filter(m=>m.cnpj).map(m=>m.cnpj))),a=new fa;for(const m of d)for(const h of s.filter(I=>I.cnpj===m))a.file(`${m}/${h.chNFe}.procNFe.xml`,h.xml);a.generateAsync({type:"blob"}).then(function(m){const h=new Date,I=document.createElement("a");I.href=window.URL.createObjectURL(m),I.download=`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}-${String(h.getDate()).padStart(2,"0")}_NotasEntradaSEFAZ.zip`,I.click()})}}catch{$q.notify({message:"N\xE3o foi poss\xEDvel realizar o download",type:"negative"})}finally{$q.loading.hide()}},async downloadXmlDFe(r,e){!await $q.dialogSimNao({title:"Download XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{var m;const _=(e==="Nota de Entrada"?await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:r}}):await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:r}}))[0],i=(_==null?void 0:_.xmlProt)||(_==null?void 0:_.xmlData),s=(_==null?void 0:_.chNFe)||((m=/<chNFe>(\d+)<\/chNFe>/i.exec(i))==null?void 0:m[1]);$utils.verificarErro(!i,"N\xE3o foi poss\xEDvel recuperar o XML");const d=document.createElement("a"),a=new Blob([i],{type:"text/plain"});d.setAttribute("href",window.URL.createObjectURL(a)),d.setAttribute("download",`${s||r}-procNFe.xml`),d.click()})},async importarXmlDFe(r){!await $q.dialogSimNao({title:"Importar XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const e=await $db.hibrido.le({table:"documentoFiscalEletronico",id:r}),f=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:r}}))[0];if((e==null?void 0:e.id)&&(f==null?void 0:f.xmlProt)){const _=(await $db.hibrido.lista({table:"documento",whereFilter:{chaveAcesso:f==null?void 0:f.chNFe}}))[0];$utils.verificarErro(_==null?void 0:_.id,"Esse xml j\xE1 foi importado!");const i=await $db.compra.importaXml({xmlString:f.xmlProt});i.documentoFiscalEletronico={id:r,situacao:"Importada"},i.documentosItem.find(({vinculado:s})=>!s)?this.$refs.comprasImportacaoXML.abrir(i):await this.concluirImportacao(i)}},{mensagem:"Importando..."})},async destinatarioOpcoesCarregar(){const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.destinatarioOpcoes=r.map(e=>({label:e.nome,value:e.id,numeroDocumentoNacional:e.numeroDocumentoNacional}))},async configuraImpressao(r){const e=await $db.configuracoes.porNome("impressao.compra",r);this.configImpressao=[...e.length?e.map(f=>({valor:f.valor,texto:f.texto,observacao:f.observacao})):[{valor:"invoice",texto:"Pedido de Compra",observacao:"Invoice"}]]},imprimirPedidoCompra(r,e){r==="pedidoCompra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/OptiSoul/pedidoCompra.html
            ?CodigoDocumento=${e}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `),r==="ped_compra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/distribuidor/email.html
            ?CodigoDocumento=${e}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &NomeReport=ped_compra
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,Versao:this.clienteSistema.versao,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Padrao:this.clienteSistema.padrao?this.clienteSistema.padrao:null,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)},async configuraEtiqueta(){const r=await $db.configuracoes.le({nome:"impressao.etiqueta"}),e=await $db.configuracoes.le({prefixoNome:"impressao.optisoul.etiqueta."});this.opcoesModelo=[],r.length?r.forEach(f=>{this.opcoesModelo.push({rotulo:f.texto,valor:f.observacao&&f.observacao.trim()!==""?f.observacao:f.valor,modelo:f.valor})}):this.opcoesModelo.push({rotulo:"Etiqueta Carta (EBF-23)",valor:"etiqueta-carta-ebf23",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Fila \xD3culos/Joias",valor:"etiqueta-fila-joias",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Fila 3 Colunas",valor:"etiqueta-fila-3colunas",modelo:"imprimir-etiquetas"},{rotulo:"Etiqueta Pimaco (A4 96)",valor:"etiqueta-pimaco-a496",modelo:"imprimir-etiquetas"}),e.length&&e.forEach(f=>{this.opcoesModelo.push({rotulo:f.texto,valor:f.valor.replace("OptiSoul/","")})}),this.modeloSelecionado=this.opcoesModelo[0].valor},async configuraEmpresas(){const r=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.opcoesEmpresas=r.map(e=>({rotulo:e.apelido||e.nome,valor:e.id,codigoEmpresa:e.codigoContato})),this.empresaSelecionada=""},async configuraTabelasPreco(){this.tabelasPreco=await $db.itemTabelaPreco.le({ativo:!0,tabelaMaster:!0})||[],this.opcoesTabelasPreco=this.tabelasPreco.map(r=>({rotulo:r.descricao,valor:r.id,codigoItemTabelaPreco:r.codigoItemTabelaPreco})),this.tabelaPrecoSelecionada=""},async dialogImprimirEtiquetas({acao:r,item:e}){try{await this.configuraEtiqueta(),await this.configuraEmpresas(),await this.configuraTabelasPreco(),this.dialogEtiquetas={[r]:!0,item:e||{},limpar:!1}}catch(f){console.error("Erro ao configurar impress\xE3o de etiquetas",f)}},imprimirEtiquetas(r){var e,f,_,i,s;if(r==="etiqueta_generica_ajustavel"||r==="etiqueta-fila"||r==="etiqueta-carta"||r==="EtiquetaPimaco6Col"){const d=r==="etiqueta_generica_ajustavel"?"":"OptiSoul/";this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/${d}${r}.html
            ?Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &EmBranco=${this.emBranco}
            &CodigoPedido=${(f=(e=this.dialogEtiquetas)==null?void 0:e.item)==null?void 0:f.codigoDocumento}
            &TabelaPreco=${this.tabelaPrecoSelecionada?encodeURIComponent(this.opcoesTabelasPreco.find(a=>a.valor===this.tabelaPrecoSelecionada).codigoItemTabelaPreco):""}
            &CodigoContatoEmpresa=${this.empresaSelecionada?encodeURIComponent(this.opcoesEmpresas.find(a=>a.valor===this.empresaSelecionada).codigoEmpresa):""}
            &cpfUsuarioLogado=${encodeURIComponent(this.usuario.cpf)}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)}else{const d=(_=this.opcoesModelo)==null?void 0:_.find(h=>h.valor===r),a=(d==null?void 0:d.modelo)||"",m=(d==null?void 0:d.valor)||"";$imprimir(a,{id:(s=(i=this.dialogEtiquetas)==null?void 0:i.item)==null?void 0:s.id,impressao:"etiquetas"},{modelo:m,idEmpresa:this.empresaSelecionada,idTabelaPreco:this.tabelaPrecoSelecionada,emBranco:this.emBranco})}},abrirImpressao(r){window.open(r.replace(/[\s\n]/g,""),"_blank").focus()},async adicionarEtiquetas(){var r;try{$q.loading.show();const e=this.dialogEtiquetas;let f=await $db.etiqueta.ler({cpfUsuarioLogado:this.usuario.numeroDocumentoNacional})||[];if(e!=null&&e.limpar){for(const d of f)await $db.etiqueta.remover(d.id);f=[]}const _=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:(r=e==null?void 0:e.item)==null?void 0:r.id}});if(!_.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}const i=_.map(d=>d.idItem),s=await $db.hibrido.lista({table:"item",columns:["id","codigoItem","descricaoConcatenada","valorVenda"],whereIn:{id:i}});if(!s.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}for(const d of s){if(f.length){const m=f.find(h=>h.idItem===d.id)||null;m&&await $db.etiqueta.remover(m==null?void 0:m.id)}const a={id:$utils.uuid(),idItem:d.id,nomeProduto:d.descricaoConcatenada,valor:d.valorVenda||0,quantidadeEtiquetas:_.find(m=>m.idItem===d.id).quantidade||0,cpfUsuarioLogado:this.usuario.numeroDocumentoNacional,dataHoraEmissao:$utils.dataAtual()};await $db.etiqueta.gravar({atual:a})}$q.loading.hide(),this.$q.dialog({title:"",message:"Ir para tela de impress\xE3o de etiquetas?",noRefocus:!0,preventClose:!0,ok:{label:"SIM",push:!0,class:"bg-primary",textColor:"white",flat:!0},cancel:{label:"N\xC3O",push:!0,color:"tertiary",flat:!0}}).onOk(()=>{this.$router.push({name:"EtiquetasLista"})}).onCancel(()=>{this.dialogEtiquetas.adicionar=!1})}catch(e){$q.loading.hide(),$q.notifyError("Erro ao adicionar etiquetas",e)}}},watch:{"tabSelecionada.valor"(){this.tabSelecionada.valor==="Nota na SEFAZ"?this.mostrar.btnMenuMais=!0:this.mostrar.btnMenuMais=!1}},async mounted(){await this.destinatarioOpcoesCarregar(),this.usuario=JSON.parse(localStorage.getItem("usuario")),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema"));const r=[{valor:"Pedido de Compra",rotulo:"Pedido de Compra"},{valor:"Nota de Entrada",rotulo:"Nota de Entrada"}];[52,53,62].includes(Number(this.clienteSistema.codigoSistema))&&r.push({valor:"Nota na SEFAZ",rotulo:"Nota na SEFAZ"}),this.tabs=r,this.atualizar({buscarTabsRecentes:!0,buscarDadosRecentes:!0})}},ha={id:"ComprasLista"},va={class:"mw80 text-center"},ga={key:0,class:"text-weight-medium"},ba={class:"row q-ma-md"},Ia={key:0,class:"row q-ma-md"},ya={class:"certificado-error-messages"},wa={class:"col-12"},_a={class:"col-12"},ka={class:"q-mt-lg text-right"};function Ca(r,e,f,_,i,s){const d=pe("campo"),a=pe("BadgeCopiarUid"),m=pe("avatar"),h=pe("g-label"),I=pe("badge"),b=pe("g-col"),n=pe("g-row"),l=pe("Lista"),C=pe("ComprasFicha"),g=pe("ComprasImportacaoXML"),w=pe("row");return R(),_e("div",ha,[t(l,{ref:"comprasLista",busca:i.busca,"onUpdate:busca":e[15]||(e[15]=u=>i.busca=u),onAtualizar:s.atualizar,onLimparFiltrosClick:s.limparFiltrosClick,onCriarClick:s.criarClick,lista:i.lista,tabSelecionada:i.tabSelecionada,tabs:i.tabs,tabSelecionada2:i.tabSelecionada2,tabs2:i.tabs2,paginacao:i.paginacao,mostrar:i.mostrar},{menuExtras:o(()=>[be((R(),W(fe,{onClick:s.downloadXmlDFeFiltrados,clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"download"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[31]||(e[31]=[x("Download")])),_:1}),t(ue,{caption:""},{default:o(()=>e[32]||(e[32]=[x("XML's filtrados")])),_:1})]),_:1})]),_:1},8,["onClick"])),[[Ee]])]),botaoNovo:o(()=>[t(ce,{label:"Novo",icon:"add",unelevated:"",color:"primary","text-color":"white",class:"hideonmobile"},{default:o(()=>[t(Re,null,{default:o(()=>[t(qe,{link:"","no-border":"",separator:""},{default:o(()=>[be((R(),W(fe,{onClick:s.criarClick,clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"add"})]),_:1}),t(Y,null,{default:o(()=>e[33]||(e[33]=[x("Incluir Manual")])),_:1})]),_:1},8,["onClick"])),[[Ee]]),be((R(),W(fe,{onClick:s.importarXmlClick,clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"add"})]),_:1}),t(Y,null,{default:o(()=>e[34]||(e[34]=[x("Importar XML")])),_:1})]),_:1},8,["onClick"])),[[Ee]])]),_:1})]),_:1})]),_:1}),t(ce,{icon:"add",flat:"",round:"",color:"primary","text-color":"white",class:"hideondesktop"},{default:o(()=>[t(Re,null,{default:o(()=>[t(qe,{link:"","no-border":"",separator:""},{default:o(()=>[be((R(),W(fe,{onClick:s.criarClick,clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"add"})]),_:1}),t(Y,null,{default:o(()=>e[35]||(e[35]=[x("Incluir Manual")])),_:1})]),_:1},8,["onClick"])),[[Ee]]),be((R(),W(fe,{onClick:s.importarXmlClick,clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"add"})]),_:1}),t(Y,null,{default:o(()=>e[36]||(e[36]=[x("Importar XML")])),_:1})]),_:1},8,["onClick"])),[[Ee]])]),_:1})]),_:1})]),_:1})]),filtroCampos:o(()=>[t(d,{modelValue:i.filtros.numero,"onUpdate:modelValue":e[0]||(e[0]=u=>i.filtros.numero=u),dense:"",rotulo:"N\xBA Nota",class:"q-mt-md"},null,8,["modelValue"]),t(d,{modelValue:i.filtros.numeroCompra,"onUpdate:modelValue":e[1]||(e[1]=u=>i.filtros.numeroCompra=u),dense:"",rotulo:"Ordem de compra",class:"q-mt-lg"},null,8,["modelValue"]),t(zt,{modelValue:i.destinatarioSelecionado,"onUpdate:modelValue":[e[2]||(e[2]=u=>i.destinatarioSelecionado=u),s.aoSelecionarDestinatario],options:i.destinatarioOpcoes,clearable:"",dense:"",label:"Destinat\xE1rio",class:"q-mt-lg"},null,8,["modelValue","onUpdate:modelValue","options"]),t(d,{modelValue:i.filtros.fornecedor.nome,"onUpdate:modelValue":e[3]||(e[3]=u=>i.filtros.fornecedor.nome=u),dense:"",rotulo:"Fornecedor",class:"q-mt-lg"},null,8,["modelValue"]),this.tabSelecionada.valor==="Nota na SEFAZ"?(R(),_e(Ve,{key:0},[t(d,{modelValue:i.filtros.periodoEmissao.ini,"onUpdate:modelValue":e[4]||(e[4]=u=>i.filtros.periodoEmissao.ini=u),dense:"",rotulo:"Data Emiss\xE3o",tipo:"data",class:"q-mt-xl"},null,8,["modelValue"]),t(d,{modelValue:i.filtros.periodoEmissao.fim,"onUpdate:modelValue":e[5]||(e[5]=u=>i.filtros.periodoEmissao.fim=u),dense:"",tipo:"data",rotulo:"at\xE9",class:"q-mt-sm"},null,8,["modelValue"]),t(d,{modelValue:i.filtros.ordenacaoSefaz,"onUpdate:modelValue":e[6]||(e[6]=u=>i.filtros.ordenacaoSefaz=u),options:i.ordenacaoSefaz,dense:"",rotuloFixo:"Ordenar por",tipo:"seletor",class:"q-mt-xl"},null,8,["modelValue","options"]),t(d,{modelValue:i.filtros.direcaoSefaz,"onUpdate:modelValue":e[7]||(e[7]=u=>i.filtros.direcaoSefaz=u),options:i.direcaoOpcoes,dense:"",rotuloFixo:"Dire\xE7\xE3o",tipo:"seletor",class:"q-mt-sm"},null,8,["modelValue","options"])],64)):(R(),_e(Ve,{key:1},[t(d,{modelValue:i.filtros.periodoEmissao.ini,"onUpdate:modelValue":e[8]||(e[8]=u=>i.filtros.periodoEmissao.ini=u),dense:"",tipo:"data",rotulo:"Data Emiss\xE3o",class:"q-mt-xl"},null,8,["modelValue"]),t(d,{modelValue:i.filtros.periodoEmissao.fim,"onUpdate:modelValue":e[9]||(e[9]=u=>i.filtros.periodoEmissao.fim=u),dense:"",rotulo:"at\xE9",tipo:"data",class:"q-mt-sm"},null,8,["modelValue"]),t(d,{modelValue:i.filtros.periodoFinalizado.ini,"onUpdate:modelValue":e[10]||(e[10]=u=>i.filtros.periodoFinalizado.ini=u),dense:"",tipo:"data",rotulo:"Data Finalizado",class:"q-mt-xl"},null,8,["modelValue"]),t(d,{modelValue:i.filtros.periodoFinalizado.fim,"onUpdate:modelValue":e[11]||(e[11]=u=>i.filtros.periodoFinalizado.fim=u),dense:"",tipo:"data",rotulo:"at\xE9",class:"q-mt-sm"},null,8,["modelValue"]),t(d,{modelValue:i.filtros.ordenacao,"onUpdate:modelValue":e[12]||(e[12]=u=>i.filtros.ordenacao=u),options:i.ordenacaoOpcoes,dense:"",rotuloFixo:"Ordenar por",tipo:"seletor",class:"q-mt-xl"},null,8,["modelValue","options"]),t(d,{modelValue:i.filtros.direcao,"onUpdate:modelValue":e[13]||(e[13]=u=>i.filtros.direcao=u),options:i.direcaoOpcoes,dense:"",rotuloFixo:"Dire\xE7\xE3o",tipo:"seletor",class:"q-mt-sm"},null,8,["modelValue","options"])],64)),t(d,{modelValue:i.paginacao.limite,"onUpdate:modelValue":e[14]||(e[14]=u=>i.paginacao.limite=u),dense:"",min:"1",tipo:"quantidade",rotulo:"Quantidade por p\xE1gina",class:"q-mt-xl q-mb-lg"},null,8,["modelValue"])]),itemLista:o(()=>[t(qe,{bordered:"",class:"bg-white q-mb-xs rounded-borders",style:{"min-height":"calc(100vh - 200px)"}},{default:o(()=>[(R(!0),_e(Ve,null,Te(i.lista,u=>(R(),_e("div",{key:u.id,class:"itemHover"},[t(fe,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:o(()=>[t(Y,{class:"hideonmobile col-auto q-px-sm no-margin"},{default:o(()=>[ge("div",va,[t(a,{id:u.id,numero:u.numero,cor:"positive",escuro:""},null,8,["id","numero"])])]),_:2},1024),t(Y,{class:"col-md col-lg col-xl no-margin"},{default:o(()=>[t(fe,{class:"q-pa-none"},{default:o(()=>[t(Y,{onClick:y=>s.abrir(u.id),class:"col-auto items-center cursor-pointer"},{default:o(()=>[t(m,{imagem:(i.contatos[u.idContato]||{}).imagem,rotulo:u.descricaoContato,tamanho:"40"},null,8,["imagem","rotulo"])]),_:2},1032,["onClick"]),t(Y,{class:"col"},{default:o(()=>[t(ue,{onClick:y=>s.abrir(u.id),lines:"2",class:"text-weight-bold cursor-pointer"},{default:o(()=>[x(ae(u.descricaoContato)+" ",1),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[37]||(e[37]=[x("Fornecedor")])),_:1})]),_:2},1032,["onClick"]),u.descricaoEmpresa?(R(),W(ue,{key:0,onClick:y=>s.abrir(u.id),caption:"",class:"cursor-pointer"},{default:o(()=>[u.descricaoEmpresa?(R(),W(h,{key:0,icon:"business 14px tertiary left"},{default:o(()=>[x(ae(u.descricaoEmpresa)+" ",1),u.numeroDocumentoEmpresa?(R(),_e("span",ga,"("+ae(u.numeroDocumentoEmpresa)+")",1)):oe("",!0)]),_:2},1024)):oe("",!0)]),_:2},1032,["onClick"])):oe("",!0),t(fe,{class:"q-pa-none hideonmobile q-mt-xs",style:{"min-height":"unset"}},{default:o(()=>[u.notaNumero?(R(),W(I,{key:0,cor:"tertiary",class:"mw50 text-center",escuro:""},{default:o(()=>[x(ae(u.notaNumero)+" ",1),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[38]||(e[38]=[x("N\xFAmero da Nota")])),_:1})]),_:2},1024)):(R(),W(I,{key:1,cor:"warning",class:"mw50 text-center",escuro:""},{default:o(()=>[e[40]||(e[40]=x(" S/N ")),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[39]||(e[39]=[x("N\xFAmero da Nota")])),_:1})]),_:1}))]),_:2},1024),t(Y,{class:"hideondesktop q-mt-sm"},{default:o(()=>[t(n,{mg:"xs-b"},{default:o(()=>[u.dataHoraEmissao?(R(),W(b,{key:0,col:"shrink"},{default:o(()=>[t(h,{icon:"mdi-calendar-today xs tertiary left",tip:`Emitido \xE0s ${r.$filters.hora(u.dataHoraEmissao)}`},{default:o(()=>[x(ae(r.$filters.data(u.dataHoraEmissao)),1)]),_:2},1032,["tip"])]),_:2},1024)):oe("",!0),u.dataHoraFinalizado?(R(),W(b,{key:1,col:"shrink",class:"q-ml-sm"},{default:o(()=>[t(h,{icon:"mdi-calendar xs tertiary left",tip:`Finalizado \xE1s ${r.$filters.hora(u.dataHoraFinalizado)}`},{default:o(()=>[x(ae(r.$filters.data(u.dataHoraFinalizado)),1)]),_:2},1032,["tip"])]),_:2},1024)):oe("",!0)]),_:2},1024),t(n,{mg:"xs-b"},{default:o(()=>[t(b,{col:"shrink"},{default:o(()=>[t(a,{id:u.id,numero:u.numero,cor:"positive",escuro:""},null,8,["id","numero"])]),_:2},1024),t(b,{col:"shrink",class:"q-ml-sm"},{default:o(()=>[u.notaNumero?(R(),W(I,{key:0,cor:"tertiary",class:"mw50",escuro:""},{default:o(()=>[x(ae(u.notaNumero)+" ",1),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[41]||(e[41]=[x("N\xFAmero da Nota")])),_:1})]),_:2},1024)):(R(),W(I,{key:1,cor:"warning",class:"mw50",escuro:""},{default:o(()=>[e[43]||(e[43]=x(" S/N ")),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[42]||(e[42]=[x("N\xFAmero da Nota")])),_:1})]),_:1}))]),_:2},1024),t(b,{col:"shrink",class:"q-ml-sm"},{default:o(()=>[t(I,{rotulo:u.status,cor:u.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:u.status!=="Digita\xE7\xE3o"},null,8,["rotulo","cor","escuro"])]),_:2},1024)]),_:2},1024),t(n,null,{default:o(()=>[t(b,{col:"shrink",text:"bold"},{default:o(()=>[x(ae(r.$filters.numero(u.totalDocumento,2)),1)]),_:2},1024),be(t(b,{col:"grow",text:"center",class:"q-ml-sm"},{default:o(()=>[x(ae(u.qtdeContatos)+" Itens ",1)]),_:2},1536),[[Oe,u.qtdeContatos>0]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(Y,{onClick:y=>s.abrir(u.id),class:"hideonmobile maxw110 q-pl-sm no-margin cursor-pointer"},{default:o(()=>[this.tabSelecionada.valor==="Nota na SEFAZ"?(R(),_e(Ve,{key:0},[u.dhRecbto?(R(),W(ue,{key:0,color:"tertiary",class:"ellipsis"},{default:o(()=>[t(ie,{name:"mdi-calendar-today"}),x(" "+ae(r.$filters.data(u.dhRecbto))+" ",1),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[x(" Autorizado \xE0s "+ae(r.$filters.hora(u.dhRecbto)),1)]),_:2},1024)]),_:2},1024)):oe("",!0)],64)):(R(),_e(Ve,{key:1},[u.dataHoraEmissao?(R(),W(ue,{key:0,color:"tertiary",class:"ellipsis"},{default:o(()=>[t(ie,{name:"mdi-calendar-today"}),x(" "+ae(r.$filters.data(u.dataHoraEmissao))+" ",1),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[x(" Emitido \xE0s "+ae(r.$filters.hora(u.dataHoraEmissao)),1)]),_:2},1024)]),_:2},1024)):oe("",!0),u.dataHoraFinalizado?(R(),W(ue,{key:1,color:"tertiary",class:"ellipsis"},{default:o(()=>[t(ie,{name:"mdi-calendar"}),x(" "+ae(r.$filters.data(u.dataHoraFinalizado))+" ",1),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>[x(" Finalizado \xE1s "+ae(r.$filters.hora(u.dataHoraFinalizado)),1)]),_:2},1024)]),_:2},1024)):oe("",!0)],64))]),_:2},1032,["onClick"]),t(Y,{onClick:y=>s.abrir(u.id),class:"hideonmobile maxw100 q-pl-sm no-margin cursor-pointer"},{default:o(()=>[t(I,{cor:u.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:u.status!=="Digita\xE7\xE3o",class:"col-auto q-mx-auto"},{default:o(()=>[x(ae(u.status)+" ",1),t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[44]||(e[44]=[x(" Status ")])),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),t(Y,{onClick:y=>s.abrir(u.id),class:"hideonmobile maxw120 q-pl-sm no-margin cursor-pointer"},{default:o(()=>[t(ue,{class:"text-tertiary text-weight-bold text-right"},{default:o(()=>[x(ae(r.$filters.numero(u.totalDocumento,2)),1)]),_:2},1024),be(t(ue,{class:"text-tertiary text-right"},{default:o(()=>[x(ae(u.qtdeContatos)+" Itens ",1)]),_:2},1536),[[Oe,u.qtdeContatos>0]])]),_:2},1032,["onClick"]),t(Y,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:o(()=>[t(fe,{class:"q-pa-none"},{default:o(()=>[i.tabSelecionada.valor!=="Nota na SEFAZ"&&u.status==="Digita\xE7\xE3o"?(R(),W(Y,{key:0,class:"no-margin"},{default:o(()=>[t(ce,{onClick:y=>s.abrir(u.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"&&u.status!=="Digita\xE7\xE3o"?(R(),W(Y,{key:1,class:"no-margin"},{default:o(()=>[t(ce,{onClick:y=>s.abrir(u.id),icon:"remove_red_eye",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)):oe("",!0),i.tabSelecionada.valor==="Nota na SEFAZ"?(R(),W(Y,{key:2,class:"no-margin",style:{width:"33.6px"}},{default:o(()=>[u.status==="N\xE3o Importada"?(R(),W(ce,{key:0,onClick:y=>s.importarXmlDFe(u.id),flat:"",round:"",dense:"",icon:"mdi-upload",size:"md",color:"tertiary",class:"buttons"},{default:o(()=>[t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[45]||(e[45]=[x("Importar XML")])),_:1})]),_:2},1032,["onClick"])):oe("",!0)]),_:2},1024)):oe("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(i.tabSelecionada.valor)?(R(),W(Y,{key:3,class:"no-margin",style:{width:"33.6px"}},{default:o(()=>[t(ce,{onClick:y=>s.downloadXmlDFe(u.id,i.tabSelecionada.valor),flat:"",round:"",dense:"",icon:"mdi-download",color:"tertiary",size:"md",class:"buttons"},{default:o(()=>[t(Fe,{anchor:"bottom middle",self:"center middle"},{default:o(()=>e[46]||(e[46]=[x("Download XML")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(Y,{key:4,class:"no-margin"},{default:o(()=>[t(ce,{icon:"print",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:o(()=>[t(Re,null,{default:o(()=>[be((R(),W(qe,{link:"","no-border":"",separator:""},{default:o(()=>[(R(!0),_e(Ve,null,Te(i.configImpressao,y=>(R(),W(fe,{key:y.valor,onClick:v=>r.$imprimir(y.valor,u.id),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>[x(ae(y.texto),1)]),_:2},1024),y.observacao?(R(),W(ue,{key:0,caption:""},{default:o(()=>[x(ae(y.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),(R(!0),_e(Ve,null,Te(i.configImpressaoPedidoCompra,y=>(R(),W(fe,{key:y.valor,onClick:v=>s.imprimirPedidoCompra(y.valor,u==null?void 0:u.codigoDocumento),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>[x(ae(y.texto),1)]),_:2},1024),y.observacao?(R(),W(ue,{key:0,caption:""},{default:o(()=>[x(ae(y.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(fe,{onClick:y=>s.dialogImprimirEtiquetas({acao:"adicionar",item:u}),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[47]||(e[47]=[x(" Etiquetas ")])),_:1}),t(ue,{caption:""},{default:o(()=>e[48]||(e[48]=[x(" Adicionar \xE1 Fila ")])),_:1})]),_:1})]),_:2},1032,["onClick"]),t(fe,{onClick:y=>s.dialogImprimirEtiquetas({acao:"impressao",item:u}),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[49]||(e[49]=[x(" Etiquetas ")])),_:1}),t(ue,{caption:""},{default:o(()=>e[50]||(e[50]=[x(" Impress\xE3o Direta ")])),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(Y,{key:5,class:"no-margin"},{default:o(()=>[t(ce,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:o(()=>[t(Re,null,{default:o(()=>[be((R(),W(qe,{link:"","no-border":"",separator:""},{default:o(()=>[i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:0,onClick:y=>s.duplicarDocumento_click(u),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"content_copy"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[51]||(e[51]=[x(" Duplicar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:1,onClick:y=>s.alterarPrevisaoEntrega_click(u),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"local_shipping"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[52]||(e[52]=[x("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:2,onClick:y=>s.trocarCfop_click(u),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"sync_alt"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[53]||(e[53]=[x("Trocar CFOP para consumo")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),oe("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1024),t(Y,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:o(()=>[t(ce,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:o(()=>[t(Re,null,{default:o(()=>[be((R(),W(qe,{link:"","no-border":"",separator:""},{default:o(()=>[oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:1,onClick:y=>s.abrir(u.id),clickable:"",class:"itemHover"},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"edit"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[58]||(e[58]=[x(" Editar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor==="Nota na SEFAZ"&&u.status==="N\xE3o Importada"?(R(),W(fe,{key:2,onClick:y=>s.importarXmlDFe(u.id),clickable:"",class:"itemHover"},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"mdi-upload"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[59]||(e[59]=[x(" Importar XML ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),["Nota na SEFAZ","Nota de Entrada"].includes(i.tabSelecionada.valor)?(R(),W(fe,{key:3,onClick:y=>s.downloadXmlDFe(u.id,i.tabSelecionada.valor),clickable:"",class:"itemHover"},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"mdi-download"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[60]||(e[60]=[x(" Download XML ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(!0),_e(Ve,{key:4},Te(i.configImpressao,y=>(R(),W(fe,{key:y.valor,onClick:v=>r.$imprimir(y.valor,u.id),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>[x(ae(y.texto),1)]),_:2},1024),y.observacao?(R(),W(ue,{key:0,caption:""},{default:o(()=>[x(ae(y.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(!0),_e(Ve,{key:5},Te(i.configImpressaoPedidoCompra,y=>(R(),W(fe,{clickable:"",key:y.valor,onClick:v=>s.imprimirPedidoCompra(y.valor,u==null?void 0:u.codigoDocumento)},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>[x(ae(y.texto),1)]),_:2},1024),y.observacao?(R(),W(ue,{key:0,caption:""},{default:o(()=>[x(ae(y.observacao),1)]),_:2},1024)):oe("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:6,clickable:"",onClick:y=>s.dialogImprimirEtiquetas({acao:"adicionar",item:u})},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[61]||(e[61]=[x(" Etiquetas ")])),_:1}),t(ue,{caption:""},{default:o(()=>e[62]||(e[62]=[x(" Adicionar \xE1 Fila ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:7,clickable:"",onClick:y=>s.dialogImprimirEtiquetas({acao:"impressao",item:u})},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"print"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[63]||(e[63]=[x(" Etiquetas ")])),_:1}),t(ue,{caption:""},{default:o(()=>e[64]||(e[64]=[x(" Impress\xE3o Direta ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:8,onClick:y=>s.duplicarDocumento_click(u),clickable:"",class:"itemHover"},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"content_copy"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[65]||(e[65]=[x(" Duplicar ")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:9,onClick:y=>s.alterarPrevisaoEntrega_click(u),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"local_shipping"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[66]||(e[66]=[x("Alterar Previs\xE3o de Entrega")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0),i.tabSelecionada.valor!=="Nota na SEFAZ"?(R(),W(fe,{key:10,onClick:y=>s.trocarCfop_click(u),clickable:""},{default:o(()=>[t(Y,{avatar:""},{default:o(()=>[t(ie,{name:"sync_alt"})]),_:1}),t(Y,null,{default:o(()=>[t(ue,null,{default:o(()=>e[67]||(e[67]=[x("Trocar CFOP para consumo")])),_:1})]),_:1})]),_:2},1032,["onClick"])):oe("",!0)]),_:2},1024)),[[Ee]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(ct)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onLimparFiltrosClick","onCriarClick","lista","tabSelecionada","tabs","tabSelecionada2","tabs2","paginacao","mostrar"]),t(C,{ref:"comprasFicha",onAtualizar:s.atualizar,onDialogImprimirEtiquetas:s.dialogImprimirEtiquetas},null,8,["onAtualizar","onDialogImprimirEtiquetas"]),t(g,{ref:"comprasImportacaoXML",onAtualizar:s.atualizar,onConcluirImportacao:s.concluirImportacao},null,8,["onAtualizar","onConcluirImportacao"]),t($e,{modelValue:i.modalXMLNotaEntrada,"onUpdate:modelValue":e[19]||(e[19]=u=>i.modalXMLNotaEntrada=u),persistent:""},{default:o(()=>[t(je,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:o(()=>[ge("form",{onSubmit:e[18]||(e[18]=qt((...u)=>s.importarXmlNotaDeEntrada&&s.importarXmlNotaDeEntrada(...u),["prevent"]))},[t(He,null,{default:o(()=>[t(xe,null,{default:o(()=>[be(t(ce,{onClick:s.fecharXmlNotaDeEntrada,flat:"",round:"",dense:"",icon:"close"},null,8,["onClick"]),[[Ee]]),t(Le,null,{default:o(()=>e[68]||(e[68]=[x("Importar XML Nota de Entrada")])),_:1}),t(ce,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),t(Ze,{class:"u-container"},{default:o(()=>[t(Ge,{style:{"min-height":"300px"}},{default:o(()=>{var u,y,v;return[ge("div",ba,[t(At,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:s.adicionarXml,filter:V=>V.filter(D=>D.type==="text/xml")},null,8,["factory","filter"]),t(It,{modelValue:i.xmlDevolucao,"onUpdate:modelValue":e[16]||(e[16]=V=>i.xmlDevolucao=V),label:"Devolu\xE7\xE3o"},null,8,["modelValue"]),t(It,{modelValue:i.xmlEstrangeiro,"onUpdate:modelValue":e[17]||(e[17]=V=>i.xmlEstrangeiro=V),label:"Importa\xE7\xE3o do exterior"},null,8,["modelValue"])]),Object.keys((v=(y=(u=i.xmlNotaEntrada.error)==null?void 0:u.data)==null?void 0:y.fields)!=null?v:{}).length?(R(),_e("div",Ia,[ge("ul",ya,[(R(!0),_e(Ve,null,Te(Object.keys(i.xmlNotaEntrada.error.data.fields),V=>(R(),_e("li",{key:V},[ge("span",null,ae(V),1),ge("span",null,ae(i.xmlNotaEntrada.error.data.fields[V]),1)]))),128))])])):oe("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),t($e,{modelValue:i.modalPrevisaoEntrega.visivel,"onUpdate:modelValue":e[22]||(e[22]=u=>i.modalPrevisaoEntrega.visivel=u),"content-css":{minWidth:"50vw"}},{default:o(()=>[t(Nt,null,{default:o(()=>[t(xe,{class:"bg-primary text-white"},{default:o(()=>[t(Le,null,{default:o(()=>e[69]||(e[69]=[x("Alterar Previs\xE3o de Entrega")])),_:1}),be(t(ce,{dense:"",flat:"",icon:"close",round:""},null,512),[[Ee]])]),_:1}),t(Tt,null,{default:o(()=>[t(lt,{onSubmit:s.alterarPrevisaoEntrega},{default:o(()=>[t(w,{class:"q-col-gutter-md"},{default:o(()=>[ge("div",wa,[t(Qe,{modelValue:i.modalPrevisaoEntrega.dataPrevistaEntrega,"onUpdate:modelValue":e[20]||(e[20]=u=>i.modalPrevisaoEntrega.dataPrevistaEntrega=u),type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])]),ge("div",_a,[t(Qe,{modelValue:i.modalPrevisaoEntrega.horaPrevistaEntrega,"onUpdate:modelValue":e[21]||(e[21]=u=>i.modalPrevisaoEntrega.horaPrevistaEntrega=u),type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:""},null,8,["modelValue"])])]),_:1}),ge("div",ka,[be(t(ce,{color:"tertiary",flat:"",label:"Cancelar"},null,512),[[Ee]]),t(ce,{color:"primary",class:"q-ml-sm no-shadow",unelevated:"",label:"Alterar",type:"submit"})])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t($e,{modelValue:i.dialogEtiquetas.impressao,"onUpdate:modelValue":e[28]||(e[28]=u=>i.dialogEtiquetas.impressao=u)},{default:o(()=>[t(je,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"425px"}},{default:o(()=>[t(lt,{onSubmit:e[27]||(e[27]=u=>s.imprimirEtiquetas(i.modeloSelecionado)),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:o(()=>[t(He,null,{default:o(()=>[t(xe,{class:"bg-primary text-white"},{default:o(()=>[t(Le,null,{default:o(()=>[t(ie,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),e[70]||(e[70]=x(" Imprimir Etiquetas "))]),_:1})]),_:1})]),_:1}),t(Ze,null,{default:o(()=>[t(Ge,{class:"q-pa-md"},{default:o(()=>[t(h,{class:"q-pb-lg"},{default:o(()=>{var u,y,v,V,D,z,A,$,T,Z,re,E,U;return[e[71]||(e[71]=x(" Imprimir os itens: ")),ge("strong",null,ae((u=i.tabSelecionada)==null?void 0:u.valor)+" "+ae((v=(y=i.dialogEtiquetas)==null?void 0:y.item)!=null&&v.numero?", #"+((D=(V=i.dialogEtiquetas)==null?void 0:V.item)==null?void 0:D.numero):"")+" "+ae((A=(z=i.dialogEtiquetas)==null?void 0:z.item)!=null&&A.descricaoContato?" - "+((T=($=i.dialogEtiquetas)==null?void 0:$.item)==null?void 0:T.descricaoContato):"")+" "+ae((re=(Z=i.dialogEtiquetas)==null?void 0:Z.item)!=null&&re.notaNumero?", Nota #"+((U=(E=i.dialogEtiquetas)==null?void 0:E.item)==null?void 0:U.notaNumero):""),1),e[72]||(e[72]=x(". "))]}),_:1}),t(d,{modelValue:i.modeloSelecionado,"onUpdate:modelValue":e[23]||(e[23]=u=>i.modeloSelecionado=u),opcoes:i.opcoesModelo,dense:"",filled:"",tipo:"seletor",rotulo:"Modelo",cor:"white","popup-content-class":"etiquetas-modelo-selecionado",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(d,{modelValue:i.empresaSelecionada,"onUpdate:modelValue":e[24]||(e[24]=u=>i.empresaSelecionada=u),opcoes:i.opcoesEmpresas,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Empresa",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(d,{modelValue:i.tabelaPrecoSelecionada,"onUpdate:modelValue":e[25]||(e[25]=u=>i.tabelaPrecoSelecionada=u),opcoes:i.opcoesTabelasPreco,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Tabela de Pre\xE7o",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(d,{modelValue:i.emBranco,"onUpdate:modelValue":e[26]||(e[26]=u=>i.emBranco=u),min:0,tipo:"quantidade",dense:"",filled:"",rotulo:"Etiquetas em branco",color:"tertiary","text-color":"red"},null,8,["modelValue"])]),_:1})]),_:1}),t(Ke,{class:"bg-light"},{default:o(()=>[t(xe,null,{default:o(()=>[t(tt),be(t(ce,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ee]]),t(ce,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t($e,{modelValue:i.dialogEtiquetas.adicionar,"onUpdate:modelValue":e[30]||(e[30]=u=>i.dialogEtiquetas.adicionar=u)},{default:o(()=>[t(je,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"250px"}},{default:o(()=>[t(lt,{onSubmit:s.adicionarEtiquetas,autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:o(()=>[t(He,null,{default:o(()=>[t(xe,{class:"bg-primary text-white"},{default:o(()=>[t(Le,null,{default:o(()=>[t(ie,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),e[73]||(e[73]=x(" Adicionar os itens a lista de etiquetas "))]),_:1})]),_:1})]),_:1}),t(Ze,null,{default:o(()=>[t(Ge,{class:"q-pa-md"},{default:o(()=>[t(h,{class:"q-pb-lg"},{default:o(()=>{var u,y,v,V,D,z,A,$,T,Z,re,E,U;return[e[74]||(e[74]=x(" Adicionar os itens: ")),ge("strong",null,ae((u=i.tabSelecionada)==null?void 0:u.valor)+" "+ae((v=(y=i.dialogEtiquetas)==null?void 0:y.item)!=null&&v.numero?", #"+((D=(V=i.dialogEtiquetas)==null?void 0:V.item)==null?void 0:D.numero):"")+" "+ae((A=(z=i.dialogEtiquetas)==null?void 0:z.item)!=null&&A.descricaoContato?" - "+((T=($=i.dialogEtiquetas)==null?void 0:$.item)==null?void 0:T.descricaoContato):"")+" "+ae((re=(Z=i.dialogEtiquetas)==null?void 0:Z.item)!=null&&re.notaNumero?", Nota #"+((U=(E=i.dialogEtiquetas)==null?void 0:E.item)==null?void 0:U.notaNumero):""),1),e[75]||(e[75]=x(" \xE0 lista de etiquetas para impress\xE3o. "))]}),_:1}),t(d,{modelValue:i.dialogEtiquetas.limpar,"onUpdate:modelValue":e[29]||(e[29]=u=>i.dialogEtiquetas.limpar=u),tipo:"logico",rotulo:"Limpar lista de etiquetas anterior."},null,8,["modelValue"])]),_:1})]),_:1}),t(Ke,{class:"bg-light"},{default:o(()=>[t(xe,null,{default:o(()=>[t(tt),be(t(ce,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ee]]),t(ce,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}var qa=st(pa,[["render",Ca]]);export{qa as default};
