import{_ as rt,a5 as Ct,r as fe,o as $,d as J,w as r,f as t,M as je,G as $e,h as Ne,i as Re,k as B,t as Y,m as De,e as ie,H as _e,Q as ue,N as Ve,I as He,J as Ze,p as ve,b0 as kt,b1 as st,b6 as St,b7 as nt,W as Le,b8 as mt,d6 as ft,d7 as Oe,K as Ye,aW as ot,D as Xe,bj as bt,at as Ue,b5 as Pe,s as pt,bg as Me,P as xe,S as be,T as K,j as pe,U as ne,A as Et,F as Se,u as Te,C as he,l as lt,aQ as ht,E as dt,bs as vt,d$ as Dt,c as tt,bI as at,e0 as Vt,au as xt,av as Pt,d8 as zt,aP as gt}from"./index.f69280f2.js";import{L as Ft}from"./Lista.9cf58f1f.js";import{S as Tt}from"./SeletorCfop.dbd0624e.js";import{C as Nt}from"./Campo.41db07f3.js";import"./xlsx.2cc3dc6b.js";const At={components:{SeletorNcm:Ct,SeletorCfop:Tt,Campo:Nt},data(){return{abaSelecionada:"tab1",historicoItem:[],tabelaHistoricoItem:{colunas:[{name:"fornecedor",label:"Fornecedor",align:"left"},{name:"dataCompra",label:"Data Compra",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"},{name:"valorCusto",label:"Valor de Custo",align:"right"},{name:"valorTotal",label:"Valor Total (Custo)",align:"right"}],paginacao:{page:1,rowsPerPage:5}},estoqueItem:[],tabelaEstoqueItem:{colunas:[{name:"empresa",label:"Empresa",align:"left"},{name:"tipoEstoque",label:"Tipo estoque",align:"right"},{name:"lote",label:"Lote",align:"right"},{name:"quantidade",label:"Quantidade",align:"right"}],paginacao:{page:1,rowsPerPage:5}},compra:{},cfop:null,cstIcms:"",cstIpi:"",contaEstoque:[],impostoCstIpi:[],impostoIcmsModalidade:[],impostoCstIcms:[],impostoCstIcmsSt:[],documentoItem:{},imposto:{},item:{},visivel:!1,contasOpcoes:[],exibirIcms:!1,exibirIcmsSt:!1,exibirIpi:!1,somenteLeituraIcms:!1,somenteLeituraIcmsSt:!1,exibirHistorico:!1,exibirEstoque:!1,exibeCfop:!1}},emits:["salvar"],methods:{async mostrar(o,l,p){var m,e,c,v,y,g,_,n,C,i;this.compra=p,this.documentoItem=$utils.clonarV2(o),this.item=$utils.clonarV2(l),await this.consultarHistoricoItem(this.item),await this.consultarEstoqueItem(this.item);const w=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:1}}),a=await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:21}});this.impostoCstIcms=w.concat(a).map(h=>({rotulo:h.numero.trim()+" - "+h.descr,valor:Number(h.numero)})).sort((h,d)=>Number(h.valor)-Number(d.valor)),this.impostoIcmsModalidade=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:3}})).map(h=>({rotulo:h.numero.trim()+" - "+h.descr,valor:Number(h.numero)})).sort((h,d)=>Number(h.valor)-Number(d.valor)),this.impostoCstIcmsSt=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:4}})).map(h=>({rotulo:h.numero.trim()+" - "+h.descr,valor:Number(h.numero)})).sort((h,d)=>Number(h.valor)-Number(d.valor)),this.impostoCstIpi=(await $db.hibrido.lista({table:"impostoParametro",where:{impParamTipoCod:5}})).map(h=>({rotulo:h.numero.trim()+" - "+h.descr,valor:Number(h.numero)})).sort((h,d)=>Number(h.valor)-Number(d.valor)),this.contaEstoque=(await $db.hibrido.lista({table:"financeiroPlanoConta"})).map(h=>{var d,b,S;return{rotulo:(S=(b=(d=h==null?void 0:h.descricao)!=null?d:" - "+(h==null?void 0:h.classificacao))!=null?b:" - "+(h==null?void 0:h.caminho))!=null?S:"",valor:h.id}}).sort((h,d)=>Number(h.valor)-Number(d.valor));let s;(m=this.documentoItem)!=null&&m.idCfop&&(s=await $erp().cfop.where({id:this.documentoItem.idCfop}).first()),s===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.cfop=(e=s==null?void 0:s.cfop.toString())!=null?e:"",this.documentoItem.codigoCfop=(c=s==null?void 0:s.codigoCfop)!=null?c:null,this.documentoItem.idCfop=(v=s.id)!=null?v:null,this.documentoItem.valorBaseIcms=(g=(y=this.documentoItem.valorBaseIcms)!=null?y:this.documentoItem.total)!=null?g:0,this.documentoItem.valorBaseIpi=(n=(_=this.documentoItem.valorBaseIpi)!=null?_:this.documentoItem.total)!=null?n:0,this.documentoItem.valorBaseIcmsSt=(i=(C=this.documentoItem.valorBaseIcmsSt)!=null?C:this.documentoItem.total)!=null?i:0,this.calcularImpostos(),this.exibeCfop=!0,this.visivel=!0},async salvar(){try{if(Object.keys(this.documentoItem.cfop).length>0){const o=await $db.hibrido.lista({table:"cfop",where:{cfop:Number(this.documentoItem.cfop)}});this.documentoItem.codigoCfop=o[0].codigoCfop,this.documentoItem.idCfop=o[0].id}this.documentoItem.cfop&&delete this.documentoItem.cfop,this.$emit("salvar",this.documentoItem),this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1,this.visivel=!1}catch(o){$q.notifyError("Ocorreu um erro ao salvar o produto: ",o.message)}finally{$q.notifyPositive("Produto salvo com sucesso.")}},calcularImpostos(o){var g,_,n,C,i,h,d,b,S,D;let l=(g=this.documentoItem.valorBaseIcms)!=null?g:0,p=(_=this.documentoItem.valorBaseIpi)!=null?_:0,w=(n=this.documentoItem.valorBaseIcmsSt)!=null?n:0,a=(C=this.documentoItem.percentualIcms)!=null?C:0,s=(i=this.documentoItem.percentualIpi)!=null?i:0,m=(h=this.documentoItem.percentualIVA)!=null?h:0,e=(d=this.documentoItem.percentualIcmsSt)!=null?d:0,c=(b=this.documentoItem.valorIcms)!=null?b:0,v=(S=this.documentoItem.valorIpi)!=null?S:0,y=(D=this.documentoItem.valorIcmsSt)!=null?D:0;["valorBaseIcms","percentualIcms"].includes(o)&&(c=l*a/100),o==="valorIcms"&&(a=c/l*100),["valorBaseIpi","percentualIpi"].includes(o)&&(v=p*s/100),o==="valorIpi"&&(s=v/p*100),o==="valorBaseIcmsSt"&&(m=0,w>0&&l>0&&w>=l&&(m=(w-l)/l*100),y=w*e/100-c),o==="percentualIVA"&&(w=l*(1+m/100),y=w*e/100-c),o==="percentualIcmsSt"&&(y=w*e/100-c),o==="valorIcmsSt"&&(e=y/w*100),this.documentoItem.valorBaseIcmsSt=parseFloat(w.toFixed(2)),this.documentoItem.percentualIcms=parseFloat(a.toFixed(2)),this.documentoItem.percentualIcmsSt=parseFloat(e.toFixed(2)),this.documentoItem.percentualIpi=parseFloat(s.toFixed(2)),this.documentoItem.percentualIVA=parseFloat(m.toFixed(2)),this.documentoItem.valorIcms=parseFloat(c.toFixed(2)),this.documentoItem.valorIcmsSt=parseFloat(y.toFixed(2)),this.documentoItem.valorIpi=parseFloat(v.toFixed(2)),(this.documentoItem.modalidadeBaseCalculo||this.documentoItem.codigoCst||this.documentoItem.percentualIcms>0||this.documentoItem.valorIcms>0)&&(this.exibirIcms=!0),(this.documentoItem.modalidadeBaseCalculoST||this.documentoItem.percentualIcmsSt>0||this.documentoItem.valorIcmsSt>0)&&(this.exibirIcmsSt=!0),(this.documentoItem.codigoCstIpi||this.documentoItem.percentualIpi>0||this.documentoItem.valorIpi>0)&&(this.exibirIpi=!0)},async consultarCFOP(){var p,w;const o=this.documentoItem.cfop,l=await $erp().cfop.where({cfop:Number(o)}).first();l===void 0&&console.log("CFOP inv\xE1lido"),this.documentoItem.idCfop=(p=l==null?void 0:l.id)!=null?p:null,this.documentoItem.codigoCfop=(w=l==null?void 0:l.CodigoCFOP)!=null?w:null},async consultarHistoricoItem(o){const l={};(o==null?void 0:o.atual)&&Object.keys(o.atual).length>0&&(o=o.atual);const w=(await $db.hibrido.lista({table:"documentoItem",where:{idItem:o.id}})).filter(a=>(a.operacao==="Compra"||a.operacao==="Compra de Mercadoria")&&a.status==="Finalizado"&&a.operacaoFator===1&&a.quantidade>0);for(const a of w){const s=await $db.hibrido.le({table:"documento",id:a.idDocumento}),m=await $db.hibrido.le({table:"contato",id:s.idContato});l[a.idItem]||(l[a.idItem]={fornecedores:[]}),l[a.idItem].fornecedores.push({fornecedor:m.apelido||"",dataCompra:s.dataCompra||"",quantidade:a.quantidade||"",valorCusto:a.valorItem||"",valorTotal:a.valorItem*a.quantidade||""})}Object.keys(l).length>0?(this.historicoItem=l,this.historicoItem[o.id].fornecedores.sort((a,s)=>{const m=new Date(a.dataCompra||"1900-01-01");return new Date(s.dataCompra||"1900-01-01")-m})):this.historicoItem[o.id]={fornecedores:[]},this.exibirHistorico=!0},async consultarEstoqueItem(o){const l={};(o==null?void 0:o.atual)&&Object.keys(o.atual).length>0&&(o=o.atual);const p=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",where:{idItem:o.id},whereFilter:{tipoEstoque:"Dispon\xEDvel"}});for(const w of p){const a=await $db.hibrido.le({table:"contato",id:w.idEmpresa});l[w.idItem]||(l[w.idItem]={estoques:[]}),l[w.idItem].estoques.push({empresa:a.apelido||"",tipoEstoque:w.tipoEstoque||"",lote:w.lote||"-",quantidade:w.saldo||""})}Object.keys(l).length>0?(this.estoqueItem=l,this.estoqueItem[o.id].estoques.sort((w,a)=>{const s=Number(w.quantidade||0);return Number(a.quantidade||0)-s})):this.estoqueItem[o.id]={estoques:[]},this.exibirEstoque=!0},async fechar(){this.documentoItem.cfop&&delete this.documentoItem.cfop,this.exibirIcms=!1,this.exibirIcmsSt=!1,this.exibirIpi=!1}}},qt=["src"],Bt={key:0},Ot={key:0};function Ut(o,l,p,w,a,s){const m=fe("badge"),e=fe("g-col"),c=fe("g-row"),v=fe("campo"),y=fe("SeletorNcm"),g=fe("SeletorCfop"),_=fe("g-label");return $(),J(Xe,{modelValue:a.visivel,"onUpdate:modelValue":l[36]||(l[36]=n=>a.visivel=n),persistent:""},{default:r(()=>[t(je,{container:"",view:"hHh Lpr fFf",class:"bg-white",style:{"max-width":"980px"}},{default:r(()=>[t($e,{class:"bg-primary"},{default:r(()=>[t(Ne,{class:"bg-primary text-white"},{default:r(()=>[t(Re,null,{default:r(()=>[B(Y(a.documentoItem.descricaoItem),1)]),_:1}),a.item.referencia?($(),J(m,{key:0,cor:"tertiary",class:"q-mr-sm"},{default:r(()=>[B(Y(a.item.referencia)+" ",1),t(De,null,{default:r(()=>[B(" Refer\xEAncia ")]),_:1})]),_:1})):ie("",!0),a.item.codigoItem?($(),J(m,{key:1,cor:"positive",class:"q-mr-sm"},{default:r(()=>[B(" #"+Y(a.item.codigoItem.toString().padStart(4,"0"))+" ",1),t(De,null,{default:r(()=>[B(" C\xF3digo Item ")]),_:1})]),_:1})):ie("",!0),_e(t(ue,{onClick:s.fechar,dense:"",flat:"",icon:"close",round:""},null,8,["onClick"]),[[Ve]])]),_:1})]),_:1}),t(He,null,{default:r(()=>[t(Ze,null,{default:r(()=>[t(c,{gutter:"md"},{default:r(()=>[t(e,null,{default:r(()=>[t(c,{class:"col-12 text-center"},{default:r(()=>[t(e,null,{default:r(()=>{var n,C,i,h,d,b;return[((n=a.item)==null?void 0:n.imagem)||((i=(C=a.item)==null?void 0:C.atual)==null?void 0:i.imagem)?($(),ve("img",{key:0,src:((h=a.item)==null?void 0:h.imagem)||((b=(d=a.item)==null?void 0:d.atual)==null?void 0:b.imagem),alt:"",style:{"max-width":"33%"}},null,8,qt)):ie("",!0)]}),_:1})]),_:1}),t(kt,{modelValue:a.abaSelecionada,"onUpdate:modelValue":l[0]||(l[0]=n=>a.abaSelecionada=n),align:"justify",dense:"","indicator-color":"light-blue-4",class:"text-primary q-px-sm"},{default:r(()=>[t(st,{default:"",name:"tab1",icon:"info",label:"Detalhes",class:"cinza"}),t(st,{name:"tab2",icon:"history",label:"Compras",class:"cinza"}),t(st,{name:"tab3",icon:"compare_arrows",label:"Estoque",class:"cinza"})]),_:1},8,["modelValue"]),t(St,{modelValue:a.abaSelecionada,"onUpdate:modelValue":l[35]||(l[35]=n=>a.abaSelecionada=n),animated:"",class:"text-tertiary"},{default:r(()=>[t(nt,{name:"tab1",class:"q-px-sm"},{default:r(()=>[t(c,null,{default:r(()=>[t(e,null,{default:r(()=>[t(v,{modelValue:a.documentoItem.observacao,"onUpdate:modelValue":l[1]||(l[1]=n=>a.documentoItem.observacao=n),tipo:"textoArea",rotulo:"Observa\xE7\xE3o",dense:"",rows:"4"},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(v,{modelValue:a.documentoItem.referenciaFornecedor,"onUpdate:modelValue":l[2]||(l[2]=n=>a.documentoItem.referenciaFornecedor=n),rotulo:"Refer\xEAncia Fornecedor"},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(y,{modelValue:a.documentoItem.ncm,"onUpdate:modelValue":l[3]||(l[3]=n=>a.documentoItem.ncm=n),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(g,{modelValue:a.documentoItem.cfop,"onUpdate:modelValue":l[4]||(l[4]=n=>a.documentoItem.cfop=n),class:"col-12 col-md-6",outlined:""},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:r(()=>[t(e,null,{default:r(()=>[t(_,{text:"sub1 medium"},{default:r(()=>[B("Estoque")]),_:1})]),_:1})]),_:1}),t(c,{items:"center"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(v,{modelValue:a.documentoItem.idPlanoContaEstoque,"onUpdate:modelValue":l[5]||(l[5]=n=>a.documentoItem.idPlanoContaEstoque=n),opcoes:a.contaEstoque,tipo:"seletor",ajuda:"Plano de Conta de Estoque para Entrada de Mercadoria",dense:"",outlined:"",rotulo:"Conta Estoque"},null,8,["modelValue","opcoes"])]),_:1})]),_:1}),t(c,{mg:"lg-t"},{default:r(()=>[t(e,null,{default:r(()=>[t(_,{text:"sub1 medium"},{default:r(()=>[B("Impostos")]),_:1})]),_:1})]),_:1}),t(c,null,{default:r(()=>[t(Le,{label:"ICMS",modelValue:a.exibirIcms,"onUpdate:modelValue":l[6]||(l[6]=n=>a.exibirIcms=n)},null,8,["modelValue"])]),_:1}),a.exibirIcms?($(),J(c,{key:0,items:"center"},{default:r(()=>[t(e,{col:"12 sm6"},{default:r(()=>[t(v,{modelValue:a.documentoItem.modalidadeBaseCalculo,"onUpdate:modelValue":l[7]||(l[7]=n=>a.documentoItem.modalidadeBaseCalculo=n),opcoes:a.impostoIcmsModalidade,"somente-leitura":a.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"ICMS (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(e,{col:"12 sm6"},{default:r(()=>[t(v,{modelValue:a.documentoItem.codigoCst,"onUpdate:modelValue":l[8]||(l[8]=n=>a.documentoItem.codigoCst=n),opcoes:a.impostoCstIcms,"somente-leitura":a.somenteLeituraIcms,tipo:"seletor",outlined:"",rotulo:"CST ICMS"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.valorBaseIcms,"onUpdate:modelValue":l[9]||(l[9]=n=>a.documentoItem.valorBaseIcms=n),onBlur:l[10]||(l[10]=n=>s.calcularImpostos("valorBaseIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.percentualIcms,"onUpdate:modelValue":l[11]||(l[11]=n=>a.documentoItem.percentualIcms=n),onBlur:l[12]||(l[12]=n=>s.calcularImpostos("percentualIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS %"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.valorIcms,"onUpdate:modelValue":l[13]||(l[13]=n=>a.documentoItem.valorIcms=n),onBlur:l[14]||(l[14]=n=>s.calcularImpostos("valorIcms")),"somente-leitura":a.somenteLeituraIcms,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):ie("",!0),t(c,null,{default:r(()=>[t(Le,{label:"ICMS ST",modelValue:a.exibirIcmsSt,"onUpdate:modelValue":l[15]||(l[15]=n=>a.exibirIcmsSt=n)},null,8,["modelValue"])]),_:1}),a.exibirIcmsSt?($(),J(c,{key:1,items:"center"},{default:r(()=>[t(e,{col:"12 sm6"},{default:r(()=>[t(v,{modelValue:a.documentoItem.modalidadeBaseCalculoST,"onUpdate:modelValue":l[16]||(l[16]=n=>a.documentoItem.modalidadeBaseCalculoST=n),opcoes:a.impostoCstIcmsSt,"somente-leitura":a.somenteLeituraIcmsSt,tipo:"seletor",outlined:"",rotulo:"ICMS ST (Modalidade)"},null,8,["modelValue","opcoes","somente-leitura"])]),_:1}),t(e,{col:"12 sm6"},{default:r(()=>[t(v,{modelValue:a.documentoItem.percentualIVA,"onUpdate:modelValue":l[17]||(l[17]=n=>a.documentoItem.percentualIVA=n),onBlur:l[18]||(l[18]=n=>s.calcularImpostos("percentualIVA")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IVA (%)"},null,8,["modelValue"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.valorBaseIcmsSt,"onUpdate:modelValue":l[19]||(l[19]=n=>a.documentoItem.valorBaseIcmsSt=n),onBlur:l[20]||(l[20]=n=>s.calcularImpostos("valorBaseIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.percentualIcmsSt,"onUpdate:modelValue":l[21]||(l[21]=n=>a.documentoItem.percentualIcmsSt=n),onBlur:l[22]||(l[22]=n=>s.calcularImpostos("percentualIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"ICMS ST (%)"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.valorIcmsSt,"onUpdate:modelValue":l[23]||(l[23]=n=>a.documentoItem.valorIcmsSt=n),onBlur:l[24]||(l[24]=n=>s.calcularImpostos("valorIcmsSt")),"somente-leitura":a.somenteLeituraIcmsSt,tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor ICMS ST"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})):ie("",!0),t(c,null,{default:r(()=>[t(Le,{label:"IPI",modelValue:a.exibirIpi,"onUpdate:modelValue":l[25]||(l[25]=n=>a.exibirIpi=n)},null,8,["modelValue"])]),_:1}),a.exibirIpi?($(),J(c,{key:2,items:"center"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(v,{modelValue:a.documentoItem.codigoCstIpi,"onUpdate:modelValue":l[26]||(l[26]=n=>a.documentoItem.codigoCstIpi=n),opcoes:a.impostoCstIpi,tipo:"seletor",dense:"",outlined:"",rotulo:"CST IPI"},null,8,["modelValue","opcoes"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.valorBaseIpi,"onUpdate:modelValue":l[27]||(l[27]=n=>a.documentoItem.valorBaseIpi=n),onBlur:l[28]||(l[28]=n=>s.calcularImpostos("valorBaseIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Base IPI"},null,8,["modelValue"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.percentualIpi,"onUpdate:modelValue":l[29]||(l[29]=n=>a.documentoItem.percentualIpi=n),onBlur:l[30]||(l[30]=n=>s.calcularImpostos("percentualIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"IPI %"},null,8,["modelValue"])]),_:1}),t(e,{col:"12 sm4"},{default:r(()=>[t(v,{modelValue:a.documentoItem.valorIpi,"onUpdate:modelValue":l[31]||(l[31]=n=>a.documentoItem.valorIpi=n),onBlur:l[32]||(l[32]=n=>s.calcularImpostos("valorIpi")),tipo:"decimal",decimals:"2",zerosDireita:"2",dense:"",outlined:"",rotulo:"Valor IPI"},null,8,["modelValue"])]),_:1})]),_:1})):ie("",!0)]),_:1}),t(nt,{name:"tab2",class:"q-px-sm"},{default:r(()=>[a.exibirHistorico?($(),J(mt,{key:0,rows:a.historicoItem[a.documentoItem.idItem].fornecedores,columns:a.tabelaHistoricoItem.colunas,pagination:a.tabelaHistoricoItem.paginacao,"onUpdate:pagination":l[33]||(l[33]=n=>a.tabelaHistoricoItem.paginacao=n),"row-key":"index",class:"no-shadow text-left"},{body:r(n=>[t(ft,{props:n},{default:r(()=>[t(Oe,{key:"fornecedor",props:n},{default:r(()=>[B(Y(n.row.fornecedor),1)]),_:2},1032,["props"]),t(Oe,{key:"dataCompra",props:n},{default:r(()=>[n.row.dataCompra!==""?($(),ve("span",Bt,Y(o.$filters.data(n.row.dataCompra)),1)):ie("",!0)]),_:2},1032,["props"]),t(Oe,{key:"quantidade",props:n},{default:r(()=>[B(Y(n.row.quantidade),1)]),_:2},1032,["props"]),t(Oe,{key:"valorCusto",props:n},{default:r(()=>[B(Y(o.$filters.numero(n.row.valorCusto,2)),1)]),_:2},1032,["props"]),t(Oe,{key:"valorTotal",props:n},{default:r(()=>[B(Y(o.$filters.numero(n.row.valorTotal,2)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):ie("",!0)]),_:1}),t(nt,{name:"tab3",class:"q-px-sm"},{default:r(()=>[a.exibirEstoque?($(),J(mt,{key:0,rows:a.estoqueItem[a.documentoItem.idItem].estoques,columns:a.tabelaEstoqueItem.colunas,pagination:a.tabelaEstoqueItem.paginacao,"onUpdate:pagination":l[34]||(l[34]=n=>a.tabelaEstoqueItem.paginacao=n),"row-key":"index",class:"no-shadow text-left"},{body:r(n=>[t(ft,{props:n},{default:r(()=>[t(Oe,{key:"empresa",props:n},{default:r(()=>[B(Y(n.row.empresa),1)]),_:2},1032,["props"]),t(Oe,{key:"tipoEstoque",props:n},{default:r(()=>[B(Y(n.row.tipoEstoque),1)]),_:2},1032,["props"]),t(Oe,{key:"lote",props:n},{default:r(()=>[n.row.lote!==""?($(),ve("span",Ot,Y(n.row.lote),1)):ie("",!0)]),_:2},1032,["props"]),t(Oe,{key:"quantidade",props:n},{default:r(()=>[B(Y(n.row.quantidade),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):ie("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(Ye,{class:"bg-light q-pa-sm",bordered:""},{default:r(()=>[t(Ne,null,{default:r(()=>[t(ot),_e(t(ue,{onClick:s.fechar,label:"Cancelar",size:"md",flat:"","no-ripple":"",color:"tertiary",class:"q-mr-sm"},null,8,["onClick"]),[[Ve]]),t(ue,{onClick:s.salvar,label:"Salvar",color:"primary","no-ripple":"",unelevated:""},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Rt=rt(At,[["render",Ut]]);const Lt={components:{ModalEditarProdutoCompras:Rt,PromptItemV2:bt},data(){const o={ehOrcamento:!0,adicionar:{modal:{value:!1,name:""}},dataPrevistaEntrega:"",horaPrevistaEntrega:"",contatos:{},produtos:[],formasDePagamento:[],visivel:!1,somenteLeitura:!1,condicaoPagamentoRules:[async()=>{const l=this.compra.condicaoPagamento;return/^[\d/]*$/.test(l)}],formaPagamentoRules:[async()=>{const l=this.compra.formaDePagamento;return/^[^\d\s][a-zA-Z\s]*[^\d\s]$/.test(l)}],erroDesconto:!1,erroFrete:!1,erroSeguro:!1,erroOutrasDespesas:!1,exibeInfNota:!1,documentoNovo:!1,valorTotalPagamento:0,sku:0,operacao:"",alterarPrevisaoEntrega:!1};return this.limpaCampos(o),o},emits:["atualizar","dialogImprimirEtiquetas"],computed:{skus(){return this.compraItens.length>0?`${Number(this.compraItens.length)}`:"0"}},methods:{editarProduto(o){const l=this.produtos[o.idItem],p=this.compra;this.$refs.ModalEditarProdutoCompras.mostrar(o,l,p)},removerItem(o){this.compraItens=this.compraItens.filter(l=>l.id!==o.id),this.calcularTotais()},fecharEdicaoProduto(o){const l=this.compraItens.findIndex(p=>p.id===o.id);this.compraItens[l]=$utils.clonar(o),this.calcularTotaisItem(l)},async atualizar(){var p,w;this.compraOriginal=await $db.hibrido.le({table:"documento",id:this.compra.id}),this.compra=$utils.clonarV2(this.compraOriginal),$utils.verificarErro(!this.compra.id,"Compra n\xE3o encontrada"),this.compraItensOriginal=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:this.compra.id}})).sort((a,s)=>new Date(a.dataHoraEmissao||0)-new Date(s.dataHoraEmissao||0)),this.compraItens=$utils.clonarV2(this.compraItensOriginal),this.compraCondicoesDePagamentoOriginal=(await $db.hibrido.lista({table:"documentoCondicaoPagamento",where:{idDocumento:this.compra.id}})).sort((a,s)=>new Date(a.dataVencimento||0)-new Date(s.dataVencimento||0)),this.compraCondicoesDePagamento=$utils.clonarV2(this.compraCondicoesDePagamentoOriginal),this.compraTitulosOriginal=await $db.hibrido.lista({table:"financeiroTitulo",where:{documentoId:this.compra.id}}),this.compraTitulos=$utils.clonarV2(this.compraTitulosOriginal),this.compraMovimentacoesOriginal=await $db.hibrido.lista({table:"financeiroMovimentacao",where:{documentoId:this.compra.id}}),this.compraMovimentacoes=$utils.clonarV2(this.compraMovimentacoesOriginal),this.compraDocumentoXmlOriginal=await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:this.compra.id}}),this.compraDocumentoXml=$utils.clonarV2(this.compraDocumentoXmlOriginal),this.compra.totalComImposto=!0,this.compra.calcularTributacao=(p=this.compra.calcularTributacao)!=null?p:!0,this.compra.naoGerarFinanceiro=(w=this.compra.naoGerarFinanceiro)!=null?w:!1;const o=[this.compra.idEmpresa,this.compra.idContato,this.compra.idContatoComprador,this.compra.idContatoVendedor,this.compra.idContatoTransportadora].filter(Boolean);this.carregarImagensContatos(o);const l=this.compraItens.map(({idItem:a})=>a).filter(Boolean);if(this.carregarImagensItens(l),this.valorTotalPagamento===0)for(const a of this.compraCondicoesDePagamento)this.valorTotalPagamento=this.valorTotalPagamento+a.valor;this.compra.dataHoraPrevisto&&(this.dataPrevistaEntrega=this.compra.dataHoraPrevisto.slice(0,10),this.horaPrevistaEntrega=this.compra.dataHoraPrevisto.slice(11,16)),this.exibeInfNota=!0},async carregarContatos(o){const l=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:o}});for(const p of l)this.contatos[p.id]=p},async carregarImagensContatos(o){if(!!o.length){await $utils.dormir(200);try{await this.carregarContatos(o)}catch(l){console.error("Erro ao carregar imagens de contatos - ",l)}}},async carregarItens(o){const l=await $db.hibrido.lista({table:"item",columns:["id","descricao","imagem","valorCustoReposicao","marca","referencia","codigoItem"],whereIn:{id:o}});for(const p of l)this.produtos[p.id]=p},async carregarImagensItens(o){if(!!o.length){await $utils.dormir(200);try{await this.carregarItens(o)}catch(l){console.error("Erro ao ler imagens de itens - ",l)}}},async salvar_click(){await $tryLoading(async()=>{if(this.compra.idContato||(this.compra.idContato=$db.usuario.logado.id),this.dataPrevistaEntrega){const o=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;this.compra.dataHoraPrevisto=Ue.formatDate(o)}await this.salvar(),this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi salva com sucesso.":"O Pedido de Compra foi salvo com sucesso.")},{mensagem:"Salvando..."})},async excluir_click(){!await $q.dialogSimNao({title:"Excluir compra",message:`Deseja excluir ${this.compra.operacao==="Pedido de Compra"?`o ${this.compra.operacao}?`:`a ${this.compra.operacao}?`}`})||await $tryLoading(async()=>{this.visivel=!1,this.operacao=this.compra.operacao,this.compra={},this.compraCondicoesDePagamento=[],this.compraItens=[],this.compraMovimentacoes=[],this.compraTitulos=[],this.compraDocumentoXml=[],await this.salvar(),await this.fechar(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi excluida com sucesso.":"O Pedido de Compra foi excluido com sucesso.")},{mensagem:"Excluindo..."})},async criar(){await $tryLoading(async()=>{const o=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;if(!(o.length>0)){this.$q.notify({message:"N\xE3o h\xE1 empresa configurada",timeout:0,type:"negative",closeBtn:!0});return}let l=o[0];if(o.length>1){const a={ativo:!0,empresas:!0};if(l=await $g.promptContato.show({filtro:a,placeholder:"Selecione a empresa"}),!l){this.ocultarModal();return}}const p=(await $db.hibrido.lista({table:"empresa",where:{idContato:l.id}}))[0];if(!p){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}if(this.contatos[l.id]||await this.carregarContatos([l.id]),this.limpaCampos(this),this.compra={id:$utils.uuid(),tipo:"Compra",operacao:"Pedido de Compra",status:"Digita\xE7\xE3o",descricaoEmpresa:p.nome,numeroDocumentoEmpresa:p.numeroDocumentoNacional,descricaoContato:"",idContatoComprador:null,dataHoraEmissao:$utils.dataAtual(),tipoFrete:"CIF",tipoTransporte:null,idEmpresa:p.idContato,idContato:null,totalDesconto:0,totalPercentualDesconto:0,calcularTributacao:!0,totalComImposto:!0,naoGerarFinanceiro:!1,freteSeparado:!1,dataHoraPrevisto:null,valorBaseIcms:0,valorIcms:0,valorBaseIcmsSt:0,valorIcmsSt:0,valorOutrasDespesas:0},!await this.abrirModalFornecedor()){this.ocultarModal();return}this.documentoNovo=!0,this.exibeInfNota=!0,this.visivel=!0})},async validaCampos(){try{if($utils.verificarErro(!this.compra.descricaoContato,"N\xE3o \xE9 permitido finalizar a compra sem informar o fornecedor!"),$utils.verificarErro(!this.compraItens.length,"N\xE3o \xE9 permitido finalizar compra sem itens!"),!this.compra.naoGerarFinanceiro){const o=$utils.arredondar(this.compraCondicoesDePagamento.reduce((l,p)=>l+p.valor,0));$utils.verificarErro(!this.compra.formaDePagamento,"N\xE3o \xE9 permitido finalizar a compra sem informar a forma de pagamento!"),$utils.verificarErro(this.compraCondicoesDePagamento.length>0&&this.compra.totalDocumento!==o,"N\xE3o \xE9 permitido finalizar a compra se o valor total difere da soma das parcelas!"),$utils.verificarErro(this.compraCondicoesDePagamento.length===0,'Verifique se a op\xE7\xE3o "N\xE3o gerar financeiro" est\xE1 marcada, ou adicione as parcelas para finalizar a compra!')}return this.compra.operacao==="Nota de Entrada"&&($utils.verificarErro(!this.compra.notaNumero,"N\xE3o \xE9 permitido finalizar a compra sem informar o n\xFAmero da Nota de Entrada!"),$utils.verificarErro(!this.compra.notaSerie,"N\xE3o \xE9 permitido finalizar a compra sem informara s\xE9rie da Nota de Entrada!"),$utils.verificarErro(!this.compra.naturezaOperacao,"N\xE3o \xE9 permitido finalizar a compra sem informar natureza de opera\xE7\xE3o da Nota de Entrada!"),$utils.verificarErro(!this.compra.dataCompra,"N\xE3o \xE9 permitido finalizar a compra sem informar a data de compra da Nota de Entrada!"),$utils.verificarErro(!this.compra.chaveAcesso,"N\xE3o \xE9 permitido finalizar a compra sem informar a chave de acesso da Nota de Entrada!")),!0}catch(o){return $q.notifyError("Ocorreu um erro na valida\xE7\xE3o de campos",o),!1}},async finalizar_click(){if(!await this.validaCampos())return;let o=!1;this.compra.naoGerarFinanceiro||(o=await $q.dialogSimNao({title:"Gerar Financeiro",message:"Deseja gerar as provis\xF5es financeiras?"})),await $tryLoading(async()=>{this.compra.status="Finalizado",this.compra.dataHoraFinalizado=$utils.dataAtual(),this.compra.provisaoCompra=o?1:void 0,await this.finalizarItens(),o&&await this.gerarFinanceiro(),await this.salvar(),this.$emit("atualizar",{aba:"Finalizado"}),this.ocultarModal(),$q.notifyPositive(this.compra.operacao==="Nota de Entrada"?"A Nota de Entrada foi finalizada com sucesso!":"O Pedido de Compra foi finalizada com sucesso!"),o&&$q.notifyPositive("Provisionamento gerado com sucesso!")},{mensagem:"Finalizando Compra..."})},finalizarItens(){var s,m;let o=1,l=0,p=0,w=!1;const a=this.compra;if(a.subTotalProduto>0&&(a.tipoFrete==="FOB"&&a.freteSeparado===0&&(l=(a.valorFrete||0)+(a.valorSeguro||0)),o=((a.subTotalProduto||0)+(a.valorOutrasDespesas||0)-(a.totalDesconto||0)+(l||0))/(a.subTotalProduto||1)),p=this.compraItens.reduce((e,c)=>e+c.valorIcmsSt,p),p!==a.valorIcmsSt&&(w=!0),a.operacao==="Nota de Entrada")for(const e of this.compraItens)e.dataCompra=$utils.dataAtual(),w&&(e.valorIcmsSt=a.valorIcmsSt*((e==null?void 0:e.total)||0)/(a.subTotalProduto>0?a.subTotalProduto:1)),e.valorFreteRateado=a.valorFrete*(((e==null?void 0:e.total)||0)/(a.subTotalProduto||1)),e.valorSeguroRateado=a.valorSeguro*(((e==null?void 0:e.total)||0)/(a.subTotalProduto||1)),e.valorOutrasDespesasRateado=(a.valorOutrasDespesas||0)*(((e==null?void 0:e.total)||0)/(a.subTotalProduto||1)),e.descontoTotalRateado=(a.totalDesconto||0)*(((e==null?void 0:e.total)||0)/(a.subTotalProduto||1)),(e==null?void 0:e.valorIcmsSt)-(e==null?void 0:e.valorIcms)>0&&((e==null?void 0:e.valorIcmsSt)||0)-((e==null?void 0:e.valorIcms)||0),e.valorRealTotal=((e==null?void 0:e.total)||0)*o+((e==null?void 0:e.valorIpi)||0)+((e==null?void 0:e.valorIcms)||0),e.valorRealTotalImpostos=((e==null?void 0:e.total)||0)+e.valorFreteRateado+e.valorSeguroRateado+e.valorOutrasDespesasRateado-e.descontoTotalRateado+((e==null?void 0:e.valorIpi)||0)+((e==null?void 0:e.valorIcmsSt)||0),e.valorReal=e.valorRealTotalImpostos/((e==null?void 0:e.quantidade)||1),e.valorCustoReposicao=((s=this.produtos[e.idItem])==null?void 0:s.valorCustoReposicao)||0;if(a.operacao==="Pedido de Compra")for(const e of this.compraItens){w&&(e.valorIcmsSt=$utils.arredondar(a.valorIcmsSt*(e.total||0)/(a.subTotalProduto>0?a.subTotalProduto:1))),e.valorFreteRateado=$utils.arredondar((a.valorFrete||0)*(e.total||0)/(a.subTotalProduto||1),4),e.valorSeguroRateado=$utils.arredondar((a.valorSeguro||0)*(e.total||0)/(a.subTotalProduto||1),4),e.valorOutrasDespesasRateado=$utils.arredondar((a.valorOutrasDespesas||0)*(e.total||0)/(a.subTotalProduto||1),4),e.descontoTotalRateado=$utils.arredondar((a.totalDesconto||0)*(e.total||0)/(a.subTotalProduto||1),4);let c=0;e.valorIcmsSt-e.valorIcms>0&&(c=$utils.arredondar((e.valorIcmsSt||0)-(e.valorIcms||0),2)),e.valorRealTotal=$utils.arredondar((e.total||0)*o+(e.valorIpi||0)+(c>0?c:0),2),e.valorRealTotalImpostos=$utils.arredondar((e.total||0)+e.valorFreteRateado+e.valorSeguroRateado+e.valorOutrasDespesasRateado-e.descontoTotalRateado+(e.valorIpi||0)+(e.valorIcmsSt||0),4),e.valorReal=$utils.arredondar(e.valorRealTotalImpostos/(e.quantidade||1),4),e.valorCustoReposicao=$utils.arredondar(((m=this.produtos[e.idItem])==null?void 0:m.valorCustoReposicao)||0,2)}},async transformarEmNotaDeEntrada_click(){this.compra.operacao==="Pedido de Compra"&&await $tryLoading(async()=>{var p;const o=this.compraItens.map(({idItem:w})=>w).filter(Boolean),l=await $db.hibrido.lista({table:"itemFornecedor",whereIn:{idItem:o},whereFilter:{idContato:this.compra.idContato}});for(const w of this.compraItens)if(!l.some(({idItem:a})=>a===w.idItem)){const a={id:$utils.uuid(),idItem:w.idItem,idContato:this.compra.idContato,referencia:"",descricao:w.descricaoItem};await $db.hibrido.grava("itemFornecedor",{atual:a,original:{}})}for(const w of this.compraTitulos)w.formaDePagamento=(p=this.compra.formaDePagamento)!=null?p:"";this.compra.operacao="Nota de Entrada",this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",await this.salvar(),this.$emit("atualizar",{aba2:"Nota de Entrada",aba:"Digita\xE7\xE3o"}),this.ocultarModal(),$q.notifyPositive("Nota de Entrada gerada com sucesso!")},{mensagem:"Processando..."})},async mostrar({id:o}){this.visivel=!0;const l=$utils.logarIni("ComprasFicha");await $tryLoading(async()=>{this.compra.id=o,await this.atualizar()}),$utils.logarFim(l,1)},fechar(){this.compra.status==="Finalizado"?this.$emit("atualizar",{aba:"Finalizado"}):this.$emit("atualizar",{aba:"Digita\xE7\xE3o"}),this.ocultarModal(),this.dataPrevistaEntrega="",this.horaPrevistaEntrega="",this.produtos=[],this.limpaCampos(this),this.formasDePagamento=[],this.documentoNovo=!1,this.exibeInfNota=!1,this.valorTotalPagamento=0},ocultarModal(){this.visivel=!1},async abrirModalEmpresa(){const o={ativo:!0,empresas:!0},l=await $g.promptContato.show({filtro:o,placeholder:"Selecione"});if(!l)return;let p=(await $db.hibrido.lista({table:"empresa",where:{idContato:l.id}}))[0];if(!p){this.ocultarModal(),this.$q.notifyError("Erro ao selecionar empresa");return}this.contatos[l.id]||await this.carregarContatos([l.id]),this.compra.descricaoEmpresa=p.nome,this.compra.idEmpresa=p.idContato,this.compra.numeroDocumentoEmpresa=p.numeroDocumentoNacional,this.compra.InscricaoMunicipalEmpresa=p.InscricaoMunicipalEmpresa},async abrirModalComprador(){const o=await this.selecionarContato({placeholder:"Selecione o comprador",filtro:{ativo:!0,compradores:!0}});o.id&&(this.compra.idContatoComprador=o.id),this.contatos[o.id]||await this.carregarContatos([o.id])},async abrirModalFornecedor(){const o={ativo:!0},l=await $g.promptContato.show({filtro:o,placeholder:"Selecione o fornecedor"});if(!l)return l;const p=await $db.contatoTelefone.le({idContato:l.id}),w=await $db.contatoEndereco.le({idContato:l.id}),a=p.find(e=>e.tipoTelefone==="Principal"||e.tipoTelefone==="WhatsApp")||p[0]||null,s=w.find(e=>e.grupo==="Principal")||w[0]||null;let m;return s&&Object.keys(s).length>0&&(m=`${s.logradouro}, ${s.numero} ${s.complemento} - ${s.bairro} - ${s.municipio}/${s.uf}`),l.id&&(this.compra.idContato=l.id,this.compra.descricaoContato=l.nome,this.compra.numeroDocumentoContato=l.numeroDocumentoNacional,this.compra.emailContato=(l==null?void 0:l.email)||null,this.compra.regimeContato=(l==null?void 0:l.regime)||null,this.compra.telefoneContato=(a==null?void 0:a.telefone)||null,this.compra.descricaoContatoEndereco=m||null),this.contatos[l.id]||await this.carregarContatos([l.id]),l},async abrirModalVendedor(){const o=(await $db.contato.leFilhos(this.compra.idContato)).map(p=>p.id),l=await this.selecionarContato({placeholder:"Selecione o vendedor",filtro:{ativo:!0,usuarios:o}});l.id&&(this.compra.idContatoVendedor=l.id),this.contatos[l.id]||await this.carregarContatos([l.id])},async abrirModalTransportador(){const o=await this.selecionarContato({placeholder:"Selecione o transportadora",filtro:{ativo:!0,transportadoras:!0}});o.id&&(this.compra.idContatoTransportadora=o.id),this.contatos[o.id]||await this.carregarContatos([o.id])},async selecionarContato(o){const{placeholder:l,filtro:p}={placeholder:"Selecione o contato",filtro:{ativo:!0},...o},w=await $g.promptContato.show({filtro:p,placeholder:l});if(!w)throw new Error("Contato n\xE3o selecionado");return w},async adicionarItem(){let o={},l=[];for(const p of l)o[p.idItem]={item:await $db.hibrido.le({table:"item",id:p.idItem}),quantidade:p.quantidade};this.adicionar.modal.value=!0,this.adicionar.modal.name="Item"},async selecionarItens(o){var l,p;for(const w in o){let a=await $db.hibrido.lista({table:"estoqueSaldoProdutoEmpresa",whereFilter:{idEmpresa:this.compra.idEmpresa,tipoEstoque:"Dispon\xEDvel",idItem:w}});a=a[0];const s=await $db.configuracoes.porNome("vendas.checaestoque",this.compra.idEmpresa);Number((l=s.find(n=>n.id))==null?void 0:l.valor);const m=o[w].item||{},e=((p=(await $db.hibrido.lista({table:"itemFornecedor",whereFilter:{idItem:m.id}}))[0])==null?void 0:p.referencia)||null,c=o[w].quantidade||0,v=(m==null?void 0:m.valorCustoReposicao)||(a==null?void 0:a.valorCustoMedio)||0;let y=this.compraItens.find(n=>n.idItem===w);const g=(await $erp().cfop.where({cfop:5102}).toArray())[0],_=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral");if(y)y.quantidade=$utils.arredondar(c,4),y.quantidadeRealizado=$utils.arredondar(c,4),y.subTotal=$utils.arredondar(v,2),y.total=$utils.arredondar(c*v,2);else{const n={dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:"",descricaoItem:m.descricao,id:$utils.uuid(),idDocumento:this.compra.id,idItem:m.id,referencia:m.referencia,referenciaFornecedor:e,ncm:m.ncm||null,operacao:"Compra de Mercadoria",operacaoFator:1,idCfop:g==null?void 0:g.id,idPlanoContaEstoque:_==null?void 0:_.id,quantidade:$utils.arredondar(c,4),quantidadeRealizado:$utils.arredondar(c,4),status:"Digita\xE7\xE3o",tipoItem:m.tipo,subTotal:$utils.arredondar(v,2),total:$utils.arredondar(c*v,2),unidade:m.unidade,valorCustoMedio:(a==null?void 0:a.valorCustoMedio)||0,valorItem:v,valorOriginal:v,observacao:""};this.compraItens.push(n),await this.carregarItens([m.id])}this.compra.subTotal=0,this.compra.subTotalProduto=0;for(let n in this.compraItens)this.compra.subTotal+=this.compraItens[n].total,this.compra.subTotalProduto+=this.compraItens[n].total;this.compra.subTotal=$utils.arredondar(this.compra.subTotal,2),this.compra.totalDocumento=this.compra.subTotal}},formatXml(o,l="  "){let p="",w="";return o.split(/>\s*</).forEach(a=>{a.match(/^\/\w/)&&(w=w.substring(l.length)),p+=w+"<"+a+`>
`,a.match(/^<?\w[^>]*[^\/]$/)&&(w+=l)}),p.substring(1,p.length-3)},calcularTotaisItem(o,l){const p=$utils.clonar(this.compraItens[o]),w=p.valorOriginal||0,a=p.quantidade||0;let s=p.valorItem||0,m=p.descontoPercentualItem||0,e=p.descontoItem||0,c=p.subTotal||0,v=p.total||0;l==="descontoPercentualItem"&&((m<0||m>100)&&(m=0),e=s*m/100,c=s-e),l==="descontoItem"&&((e<0||e>s)&&(e=0),m=e/s*100,c=s-e),l==="valorItem"&&(s<w&&(s=w),e>s&&(e=0,m=0),m=e/s*100,c=s-e),l==="subTotal"&&((c<0||c>s)&&(c=s),e=s-c,m=e/s*100),v=a*c,p.valorItem=s,p.descontoItem=e,p.descontoPercentualItem=m,p.subTotal=c,p.total=v,this.compraItens[o]=p,this.calcularTotais("totalDesconto")},calcularTotais(o){const l=$utils.clonar(this.compra);let p=0,w=0,a=0,s=l.totalDesconto||0,m=l.totalPercentualDesconto||0,e=l.valorFrete||0,c=l.valorSeguro||0,v=l.valorOutrasDespesas||0,y=0,g=0,_=0,n=0,C=0;this.erroFrete=!1,this.erroSeguro=!1,this.erroOutrasDespesas=!1;for(const i of this.compraItens)p+=i.total,y+=i.valorBaseIcms||0,g+=i.valorIcms||0,_+=i.valorBaseIcmsSt||0,n+=i.valorIcmsSt||0,C+=i.valorIpi||0;o==="totalPercentualDesconto"&&(this.erroDesconto=!1,(m<0||m>100)&&(this.erroDesconto=!0),s=p*m/100),o==="totalDesconto"&&(this.erroDesconto=!1,(s<0||s>p)&&(this.erroDesconto=!0),m=s/p*100),e<0&&(this.erroFrete=!0),e=l.tipoFrete==="FOB"?e:0,c<0&&(this.erroSeguro=!0),c=l.tipoFrete==="FOB"?c:0,v<0&&(this.erroOutrasDespesas=!0),l.calcularTributacao||(y=0,g=0,_=0,n=0),l.totalComImposto||(C=0),w=p-s+e+c+v,a=w+C,l.valorBaseIcms=$utils.arredondar(y,2),l.valorIcms=$utils.arredondar(g),l.valorBaseIcmsSt=$utils.arredondar(_),l.valorIcmsSt=$utils.arredondar(n),l.valorIpi=$utils.arredondar(C),l.totalDesconto=$utils.arredondar(s),l.totalPercentualDesconto=$utils.arredondar(m),l.subTotalProduto=$utils.arredondar(p),l.totalProduto=$utils.arredondar(p)-$utils.arredondar(s),l.subTotal=$utils.arredondar(w),l.totalDocumento=$utils.arredondar(a),this.compra=l},limpaCampos(o){o.compra={},o.compraOriginal={},o.compraItens=[],o.compraItensOriginal=[],o.compraCondicoesDePagamento=[],o.compraCondicoesDePagamentoOriginal=[],o.compraTitulos=[],o.compraTitulosOriginal=[],o.compraMovimentacoes=[],o.compraMovimentacoesOriginal=[],o.compraDocumentoXml=[],o.compraDocumentoXmlOriginal=[]},async salvar(){this.compra.totalComImposto&&delete this.compra.totalComImposto;for(const o of this.compraItens)o.dataHoraFinalizado=this.compra.dataHoraFinalizado,o.status=this.compra.status;this.compra.id?await $db.hibrido.grava("documento",{atual:this.compra,original:this.compraOriginal}):this.compraOriginal.id&&await $db.hibrido.remove("documento",this.compraOriginal),await $db.hibrido.gravaLista("documentoItem",{atual:this.compraItens,original:this.compraItensOriginal}),await $db.hibrido.gravaLista("documentoCondicaoPagamento",{atual:this.compraCondicoesDePagamento,original:this.compraCondicoesDePagamentoOriginal}),await $db.hibrido.gravaLista("financeiroTitulo",{atual:this.compraTitulos,original:this.compraTitulosOriginal}),await $db.hibrido.gravaLista("financeiroMovimentacao",{atual:this.compraMovimentacoes,original:this.compraMovimentacoesOriginal}),await $db.hibrido.gravaLista("documentoXML",{atual:this.compraDocumentoXml,original:this.compraDocumentoXmlOriginal}),this.compra.totalComImposto=!0,this.calculaKardex()},async calculaKardex(){const o=$utils.logarIni("calculaKardex"),l=this.compraItens.map(({idItem:p})=>p).filter(Boolean);try{l.length&&await $utils.geeksApi({calculaKardex:{funcao:"9913E9FD-24A5-4C0A-9F1E-AACCDC7EAB9D",idsItem:l}})}catch(p){console.error(`Erro ao calcular Kardex
`,p)}$utils.logarFim(o,l.length)},async reabrir_click(){!await $q.dialogSimNao({title:"Reabertura",message:`Deseja reabrir o documento?<br/>${this.compra.naoGerarFinanceiro?"":"<strong>O Financeiro ser\xE1 apagado!</strong>"}`,html:!0})||await $tryLoading(async()=>{await this.retornarParaDigitacao(),await this.salvar(),await this.atualizar(),$q.notifyPositive("Documento reaberto para digita\xE7\xE3o!")},{mensagem:"Reabrindo..."})},async retornarParaDigitacao(){$utils.verificarErro(this.compra.status!=="Finalizado","N\xE3o \xE9 poss\xEDvel realizar esta opera\xE7\xE3o em documento n\xE3o finalizado.");const o=this.compraTitulos.filter(({dataPagamento:l})=>l);$utils.verificarErro(o.length,"N\xE3o \xE9 poss\xEDvel excluir o Financeiro. Parcelas provisionadas j\xE1 pagas!"),this.compra.dataHoraFinalizado="",this.compra.status="Digita\xE7\xE3o",this.compra.operacao==="Pedido de Compra"&&(this.compraTitulos=[],this.compraMovimentacoes=[])},async removerPagamento_click(o){try{this.compraCondicoesDePagamento=this.compraCondicoesDePagamento.filter(l=>l.id!==o.id),this.compraCondicoesDePagamento.sort((l,p)=>{let w=new Date(l.dataVencimento),a=new Date(p.dataVencimento);return w-a}),await this.atualizaValorTotalPagamento({condicao:o,acao:"remover"})}catch(l){console.log(l.message)}},async gerarCondicoesDePagamento_click(){var o;try{let l=this.compra.id,p=this.compra.condicaoPagamento,w=(o=this.compra.notaNumero)!=null?o:null;this.compra.naoGerarFinanceiro||await this.gerarParcelamento(l,p,w),this.compra.naoGerarFinanceiro&&(this.compraCondicoesDePagamento=[])}catch(l){console.log(l.message)}},async gerarParcelamento(o,l,p){var g;this.compraCondicoesDePagamento=[];const w=$utils.clonar(this.compra),a=l.split("/").length,s=!!(w!=null&&w.dataCompra)&&(w==null?void 0:w.dataCompra)!==""?w.dataCompra:!!(w!=null&&w.dataHoraPrevisto)&&(w==null?void 0:w.dataHoraPrevisto)!==""?w.dataHoraPrevisto:!!this.dataPrevistaEntrega&&this.dataPrevistaEntrega!==""?new Date(this.dataPrevistaEntrega):$utils.dataAtual(),m=(w==null?void 0:w.freteSeparado)||0;let e=$utils.arredondar(w==null?void 0:w.totalDocumento,2);const c=((w==null?void 0:w.valorFrete)||0)+((w==null?void 0:w.valorSeguro)||0);if(m&&(w==null?void 0:w.tipoFrete)==="FOB"&&c>0){let _={id:$utils.uuid(),idDocumento:w==null?void 0:w.id,dataVencimento:s,valor:c,observacao:"Valor Frete + Seguro",freteSeparado:!0};this.compraCondicoesDePagamento.push(_),e-=c}let v=0,y=e/a;for(let _ in l.split("/")){let n=!!(w!=null&&w.dataCompra)&&(w==null?void 0:w.dataCompra)!==""?w.dataCompra:!!(w!=null&&w.dataHoraPrevisto)&&(w==null?void 0:w.dataHoraPrevisto)!==""?w.dataHoraPrevisto:!!this.dataPrevistaEntrega&&this.dataPrevistaEntrega!==""?new Date(this.dataPrevistaEntrega):$utils.dataAtual();typeof n=="string"&&(n=(g=new Date(n))!=null?g:$utils.dataAtual()),n.setDate(n.getDate()+parseInt(l.split("/")[_])||0);let C={id:$utils.uuid(),idDocumento:w==null?void 0:w.id,dataVencimento:Ue.formatDate(n),valor:y,observacao:""};this.compraCondicoesDePagamento.push(C),v+=y||0}e!==v&&(this.compraCondicoesDePagamento[0].valor+=(e||0)-(v||0)),this.valorTotalPagamento=m&&(w==null?void 0:w.tipoFrete)==="FOB"?e+c:e},async gerarFinanceiro(){var m,e;const o=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.comprageral"),l=[];for(const c of this.compraItens){if(c.idPlanoContaEstoque===o.id)continue;const v=(c.total||0)-(c.descontoTotalRateado||0),y=l.findIndex(({idPlanoContaEstoque:g})=>g===c.idPlanoContaEstoque);y!==-1?l[y].valor+=v:l.push({idPlanoContaEstoque:c.idPlanoContaEstoque,idPlanoContaDestino:"",valor:v,porcentagem:0})}for(const c of l)c.valor=$utils.arredondar(c.valor),c.porcentagem=$utils.arredondar(c.valor/this.compra.totalDocumento,4);const p=await $db.financeiroPlanoConta.lePorConfig("financeiro.planocontas.freteaquisicao"),w=this.compraTitulos.filter(({dataPagamento:c})=>c);$utils.verificarErro(w.length,"N\xE3o \xE9 poss\xEDvel regerar o Financeiro. Parcelas provisionadas j\xE1 pagas!");const a=Ue.formatDate(new Date().setHours(0,0,0,0));this.compraTitulos=[];for(const c in this.compraCondicoesDePagamento){const v=this.compraCondicoesDePagamento[c],y=[v.observacao,this.compra.codigoDocumento?`Pedido de Compra: ${this.compra.codigoDocumento}`:"",this.compra.notaNumero?`Nota nro: ${this.compra.notaNumero}`:""].filter(Boolean).join(" | "),g={id:$utils.uuid(),dataEmissao:a,dataCompetencia:a,dataVencimento:Ue.formatDate(new Date(v.dataVencimento).setHours(0,0,0,0)),dataVencimentoOriginal:Ue.formatDate(new Date(v.dataVencimento).setHours(0,0,0,0)),valor:$utils.arredondar(v.valor,2),tipoJuros:"dia",valorMulta:0,percentualJuros:0,documentoTipo:this.compra.operacao,parcela:`${Number(c)+1}/${this.compraCondicoesDePagamento.length}`,descricao:this.compra.operacao,observacao:y,formaDePagamento:this.compra.operacao==="Pedido de Compra"?`Provis\xE3o Pedido - ${(m=this.compra.formaDePagamento)!=null?m:""}`:(e=this.compra.formaDePagamento)!=null?e:"",receberPagar:0,valorOriginal:$utils.arredondar(v.valor,2),documentoVinculado:1,valorTotal:$utils.arredondar(v.valor,2),valorARealizar:$utils.arredondar(v.valor,2),valorDesconto:0,percentualDesconto:0,idEmpresa:this.compra.idEmpresa,idContato:(v==null?void 0:v.freteSeparado)&&!!this.compra.idContatoTransportadora?this.compra.idContatoTransportadora:this.compra.idContato,idFinanceiroPlanoConta:v.observacao==="Valor Frete + Seguro"?p.id:o==null?void 0:o.id,documentoId:this.compra.id,idFinanceiroMovimentacaoAgrupamentoAutomatico:$utils.uuid(),cobrancaAtivo:1};this.compraTitulos.push(g)}const s=$utils.uuid();this.compraMovimentacoes=[];for(const c of l){const v={id:$utils.uuid(),idFinanceiroMovimentacaoN:s,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:o.id,dataEmissao:a,valorCredito:this.compra.totalDocumento*c.porcentagem,valorDebito:0,descricao:o.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:a,dataVencimento:a,dataMovimento:a,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(v);const y=await $db.financeiroPlanoConta.leCache({id:c.idPlanoContaEstoque}),g={id:$utils.uuid(),idFinanceiroMovimentacaoN:s,idEmpresa:this.compra.idEmpresa,idFinanceiroPlanoConta:c.idPlanoContaEstoque,dataEmissao:a,valorCredito:0,valorDebito:this.compra.totalDocumento*c.porcentagem,descricao:y.descricao.trim(),observacao:"",automatico:0,liquidando:0,dataCompetencia:a,dataVencimento:a,dataMovimento:a,documentoTipo:this.compra.operacao,documentoId:this.compra.id};this.compraMovimentacoes.push(g)}},async atualizaValorTotalPagamento({condicao:o,acao:l}){!o||l==="remover"&&(this.valorTotalPagamento=this.valorTotalPagamento-o.valor)},async ajustarPrevisaoEntrega(o){o==="alterar"&&(this.alterarPrevisaoEntrega=!0),o==="salvar"&&(await $tryLoading(async()=>{const l=`${this.dataPrevistaEntrega} ${this.horaPrevistaEntrega||"00:00:00"}`;$utils.verificarErro(!this.dataPrevistaEntrega&&this.horaPrevistaEntrega,"\xC9 necess\xE1rio preencher uma data em conjunto com a hora."),Ue.formatDate(l)!==Ue.formatDate(this.compra.dataHoraPrevisto)?(this.compra.dataHoraPrevisto=Ue.formatDate(l)||"",await this.salvar(),await this.atualizar(),$q.notifyPositive("A previs\xE3o foi salva com sucesso")):$q.notifyPositive("N\xE3o h\xE1 dados alterados.")}),this.alterarPrevisaoEntrega=!1)},dialogImprimirEtiquetas(o,l){this.$emit("dialogImprimirEtiquetas",{acao:o,item:l})}}},Mt={class:"row items-center"},jt={class:"col-auto"},$t={class:"col-auto"},Ht=he("span",{class:"q-px-xs"},"|",-1);function Zt(o,l,p,w,a,s){const m=fe("g-label"),e=fe("g-col"),c=fe("Badge"),v=fe("BadgeCopiarUid"),y=fe("g-row"),g=fe("avatar"),_=fe("campo"),n=fe("ModalEditarProdutoCompras"),C=fe("PromptItemV2");return $(),ve(Se,null,[t(Xe,{modelValue:o.visivel,"onUpdate:modelValue":l[33]||(l[33]=i=>o.visivel=i),persistent:"",maximized:"",onKeyup:vt(s.fechar,["esc"])},{default:r(()=>[t(je,{view:"hHh lpR lFr",container:"",class:"bg-light"},{default:r(()=>[t($e,null,{default:r(()=>[t(Ne,null,{default:r(()=>[t(ue,{onClick:s.fechar,icon:"arrow_back",flat:"",round:"",dense:""},null,8,["onClick"]),t(Re,null,{default:r(()=>[B(Y(o.compra.operacao),1)]),_:1}),_e(t(ue,{onClick:s.salvar_click,label:"Salvar",color:"white","text-color":"primary",unelevated:"",class:"q-ml-sm"},null,8,["onClick"]),[[Pe,o.compra.status==="Digita\xE7\xE3o"]])]),_:1})]),_:1}),t(He,{class:"u-container"},{default:r(()=>[t(Ze,null,{default:r(()=>[t(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:r(()=>[t(e,{col:"12 sm12 md6"},{default:r(()=>[t(y,{items:"center",justify:"end",class:"hideondesktop"},{default:r(()=>[t(e,{col:"xs-shrink",order:"1 sm0"},{default:r(()=>[_e(t(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${o.$filters.hora(o.compra.dataHoraEmissao)}`},{default:r(()=>[B(Y(o.$filters.data(o.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[Pe,o.compra.dataHoraEmissao]])]),_:1}),t(e,{col:"xs-shrink",order:"1 sm0"},{default:r(()=>[_e(t(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Finalizado \xE1s ${o.$filters.hora(o.compra.dataHoraFinalizado)}`},{default:r(()=>[B(Y(o.$filters.data(o.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[Pe,o.compra.dataHoraFinalizado]])]),_:1}),t(e,{col:"xs12 sm-shrink",order:"0 sm1",text:"right"},{default:r(()=>[t(c,{cor:o.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:o.compra.status!=="Digita\xE7\xE3o",class:"q-ml-sm"},{default:r(()=>[B(Y(o.compra.status),1)]),_:1},8,["cor","escuro"]),t(v,{id:o.compra.id,numero:o.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"])]),_:1})]),_:1}),t(y,null,{default:r(()=>[t(e,{col:"12 sm6"},{default:r(()=>[t(y,null,{default:r(()=>[t(e,{col:"xs-shrink"},{default:r(()=>{var i,h;return[t(g,{imagem:(i=o.contatos[o.compra.idContato])==null?void 0:i.imagem,rotulo:(h=o.contatos[o.compra.idContato])==null?void 0:h.apelido,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:1}),t(e,{col:"xs"},{default:r(()=>{var i;return[t(_,{modelValue:(i=o.contatos[o.compra.idContato])==null?void 0:i.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){s.abrirModalFornecedor()}}],disable:o.compra.status!=="Digita\xE7\xE3o",rotulo:"Fornecedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1})]),_:1})]),_:1}),t(e,{col:"12 sm6"},{default:r(()=>{var i;return[t(_,{modelValue:(i=o.contatos[o.compra.idContatoVendedor])==null?void 0:i.apelido,"somente-leitura":"",disable:o.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalVendedor()}}],rotulo:"Vendedor",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(e,{col:"12 sm6"},{default:r(()=>{var i;return[t(_,{modelValue:(i=o.contatos[o.compra.idEmpresa])==null?void 0:i.apelido,"somente-leitura":"",after:[{icon:"edit",handler(){s.abrirModalEmpresa()}}],disable:o.compra.status!=="Digita\xE7\xE3o",rotulo:"Empresa",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","after","disable"])]}),_:1}),t(e,{col:"12 sm6"},{default:r(()=>{var i;return[t(_,{modelValue:(i=o.contatos[o.compra.idContatoComprador])==null?void 0:i.apelido,"somente-leitura":"",disable:o.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalComprador()}}],rotulo:"Comprador",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(e,{col:"12 sm6"},{default:r(()=>{var i;return[t(_,{modelValue:(i=o.contatos[o.compra.idContatoTransportadora])==null?void 0:i.apelido,"somente-leitura":"",disable:o.compra.status!=="Digita\xE7\xE3o",after:[{icon:"edit",handler(){s.abrirModalTransportador()}}],rotulo:"Transportadora",dense:"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable","after"])]}),_:1}),t(e,{col:"12 sm6"},{default:r(()=>[t(y,null,{default:r(()=>[t(e,{col:"7"},{default:r(()=>[t(pt,{modelValue:o.dataPrevistaEntrega,"onUpdate:modelValue":l[0]||(l[0]=i=>o.dataPrevistaEntrega=i),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"date",label:"Data Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1}),t(e,{col:"5"},{default:r(()=>[t(pt,{modelValue:o.horaPrevistaEntrega,"onUpdate:modelValue":l[1]||(l[1]=i=>o.horaPrevistaEntrega=i),disable:!this.alterarPrevisaoEntrega&&this.compra.status!=="Digita\xE7\xE3o",type:"time",label:"Hora Prevista de Entrega",clearable:"",dense:"","stack-label":"",borderless:"",class:"q-mb-sm"},null,8,["modelValue","disable"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(e,{col:"12 sm12 md6"},{default:r(()=>[t(y,{justify:"end",items:"center",text:"right",class:"hideonmobile"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(y,{justify:"end",items:"center"},{default:r(()=>[t(c,{cor:o.compra.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:o.compra.status!=="Digita\xE7\xE3o"},{default:r(()=>[B(Y(o.compra.status),1)]),_:1},8,["cor","escuro"]),t(v,{id:o.compra.id,numero:o.compra.numero,cor:"positive",class:"q-ml-sm"},null,8,["id","numero"]),t(ue,{color:"tertiary",flat:"",icon:"more_vert",round:""},{default:r(()=>[t(Me,null,{default:r(()=>[_e(($(),J(xe,{link:"",separator:""},{default:r(()=>[o.alterarPrevisaoEntrega?($(),J(be,{key:1,clickable:"",onClick:l[3]||(l[3]=i=>s.ajustarPrevisaoEntrega("salvar"))},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"local_shipping"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B("Salvar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:1})):($(),J(be,{key:0,disable:o.compra.status==="Digita\xE7\xE3o",clickable:"",onClick:l[2]||(l[2]=i=>s.ajustarPrevisaoEntrega("alterar"))},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"local_shipping"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B("Alterar Previs\xE3o de Entrega")]),_:1})]),_:1})]),_:1},8,["disable"])),t(be,{onClick:l[4]||(l[4]=i=>s.dialogImprimirEtiquetas("adicionar",o.compra)),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Adicionar Etiquetas ")]),_:1})]),_:1})]),_:1}),t(be,{onClick:l[5]||(l[5]=i=>s.dialogImprimirEtiquetas("impressao",o.compra)),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:1})]),_:1})),[[Ve]])]),_:1})]),_:1})]),_:1})]),_:1}),t(e,{col:"shrink"},{default:r(()=>[_e(t(m,{text:"caption",icon:"mdi-calendar-today sm tertiary left",tip:`Emitido \xE1s ${o.$filters.hora(o.compra.dataHoraEmissao)}`},{default:r(()=>[B(Y(o.$filters.data(o.compra.dataHoraEmissao)),1)]),_:1},8,["tip"]),[[Pe,o.compra.dataHoraEmissao]])]),_:1}),t(e,{col:"shrink"},{default:r(()=>[_e(t(m,{text:"caption",icon:"mdi-calendar sm tertiary left",tip:`Finalizado \xE1s ${o.$filters.hora(o.compra.dataHoraFinalizado)}`},{default:r(()=>[B(Y(o.$filters.data(o.compra.dataHoraFinalizado)),1)]),_:1},8,["tip"]),[[Pe,o.compra.dataHoraFinalizado]])]),_:1})]),_:1}),t(y,null,{default:r(()=>[t(e,null,{default:r(()=>[t(_,{modelValue:o.compra.observacao,"onUpdate:modelValue":l[6]||(l[6]=i=>o.compra.observacao=i),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",tipo:"textoArea",rotulo:"Observa\xE7\xE3o",rows:"4"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1}),t(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:r(()=>[o.exibeInfNota?($(),J(Et,{key:0,"default-opened":o.compra.notaNumero>0||o.documentoNovo,"header-class":"q-px-sm",class:"notaEntrada g-col col-12"},{header:r(()=>[t(K,null,{default:r(()=>[t(m,{text:"sub1 medium",icon:"mdi-file-replace sm tertiary left"},{default:r(()=>[B("Nota de Entrada")]),_:1})]),_:1})]),default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(y,null,{default:r(()=>[t(e,{col:"12 sm6 md3"},{default:r(()=>[t(_,{modelValue:o.compra.notaNumero,"onUpdate:modelValue":l[7]||(l[7]=i=>o.compra.notaNumero=i),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Numero",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm6 md3"},{default:r(()=>[t(_,{modelValue:o.compra.notaSerie,"onUpdate:modelValue":l[8]||(l[8]=i=>o.compra.notaSerie=i),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Serie",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm6 md3"},{default:r(()=>[t(_,{modelValue:o.compra.naturezaOperacao,"onUpdate:modelValue":l[9]||(l[9]=i=>o.compra.naturezaOperacao=i),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Natureza da Opera\xE7\xE3o",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12 sm6 md3"},{default:r(()=>[t(_,{modelValue:o.compra.dataCompra,"onUpdate:modelValue":l[10]||(l[10]=i=>o.compra.dataCompra=i),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Data compra",tipo:"data",dense:""},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"12"},{default:r(()=>[t(_,{modelValue:o.compra.chaveAcesso,"onUpdate:modelValue":l[11]||(l[11]=i=>o.compra.chaveAcesso=i),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Chave",dense:""},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1})]),_:1})]),_:1},8,["default-opened"])):ie("",!0)]),_:1}),t(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(m,{text:"sub1 medium",icon:"shopping_cart sm tertiary left"},{default:r(()=>[B("Carrinho "),t(ue,{onClick:l[12]||(l[12]=i=>s.adicionarItem()),disable:o.compra.status!=="Digita\xE7\xE3o",icon:"add",label:"Produto",size:"md",color:"primary",flat:"",dense:"",class:"float-right q-px-sm"},null,8,["disable"])]),_:1})]),_:1}),($(!0),ve(Se,null,Te(o.compraItens,(i,h)=>($(),J(e,{col:"12",key:h},{default:r(()=>[t(xe,{class:"full-width"},{default:r(()=>[t(be,{class:"q-px-none"},{default:r(()=>{var d;return[t(K,{avatar:"",class:"col-auto"},{default:r(()=>{var b;return[t(g,{imagem:(b=o.produtos[i.idItem])==null?void 0:b.imagem,rotulo:i.descricaoItem,tamanho:"50"},null,8,["imagem","rotulo"])]}),_:2},1024),t(K,{class:"q-px-none"},{default:r(()=>[t(ne,null,{default:r(()=>[B(Y(i.descricaoItem),1)]),_:2},1024),t(ne,{caption:""},{default:r(()=>{var b,S;return[B(Y((S=(b=o.produtos[i.idItem])==null?void 0:b.marca)!=null?S:""),1)]}),_:2},1024)]),_:2},1024),_e(t(K,{avatar:""},{default:r(()=>[t(c,{denso:""},{default:r(()=>{var b,S;return[B(Y((S=(b=o.produtos[i.idItem])==null?void 0:b.referencia)!=null?S:""),1)]}),_:2},1024)]),_:2},1536),[[Pe,(d=o.produtos[i.idItem])==null?void 0:d.referencia]]),t(K,{avatar:""},{default:r(()=>[he("div",Mt,[he("div",jt,[t(ue,{color:"primary",dense:"",flat:"",icon:"edit",round:"",onClick:b=>s.editarProduto(i),disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),he("div",$t,[t(ue,{color:"tertiary",dense:"",flat:"",icon:"delete",round:"",onClick:b=>s.removerItem(i),disable:o.compra.status!=="Digita\xE7\xE3o"},{default:r(()=>[t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("Remover Item")]),_:1})]),_:2},1032,["onClick","disable"])])])]),_:2},1024)]}),_:2},1024)]),_:2},1024),t(y,null,{default:r(()=>[t(e,{col:"4 md"},{default:r(()=>[t(_,{dense:"",align:"left",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Valor do produto",modelValue:i.valorItem,"onUpdate:modelValue":d=>i.valorItem=d,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",onBlur:d=>s.calcularTotaisItem(h,"valorItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024),t(e,{col:"4 md"},{default:r(()=>[t(y,{items:"center"},{default:r(()=>[t(e,{col:"shrink"},{default:r(()=>[t(pe,{name:"mdi-minus",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{dense:"",opcoes:{maximumValue:100},tipo:"decimal",decimals:"2",rotulo:"Desconto percentual",modelValue:i.descontoPercentualItem,"onUpdate:modelValue":d=>i.descontoPercentualItem=d,outlined:"",suffix:"%","somente-leitura":o.compra.status!=="Digita\xE7\xE3o",onBlur:d=>s.calcularTotaisItem(h,"descontoPercentualItem")},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e,{col:"4 md"},{default:r(()=>[t(_,{dense:"",tipo:"decimal",modelValue:i.descontoItem,"onUpdate:modelValue":d=>i.descontoItem=d,decimals:"4",zerosDireita:"2",outlined:"",rotulo:"Desconto em reais",prefix:"R$",onBlur:d=>s.calcularTotaisItem(h,"descontoItem"),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024),t(e,{col:"6 md"},{default:r(()=>[t(y,{items:"center"},{default:r(()=>[t(e,{col:"shrink",class:"hideonmobile"},{default:r(()=>[t(pe,{name:"mdi-equal",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{dense:"",outlined:"",opcoes:{maximumValue:10,minimumValue:0},rotulo:"Subtotal",tipo:"decimal",decimals:"4",zerosDireita:"2",modelValue:i.subTotal,"onUpdate:modelValue":d=>i.subTotal=d,onBlur:d=>s.calcularTotaisItem(h,"subTotal"),"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e,{col:"6 md"},{default:r(()=>[t(y,{items:"center"},{default:r(()=>[t(e,{col:"shrink"},{default:r(()=>[t(pe,{name:"mdi-close",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{dense:"",max:"100",min:"0",outlined:"",modelValue:i.quantidade,"onUpdate:modelValue":d=>i.quantidade=d,decimals:"4",zerosDireita:"0",tipo:"quantidade",onBlur:d=>s.calcularTotaisItem(h),disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","onBlur","disable"]),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("Quantidade")]),_:1})]),_:2},1024)]),_:2},1024)]),_:2},1024),t(e,{col:"12 md"},{default:r(()=>[t(y,{items:"center"},{default:r(()=>[t(e,{col:"shrink",class:"hideonmobile"},{default:r(()=>[t(pe,{name:"mdi-equal",color:"primary"})]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{dense:"",tipo:"decimal",decimals:"2",rotulo:"Total","somente-leitura":"",modelValue:i.total,"onUpdate:modelValue":d=>i.total=d,outlined:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),t(e,{col:"12"},{default:r(()=>[t(y,{gutter:"md",mg:"md-y",justify:"end",items:"center",bg:"bg-light","rounded-borders":"","min-height":"49px"},{default:r(()=>[t(e,{col:"3 sm2 md-shrink",text:"bold"},{default:r(()=>[B(" Calcular ")]),_:1}),t(e,{col:"9 sm10 md"},{default:r(()=>[t(Le,{modelValue:o.compra.calcularTributacao,"onUpdate:modelValue":[l[13]||(l[13]=i=>o.compra.calcularTributacao=i),s.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"6 md-shrink"},{default:r(()=>[B(" Base ICMS ")]),_:1}),t(e,{col:"6 md",text:"right"},{default:r(()=>[t(_,{dense:"",outlined:"",decimals:"2",zerosDireita:"2",tipo:"decimal",modelValue:o.compra.valorBaseIcms,"onUpdate:modelValue":l[14]||(l[14]=i=>o.compra.valorBaseIcms=i),"somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"6 md-shrink"},{default:r(()=>[B(" Valor ICMS ")]),_:1}),t(e,{col:"6 md",text:"right"},{default:r(()=>[t(_,{dense:"",outlined:"",modelValue:o.compra.valorIcms,"onUpdate:modelValue":l[15]||(l[15]=i=>o.compra.valorIcms=i),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"6 md-shrink"},{default:r(()=>[B(" Base ICMS ST ")]),_:1}),t(e,{col:"6 md",text:"right"},{default:r(()=>[t(_,{dense:"",outlined:"",modelValue:o.compra.valorBaseIcmsSt,"onUpdate:modelValue":l[16]||(l[16]=i=>o.compra.valorBaseIcmsSt=i),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1}),t(e,{col:"6 md-shrink"},{default:r(()=>[B(" ICMS ST ")]),_:1}),t(e,{col:"6 md",text:"right"},{default:r(()=>[t(_,{dense:"",outlined:"",modelValue:o.compra.valorIcmsSt,"onUpdate:modelValue":l[17]||(l[17]=i=>o.compra.valorIcmsSt=i),decimals:"2",zerosDireita:"2",tipo:"decimal","somente-leitura":!!o.compra.calcularTributacao||o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","somente-leitura"])]),_:1})]),_:1}),t(y,{mg:"lg-t",justify:"end"},{default:r(()=>[t(e,{col:"xs12 sm8 md4"},{default:r(()=>[t(y,{items:"center"},{default:r(()=>[t(e,{col:"3",text:"bold"},{default:r(()=>[B(" Subtotal ")]),_:1}),t(e,{col:"xs",text:"right bold"},{default:r(()=>[B(Y(o.$filters.numero(o.compra.subTotalProduto,2)),1)]),_:1})]),_:1}),t(lt,{class:"q-mb-md q-mt-xs"}),t(y,{items:"center"},{default:r(()=>[t(e,{col:"xs3"},{default:r(()=>[B(" Desconto ")]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{tipo:"decimal",decimals:"2",modelValue:o.compra.totalPercentualDesconto,"onUpdate:modelValue":l[18]||(l[18]=i=>o.compra.totalPercentualDesconto=i),onBlur:l[19]||(l[19]=i=>s.calcularTotais("totalPercentualDesconto")),suffix:"%",error:o.erroDesconto,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{tipo:"decimal",decimals:"2",modelValue:o.compra.totalDesconto,"onUpdate:modelValue":l[20]||(l[20]=i=>o.compra.totalDesconto=i),onBlur:l[21]||(l[21]=i=>s.calcularTotais("totalDesconto")),error:o.erroDesconto,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","error","somente-leitura"])]),_:1})]),_:1}),t(y,{items:"center"},{default:r(()=>[t(e,{col:"xs3"},{default:r(()=>[B(" Frete ")]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(ht,{class:"q-mr-md",label:"CIF",val:"CIF",modelValue:o.compra.tipoFrete,"onUpdate:modelValue":[l[22]||(l[22]=i=>o.compra.tipoFrete=i),s.calcularTotais],dense:"",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"]),t(ht,{label:"FOB",val:"FOB",modelValue:o.compra.tipoFrete,"onUpdate:modelValue":[l[23]||(l[23]=i=>o.compra.tipoFrete=i),s.calcularTotais],dense:"",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{tipo:"decimal",decimals:"2",modelValue:o.compra.valorFrete,"onUpdate:modelValue":l[24]||(l[24]=i=>o.compra.valorFrete=i),onBlur:s.calcularTotais,error:o.erroFrete,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(y,{items:"center"},{default:r(()=>[t(e,{col:"xs3"},{default:r(()=>[B(" Seguro ")]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{tipo:"decimal",decimals:"2",modelValue:o.compra.valorSeguro,"onUpdate:modelValue":l[25]||(l[25]=i=>o.compra.valorSeguro=i),onBlur:s.calcularTotais,error:o.erroSeguro,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(y,{items:"center"},{default:r(()=>[t(e,{col:"xs5"},{default:r(()=>[B(" Outras despesas ")]),_:1}),t(e,{col:"xs"},{default:r(()=>[t(_,{tipo:"decimal",decimals:"2",modelValue:o.compra.valorOutrasDespesas,"onUpdate:modelValue":l[26]||(l[26]=i=>o.compra.valorOutrasDespesas=i),onBlur:s.calcularTotais,error:o.erroOutrasDespesas,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"},null,8,["modelValue","onBlur","error","somente-leitura"])]),_:1})]),_:1}),t(lt,{class:"q-mt-md q-mb-xs"}),t(y,{items:"center"},{default:r(()=>[t(e,{col:"xs4",text:"bold"},{default:r(()=>[B(" Total ")]),_:1}),t(e,{col:"xs",text:"right bold"},{default:r(()=>[B(Y(o.$filters.numero(o.compra.totalProduto,2)),1)]),_:1})]),_:1}),o.compra.totalComImposto?($(),J(y,{key:0,items:"center"},{default:r(()=>[t(e,{col:"xs4",text:"bold"},{default:r(()=>[B(" Total IPI ")]),_:1}),t(e,{col:"xs",text:"right bold"},{default:r(()=>[B(Y(o.$filters.numero(o.compra.valorIpi,2)),1)]),_:1})]),_:1})):ie("",!0),t(y,{items:"center"},{default:r(()=>[t(e,{col:"xs5",text:"bold"},{default:r(()=>[B(" Total c/ Impostos ")]),_:1}),t(e,{col:"xs-shrink"},{default:r(()=>[t(Le,{disable:o.compra.status!=="Digita\xE7\xE3o",modelValue:o.compra.totalComImposto,"onUpdate:modelValue":[l[27]||(l[27]=i=>o.compra.totalComImposto=i),s.calcularTotais],"checked-icon":"check",color:"green","unchecked-icon":"clear"},null,8,["disable","modelValue","onUpdate:modelValue"])]),_:1}),t(e,{col:"xs",text:"right bold"},{default:r(()=>[B(Y(o.$filters.numero(o.compra.totalDocumento,2)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(y,{gutter:"md",mg:"md",bg:"bg-white"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:r(()=>[B("Faturar")]),_:1})]),_:1}),t(e,{col:"12"},{default:r(()=>[t(_,{modelValue:o.compra.observacaoFaturamento,"onUpdate:modelValue":l[28]||(l[28]=i=>o.compra.observacaoFaturamento=i),tipo:"textoArea",rotulo:"Observa\xE7\xE3o faturamento",rows:"5"},null,8,["modelValue"])]),_:1}),t(e,{col:"12"},{default:r(()=>[t(dt,{ref:"formAdicionarPagamento"},{default:r(()=>[t(y,{mg:"md-y",items:"center"},{default:r(()=>[t(e,{col:"12 sm6 md"},{default:r(()=>[t(_,{modelValue:o.compra.formaDePagamento,"onUpdate:modelValue":l[29]||(l[29]=i=>o.compra.formaDePagamento=i),rules:o.formaPagamentoRules,ajuda:"Exemplo: Boleto","somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Forma de pagamento"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(e,{col:"12 sm6 md"},{default:r(()=>[t(_,{modelValue:o.compra.condicaoPagamento,"onUpdate:modelValue":l[30]||(l[30]=i=>o.compra.condicaoPagamento=i),rules:o.condicaoPagamentoRules,ajuda:"Exemplo: 28/56/64","somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Cond. Pag",tipo:"numero"},null,8,["modelValue","rules","somente-leitura"])]),_:1}),t(e,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:r(()=>[B(" Frete Separado "),t(Le,{modelValue:o.compra.freteSeparado,"onUpdate:modelValue":[l[31]||(l[31]=i=>o.compra.freteSeparado=i),s.calcularTotais],disable:o.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"12 sm4 md",text:"bold",class:"q-my-sm"},{default:r(()=>[B(" N\xE3o gerar financeiro "),t(Le,{modelValue:o.compra.naoGerarFinanceiro,"onUpdate:modelValue":[l[32]||(l[32]=i=>o.compra.naoGerarFinanceiro=i),s.calcularTotais],disable:o.compra.status!=="Digita\xE7\xE3o",dense:"",class:"q-ml-sm"},null,8,["modelValue","onUpdate:modelValue","disable"])]),_:1}),t(e,{col:"12 sm4 md",text:"center"},{default:r(()=>[t(ue,{onClick:s.gerarCondicoesDePagamento_click,disable:o.compra.status!=="Digita\xE7\xE3o",color:"positive",icon:"add",label:"Forma de pagamento",outline:"",size:"sm"},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(e,{col:"12"},{default:r(()=>[_e(t(m,{text:"sub1 medium"},{default:r(()=>[B("Condi\xE7\xF5es de pagamento")]),_:1},512),[[Pe,o.compraCondicoesDePagamento.length>0]]),($(!0),ve(Se,null,Te(o.compraCondicoesDePagamento,i=>($(),J(xe,{highlight:"",class:"q-pa-none",key:i.id},{default:r(()=>[t(y,{gutter:"md",mg:"sm-y",items:"center",bordered:"","rounded-borders":""},{default:r(()=>[t(e,{col:"xs6 md-shrink"},{default:r(()=>[t(_,{modelValue:i.dataVencimento,"onUpdate:modelValue":h=>i.dataVencimento=h,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(e,{col:"xs6 md2"},{default:r(()=>[t(_,{modelValue:i.valor,"onUpdate:modelValue":h=>i.valor=h,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o",align:"left",rotulo:"Valor",decimals:"2",zerosDireita:"2",tipo:"decimal"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(e,{col:"xs-grow"},{default:r(()=>[t(_,{modelValue:i.observacao,"onUpdate:modelValue":h=>i.observacao=h,"somente-leitura":o.compra.status!=="Digita\xE7\xE3o"||i.observacao==="Valor Frete + Seguro",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024),t(e,{col:"xs-shrink",text:"right"},{default:r(()=>[t(ue,{onClick:h=>s.removerPagamento_click(i),icon:"delete",round:"",dense:"",flat:"",color:"tertiary",disable:o.compra.status!=="Digita\xE7\xE3o"},null,8,["onClick","disable"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),o.valorTotalPagamento>0?($(),J(y,{key:0,mg:"sm-t"},{default:r(()=>[t(e,{col:"xs-shrink",text:"bold"},{default:r(()=>[B(" Valor total: "+Y(o.$filters.numero(o.valorTotalPagamento,2)),1)]),_:1})]),_:1})):ie("",!0)]),_:1})]),_:1}),o.$db.usuario.desenvolvedor()?($(),J(y,{key:0,gutter:"md",mg:"md",bg:"bg-yellow"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:r(()=>[B("Contabilidade (apenas desenvolvedor)")]),_:1})]),_:1}),t(e,{col:"12"},{default:r(()=>[o.compraTitulos.length?($(),J(m,{key:0,text:"sub1 medium"},{default:r(()=>[B("Titulos")]),_:1})):ie("",!0),t(xe,{highlight:"",class:"q-pa-none"},{default:r(()=>[($(!0),ve(Se,null,Te(o.compraTitulos,i=>($(),J(y,{key:i.id,items:"center"},{default:r(()=>[t(e,{col:"sm2"},{default:r(()=>[t(_,{modelValue:i.dataVencimento,"somente-leitura":"",rotulo:"Data vencimento",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:r(()=>[t(_,{modelValue:i.dataPagamento||"A pagar","somente-leitura":"",rotulo:"Data pagamento",tipo:i.dataPagamento?"data":"texto",dense:""},null,8,["modelValue","tipo"])]),_:2},1024),t(e,{col:"sm2"},{default:r(()=>[t(_,{modelValue:i.valor,"somente-leitura":"",align:"left",rotulo:"Valor",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:r(()=>[t(_,{modelValue:i.parcela,"somente-leitura":"",align:"left",rotulo:"Parcela"},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:r(()=>[t(_,{modelValue:i.formaDePagamento,"somente-leitura":"",rotulo:"Forma de pagamento"},null,8,["modelValue"])]),_:2},1024),t(e,{col:"sm2"},{default:r(()=>[t(_,{modelValue:i.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(e,{col:"12"},{default:r(()=>[o.compraMovimentacoes.length?($(),J(m,{key:0,text:"sub1 medium"},{default:r(()=>[B("Movimenta\xE7\xF4es")]),_:1})):ie("",!0),t(xe,{highlight:"",class:"q-pa-none"},{default:r(()=>[($(!0),ve(Se,null,Te(o.compraMovimentacoes,i=>($(),J(y,{key:i.id,gutter:"sm",mg:"sm-y",items:"center"},{default:r(()=>[t(e,{col:"xs-grow"},{default:r(()=>[t(_,{modelValue:i.descricao,"somente-leitura":"",rotulo:"Descri\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024),i.valorCredito?($(),J(e,{key:0,col:"xs6 md2"},{default:r(()=>[t(_,{modelValue:i.valorCredito,"somente-leitura":"",align:"left",rotulo:"Valor Credito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):ie("",!0),i.valorDebito?($(),J(e,{key:1,col:"xs6 md2"},{default:r(()=>[t(_,{modelValue:i.valorDebito,"somente-leitura":"",align:"left",rotulo:"Valor Debito",decimals:"2",tipo:"decimal"},null,8,["modelValue"])]),_:2},1024)):ie("",!0),t(e,{col:"xs6 md-shrink"},{default:r(()=>[t(_,{modelValue:i.dataCompetencia,"somente-leitura":"",rotulo:"Data competencia",tipo:"data",dense:""},null,8,["modelValue"])]),_:2},1024),t(e,{col:"xs-grow"},{default:r(()=>[t(_,{modelValue:i.observacao,"somente-leitura":"",rotulo:"Observa\xE7\xE3o"},null,8,["modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):ie("",!0),o.$db.usuario.desenvolvedor()&&o.compraDocumentoXml.length?($(),J(y,{key:1,gutter:"md",mg:"md",bg:"bg-yellow"},{default:r(()=>[t(e,{col:"12"},{default:r(()=>[t(m,{text:"sub1 medium",icon:"credit_card sm tertiary left"},{default:r(()=>[B("XML importado (apenas desenvolvedor)")]),_:1})]),_:1}),t(e,{col:"12"},{default:r(()=>[t(xe,{highlight:"",class:"q-pa-none"},{default:r(()=>[($(!0),ve(Se,null,Te(o.compraDocumentoXml,i=>($(),J(y,{key:i.id},{default:r(()=>[he("pre",null,Y(s.formatXml(i.xmlData)),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):ie("",!0)]),_:1})]),_:1}),t(Ye,{class:"bg-light border-top"},{default:r(()=>[t(Ne,{class:"bg-light text-tertiary q-px-md u-container"},{default:r(()=>[t(Re,{class:"text-subtitle2"},{default:r(()=>[B(" Valor Total: "+Y(o.$filters.numero(o.compra.totalDocumento,2))+" ",1),Ht,B(" SKU: "+Y(s.skus),1)]),_:1}),t(ot),_e(t(ue,{onClick:s.excluir_click,type:"submit",class:"q-ml-sm",color:"white","text-color":"negative",flat:"",label:"Excluir"},null,8,["onClick"]),[[Pe,o.compra.status==="Digita\xE7\xE3o"]]),_e(t(ue,{onClick:s.finalizar_click,type:"submit",class:"q-ml-sm",color:"primary",unelevated:"",label:"Finalizar"},null,8,["onClick"]),[[Pe,o.compra.status==="Digita\xE7\xE3o"]]),_e(t(ue,{onClick:s.reabrir_click,color:"tertiary",flat:"",label:"Reabrir",type:"submit",class:"q-ml-sm"},null,8,["onClick"]),[[Pe,o.compra.status==="Finalizado"]]),_e(t(ue,{unelevated:"",onClick:s.transformarEmNotaDeEntrada_click,class:"q-ml-sm",color:"primary",label:"Transformar em Nota de Entrada",type:"submit"},null,8,["onClick"]),[[Pe,o.compra.status==="Finalizado"&&o.compra.operacao==="Pedido de Compra"]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(n,{ref:"ModalEditarProdutoCompras",onSalvar:s.fecharEdicaoProduto},null,8,["onSalvar"]),t(C,{modelValue:o.adicionar.modal.value,"onUpdate:modelValue":l[34]||(l[34]=i=>o.adicionar.modal.value=i),filtro:{ativo:!0,idEmpresa:o.compra.idEmpresa},ref:"promptItem",habilitarQuantidade:!0,exibirValorVenda:!1,calculaItemCusto:!0,onSelecionarItens:s.selecionarItens},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var Xt=rt(Lt,[["render",Zt]]);const Wt={components:{PromptItemV2:bt},data(){return{mostrarItemModal:!1,idxItem:0,compra:{},compraItens:[],visivel:!1,edicaoGeral:{marca:"",grupo:"",subGrupo:"",percentualMarkup:0}}},emits:["atualizar","concluirImportacao"],computed:{produtosNaoVinculados(){return this.compraItens.reduce((o,l)=>o+(l.vinculado?0:1),0)},quantProdutos(){return this.compraItens.reduce((o,l)=>o+1,0)}},methods:{async mostrar(o){for(const l of o.documentosItem)this.recalcularItem_blur(l);this.compra=o,this.compraItens=o.documentosItem,this.visivel=!0},async fechar(){this.visivel=!1},async selecionarItens(o){await $tryLoading(async()=>{var m;const l=(m=Object.values(o)[0])==null?void 0:m.item;$utils.verificarErro(!(l!=null&&l.id),"Produto inv\xE1lido"),this.compraItens[this.idxItem].item=l;const{documentoItem:p,item:w,nfeProd:a}=this.compraItens[this.idxItem];p.idItem=w.id,p.descricaoItem=w.descricao;const s={id:$utils.uuid(),idItem:p.idItem,idContato:this.compra.documento.idContato,referencia:a.cProd,descricao:a.xProd};this.compra.itensFornecedor.push(s),this.compraItens[this.idxItem].vinculado=!0,$q.notifyPositive(`Produto vinculado com sucesso: ${w.descricao}`)},{mensagem:"Vinculando produto..."}),this.mostrarItemModal=!1},aplicar_click(){for(const o of this.compraItens)this.edicaoGeral.marca&&(o.item.marca=this.edicaoGeral.marca),this.edicaoGeral.grupo&&(o.item.grupo=this.edicaoGeral.grupo),this.edicaoGeral.subGrupo&&(o.item.subGrupo=this.edicaoGeral.subGrupo),this.edicaoGeral.percentualMarkup&&(o.item.percentualMarkup=this.edicaoGeral.percentualMarkup,this.recalcularItem_blur(o))},async recalcularItem_blur(o){const{item:l,documentoItem:p,itemAnterior:w=$utils.clonarV2(o.item)}=o,{valorFreteRateado:a=0,valorSeguroRateado:s=0,valorOutrasDespesasRateado:m=0}=p;o.valoresEdicao||(o.valoresEdicao={valorOutrasDespesas:a+s+m,percentualIpi:p.percentualIpi||0,percentualIcmsSt:p.percentualIcmsSt||0,percentualDifal:0});const{valorOutrasDespesas:e,percentualIpi:c,percentualIcmsSt:v,percentualDifal:y}=o.valoresEdicao,{valorCusto:g=0,percentualMarkup:_=0,valorVenda:n=0}=l,C=g+e,i=C*c/100,h=C*v/100,d=C*y/100;l.valorCustoReposicao=$utils.arredondar(C+i+h+d,2),n!==w.valorVenda?l.percentualMarkup=$utils.arredondar(100*(n-l.valorCustoReposicao)/n,2):l.valorVenda=$utils.arredondar(l.valorCustoReposicao/(1-_/100),2),o.itemAnterior=$utils.clonarV2(l)},async adicionarItem_click(o){o.buttonLoading=!0,await this.$nextTick(),await $tryLoading(async()=>{const l=await $db.hibrido.lista({table:"item",where:{referencia:o.item.referencia}});$utils.verificarErro(l.length,"Referencia j\xE1 utilizada por outro produto"),o.documentoItem.descricaoItem=o.item.descricao,o.item.descricaoConcatenada=o.item.descricao;const p=o.nfeProd,w={id:$utils.uuid(),idItem:o.item.id,idContato:this.compra.documento.idContato,referencia:p.cProd,descricao:p.xProd};this.compra.itens.push(o.item),this.compra.itensFornecedor.push(w),o.vinculado=!0,$q.notifyPositive(`Item criado com sucesso: ${o.item.descricao}`)},{mensagem:"Cadastrando produto..."}),o.buttonLoading=!1},async salvar_click(){this.compraItens.some(({vinculado:o})=>!o)?$q.notifyError("Verifique todos os itens n\xE3o vinculados!"):(this.mostrarItemModal=!1,this.visivel=!1,this.$emit("concluirImportacao",this.compra))},async incluirTodos_click(){for(const o of this.compraItens)o.vinculado||await this.adicionarItem_click(o)}}},Gt={class:"layout-padding q-pa-none q-pb-md"},Qt={class:"items-carrinho items-center row q-pa-none rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"}},Kt=he("div",{class:"col-8"},null,-1),Yt={class:"col-2"},Jt=["id"],ea={class:"col-12"},ta={class:"col-4 col-md"},aa={class:"col-4 col-md"},oa={class:"col-4 col-md"},ra={class:"col-4 col-md"},ia={class:"col-6 col-md"},sa={class:"col-12 col-md"},na={class:"col-6 col-md"},la={class:"col-12 col-md"},da={key:0,class:"col-12"},ua={class:"col-12 col-md-4"},ca=he("div",{class:"col-12 col-md-auto"},"ou",-1),ma={class:"col-12 col-md-auto q-pl-none"},fa={key:1,class:"col-12 q-pt-md text-right text-bold"},pa={class:"text-positive"};function ha(o,l,p,w,a,s){const m=fe("ajuda"),e=fe("campo"),c=fe("row"),v=fe("card"),y=fe("PromptItemV2");return $(),ve(Se,null,[t(Xe,{modelValue:a.visivel,"onUpdate:modelValue":l[4]||(l[4]=g=>a.visivel=g),persistent:"",maximized:"",onKeyup:vt(s.fechar,["esc"])},{default:r(()=>[t(je,{container:"",view:"hHh LpR fFf",class:"bg-light"},{default:r(()=>[t($e,null,{default:r(()=>[t(Ne,null,{default:r(()=>[t(ue,{icon:"arrow_back",flat:"",round:"",dense:"",onClick:s.fechar},null,8,["onClick"]),t(Re,null,{default:r(()=>[B("Importar XML x Cadastro")]),_:1}),t(m)]),_:1})]),_:1}),t(He,null,{default:r(()=>[t(Ze,null,{default:r(()=>[he("div",Gt,[he("div",Qt,[t(v,{icon:"mdi-set-none",label:"Propriedades para todos os produtos",class:"full-width"},{default:r(()=>[t(c,null,{default:r(()=>[t(e,{modelValue:a.edicaoGeral.marca,"onUpdate:modelValue":l[0]||(l[0]=g=>a.edicaoGeral.marca=g),rotulo:"Marca",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),t(e,{modelValue:a.edicaoGeral.grupo,"onUpdate:modelValue":l[1]||(l[1]=g=>a.edicaoGeral.grupo=g),rotulo:"Grupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"]),t(e,{modelValue:a.edicaoGeral.subGrupo,"onUpdate:modelValue":l[2]||(l[2]=g=>a.edicaoGeral.subGrupo=g),rotulo:"SubGrupo",dense:"",tipo:"texto",outlined:"",col:"4"},null,8,["modelValue"])]),_:1}),t(c,{class:"q-pt-sm"},{default:r(()=>[Kt,t(e,{modelValue:a.edicaoGeral.percentualMarkup,"onUpdate:modelValue":l[3]||(l[3]=g=>a.edicaoGeral.percentualMarkup=g),rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2",outlined:"",col:"2"},null,8,["modelValue"]),he("div",Yt,[t(ue,{class:"q-ml-sm no-shadow",color:"primary",icon:"play_arrow",unelevated:"",label:"Aplicar",onClick:s.aplicar_click},null,8,["onClick"])])]),_:1})]),_:1})]),t(Dt,{items:a.compraItens,separator:""},{default:r(({item:g,index:_})=>[he("div",{class:"items-carrinho items-center row q-pa-md bg-white rounded-borders u-container",style:{"margin-top":"12px","margin-bottom":"12px"},id:_},[t(xe,{class:"full-width"},{default:r(()=>[t(be,{class:"q-px-none"},{default:r(()=>[t(K,{class:"q-px-none"},{default:r(()=>[t(ne,null,{default:r(()=>[t(e,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Descri\xE7\xE3o Item",modelValue:g.item.descricao,"onUpdate:modelValue":n=>g.item.descricao=n,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[t(e,{dense:"",align:"left",tipo:"texto",outlined:"",rotulo:"Referencia",modelValue:g.item.referencia,"onUpdate:modelValue":n=>g.item.referencia=n,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(xe,{class:"full-width"},{default:r(()=>[t(be,{class:"q-px-none"},{default:r(()=>[t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[t(e,{dense:"",tipo:"texto",outlined:"",rotulo:"Marca",modelValue:g.item.marca,"onUpdate:modelValue":n=>g.item.marca=n,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[t(e,{dense:"",tipo:"texto",outlined:"",rotulo:"Grupo",modelValue:g.item.grupo,"onUpdate:modelValue":n=>g.item.grupo=n,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[t(e,{dense:"",tipo:"texto",outlined:"",rotulo:"SubGrupo",modelValue:g.item.subGrupo,"onUpdate:modelValue":n=>g.item.subGrupo=n,"somente-leitura":!!g.vinculado},null,8,["modelValue","onUpdate:modelValue","somente-leitura"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),he("div",ea,[t(c,{class:"q-col-gutter-sm"},{default:r(()=>[he("div",ta,[t(e,{modelValue:g.item.valorCusto,"onUpdate:modelValue":n=>g.item.valorCusto=n,rotulo:"Valor pr\xE9 custo",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),he("div",aa,[t(e,{modelValue:g.valoresEdicao.valorOutrasDespesas,"onUpdate:modelValue":n=>g.valoresEdicao.valorOutrasDespesas=n,rotulo:"Outras Despesas",dense:"",tipo:"decimal",decimals:"4","somente-leitura":!!g.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),he("div",oa,[t(e,{modelValue:g.valoresEdicao.percentualIpi,"onUpdate:modelValue":n=>g.valoresEdicao.percentualIpi=n,rotulo:"IPI",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),he("div",ra,[t(e,{modelValue:g.valoresEdicao.percentualIcmsSt,"onUpdate:modelValue":n=>g.valoresEdicao.percentualIcmsSt=n,rotulo:"ST",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),he("div",ia,[t(e,{modelValue:g.valoresEdicao.percentualDifal,"onUpdate:modelValue":n=>g.valoresEdicao.percentualDifal=n,rotulo:"DIFAL",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),he("div",sa,[t(e,{modelValue:g.item.valorCustoReposicao,"onUpdate:modelValue":n=>g.item.valorCustoReposicao=n,rotulo:"Custo de reposi\xE7\xE3o",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":""},null,8,["modelValue","onUpdate:modelValue"])]),he("div",na,[t(e,{modelValue:g.item.percentualMarkup,"onUpdate:modelValue":n=>g.item.percentualMarkup=n,rotulo:"Margem de Lucro",suffix:"%",opcoes:{maximumValue:100},dense:"",tipo:"decimal",decimals:"2","somente-leitura":!!g.vinculado,outlined:"",onBlur:n=>s.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])]),he("div",la,[t(e,{modelValue:g.item.valorVenda,"onUpdate:modelValue":n=>g.item.valorVenda=n,rotulo:"Valor de Venda",dense:"",tipo:"decimal",decimals:"4",zerosDireita:"2",outlined:"","somente-leitura":!!g.vinculado,onBlur:n=>s.recalcularItem_blur(g)},null,8,["modelValue","onUpdate:modelValue","somente-leitura","onBlur"])])]),_:2},1024)]),g.vinculado?($(),ve("div",fa," Produto vinculado ")):($(),ve("div",da,[t(c,{class:"q-mt-lg text-right full-width justify-end items-center"},{default:r(()=>[he("div",ua,[t(ue,{class:"q-ml-sm no-shadow",color:"primary",icon:"search",unelevated:"",label:"Vincular",onClick:()=>{a.mostrarItemModal=!a.mostrarItemModal,a.idxItem=_}},null,8,["onClick"])]),ca,he("div",ma,[t(ue,{loading:g.buttonLoading,class:"q-ml-sm no-shadow",color:"primary",icon:"add",unelevated:"",label:"Novo",onClick:n=>s.adicionarItem_click(g)},null,8,["loading","onClick"])])]),_:2},1024)]))],8,Jt)]),_:1},8,["items"])])]),_:1})]),_:1}),t(Ye,{class:"bg-light"},{default:r(()=>[t(Ne,null,{default:r(()=>[t(Re,null,{default:r(()=>[he("span",pa,"Produtos: "+Y(s.quantProdutos)+" - N\xE3o vinculados: "+Y(s.produtosNaoVinculados),1)]),_:1}),s.produtosNaoVinculados?($(),J(ue,{key:0,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Incluir Todos",onClick:s.incluirTodos_click,unelevated:""},null,8,["onClick"])):($(),J(ue,{key:1,class:"q-ml-sm no-shadow float-right",color:"primary",label:"Salvar",onClick:s.salvar_click,unelevated:""},null,8,["onClick"]))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onKeyup"]),t(y,{modelValue:a.mostrarItemModal,"onUpdate:modelValue":l[5]||(l[5]=g=>a.mostrarItemModal=g),habilitarQuantidade:!1,filtro:{ativo:!0,idEmpresa:a.compra.idEmpresa},exibirValorVenda:!1,onSelecionarItens:s.selecionarItens,ref:"promptItem"},null,8,["modelValue","filtro","onSelecionarItens"])],64)}var ga=rt(Wt,[["render",ha]]),_t={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(o,l){(function(p){o.exports=p()})(function(){return function p(w,a,s){function m(v,y){if(!a[v]){if(!w[v]){var g=typeof at=="function"&&at;if(!y&&g)return g(v,!0);if(e)return e(v,!0);var _=new Error("Cannot find module '"+v+"'");throw _.code="MODULE_NOT_FOUND",_}var n=a[v]={exports:{}};w[v][0].call(n.exports,function(C){var i=w[v][1][C];return m(i||C)},n,n.exports,p,w,a,s)}return a[v].exports}for(var e=typeof at=="function"&&at,c=0;c<s.length;c++)m(s[c]);return m}({1:[function(p,w,a){var s=p("./utils"),m=p("./support"),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var v,y,g,_,n,C,i,h=[],d=0,b=c.length,S=b,D=s.getTypeOf(c)!=="string";d<c.length;)S=b-d,g=D?(v=c[d++],y=d<b?c[d++]:0,d<b?c[d++]:0):(v=c.charCodeAt(d++),y=d<b?c.charCodeAt(d++):0,d<b?c.charCodeAt(d++):0),_=v>>2,n=(3&v)<<4|y>>4,C=1<S?(15&y)<<2|g>>6:64,i=2<S?63&g:64,h.push(e.charAt(_)+e.charAt(n)+e.charAt(C)+e.charAt(i));return h.join("")},a.decode=function(c){var v,y,g,_,n,C,i=0,h=0,d="data:";if(c.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var b,S=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===e.charAt(64)&&S--,c.charAt(c.length-2)===e.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(b=m.uint8array?new Uint8Array(0|S):new Array(0|S);i<c.length;)v=e.indexOf(c.charAt(i++))<<2|(_=e.indexOf(c.charAt(i++)))>>4,y=(15&_)<<4|(n=e.indexOf(c.charAt(i++)))>>2,g=(3&n)<<6|(C=e.indexOf(c.charAt(i++))),b[h++]=v,n!==64&&(b[h++]=y),C!==64&&(b[h++]=g);return b}},{"./support":30,"./utils":32}],2:[function(p,w,a){var s=p("./external"),m=p("./stream/DataWorker"),e=p("./stream/Crc32Probe"),c=p("./stream/DataLengthProbe");function v(y,g,_,n,C){this.compressedSize=y,this.uncompressedSize=g,this.crc32=_,this.compression=n,this.compressedContent=C}v.prototype={getContentWorker:function(){var y=new m(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),g=this;return y.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new m(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},v.createWorkerFrom=function(y,g,_){return y.pipe(new e).pipe(new c("uncompressedSize")).pipe(g.compressWorker(_)).pipe(new c("compressedSize")).withStreamInfo("compression",g)},w.exports=v},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(p,w,a){var s=p("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},a.DEFLATE=p("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(p,w,a){var s=p("./utils"),m=function(){for(var e,c=[],v=0;v<256;v++){e=v;for(var y=0;y<8;y++)e=1&e?3988292384^e>>>1:e>>>1;c[v]=e}return c}();w.exports=function(e,c){return e!==void 0&&e.length?s.getTypeOf(e)!=="string"?function(v,y,g,_){var n=m,C=_+g;v^=-1;for(var i=_;i<C;i++)v=v>>>8^n[255&(v^y[i])];return-1^v}(0|c,e,e.length,0):function(v,y,g,_){var n=m,C=_+g;v^=-1;for(var i=_;i<C;i++)v=v>>>8^n[255&(v^y.charCodeAt(i))];return-1^v}(0|c,e,e.length,0):0}},{"./utils":32}],5:[function(p,w,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(p,w,a){var s=null;s=typeof Promise!="undefined"?Promise:p("lie"),w.exports={Promise:s}},{lie:37}],7:[function(p,w,a){var s=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",m=p("pako"),e=p("./utils"),c=p("./stream/GenericWorker"),v=s?"uint8array":"array";function y(g,_){c.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=_,this.meta={}}a.magic="\b\0",e.inherits(y,c),y.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(e.transformTo(v,g.data),!1)},y.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new m[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(_){g.push({data:_,meta:g.meta})}},a.compressWorker=function(g){return new y("Deflate",g)},a.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(p,w,a){function s(n,C){var i,h="";for(i=0;i<C;i++)h+=String.fromCharCode(255&n),n>>>=8;return h}function m(n,C,i,h,d,b){var S,D,x=n.file,O=n.compression,A=b!==v.utf8encode,j=e.transformTo("string",b(x.name)),N=e.transformTo("string",v.utf8encode(x.name)),Z=x.comment,ae=e.transformTo("string",b(Z)),E=e.transformTo("string",v.utf8encode(Z)),q=N.length!==x.name.length,f=E.length!==Z.length,R="",le="",H="",de=x.dir,X=x.date,se={crc32:0,compressedSize:0,uncompressedSize:0};C&&!i||(se.crc32=n.crc32,se.compressedSize=n.compressedSize,se.uncompressedSize=n.uncompressedSize);var F=0;C&&(F|=8),A||!q&&!f||(F|=2048);var z=0,re=0;de&&(z|=16),d==="UNIX"?(re=798,z|=function(Q,we){var Ee=Q;return Q||(Ee=we?16893:33204),(65535&Ee)<<16}(x.unixPermissions,de)):(re=20,z|=function(Q){return 63&(Q||0)}(x.dosPermissions)),S=X.getUTCHours(),S<<=6,S|=X.getUTCMinutes(),S<<=5,S|=X.getUTCSeconds()/2,D=X.getUTCFullYear()-1980,D<<=4,D|=X.getUTCMonth()+1,D<<=5,D|=X.getUTCDate(),q&&(le=s(1,1)+s(y(j),4)+N,R+="up"+s(le.length,2)+le),f&&(H=s(1,1)+s(y(ae),4)+E,R+="uc"+s(H.length,2)+H);var ee="";return ee+=`
\0`,ee+=s(F,2),ee+=O.magic,ee+=s(S,2),ee+=s(D,2),ee+=s(se.crc32,4),ee+=s(se.compressedSize,4),ee+=s(se.uncompressedSize,4),ee+=s(j.length,2),ee+=s(R.length,2),{fileRecord:g.LOCAL_FILE_HEADER+ee+j+R,dirRecord:g.CENTRAL_FILE_HEADER+s(re,2)+ee+s(ae.length,2)+"\0\0\0\0"+s(z,4)+s(h,4)+j+R+ae}}var e=p("../utils"),c=p("../stream/GenericWorker"),v=p("../utf8"),y=p("../crc32"),g=p("../signature");function _(n,C,i,h){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=C,this.zipPlatform=i,this.encodeFileName=h,this.streamFiles=n,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}e.inherits(_,c),_.prototype.push=function(n){var C=n.meta.percent||0,i=this.entriesCount,h=this._sources.length;this.accumulate?this.contentBuffer.push(n):(this.bytesWritten+=n.data.length,c.prototype.push.call(this,{data:n.data,meta:{currentFile:this.currentFile,percent:i?(C+100*(i-h-1))/i:100}}))},_.prototype.openedSource=function(n){this.currentSourceOffset=this.bytesWritten,this.currentFile=n.file.name;var C=this.streamFiles&&!n.file.dir;if(C){var i=m(n,C,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(n){this.accumulate=!1;var C=this.streamFiles&&!n.file.dir,i=m(n,C,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),C)this.push({data:function(h){return g.DATA_DESCRIPTOR+s(h.crc32,4)+s(h.compressedSize,4)+s(h.uncompressedSize,4)}(n),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var n=this.bytesWritten,C=0;C<this.dirRecords.length;C++)this.push({data:this.dirRecords[C],meta:{percent:100}});var i=this.bytesWritten-n,h=function(d,b,S,D,x){var O=e.transformTo("string",x(D));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(d,2)+s(d,2)+s(b,4)+s(S,4)+s(O.length,2)+O}(this.dirRecords.length,i,n,this.zipComment,this.encodeFileName);this.push({data:h,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(n){this._sources.push(n);var C=this;return n.on("data",function(i){C.processChunk(i)}),n.on("end",function(){C.closedSource(C.previous.streamInfo),C._sources.length?C.prepareNextSource():C.end()}),n.on("error",function(i){C.error(i)}),this},_.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},_.prototype.error=function(n){var C=this._sources;if(!c.prototype.error.call(this,n))return!1;for(var i=0;i<C.length;i++)try{C[i].error(n)}catch{}return!0},_.prototype.lock=function(){c.prototype.lock.call(this);for(var n=this._sources,C=0;C<n.length;C++)n[C].lock()},w.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(p,w,a){var s=p("../compressions"),m=p("./ZipFileWorker");a.generateWorker=function(e,c,v){var y=new m(c.streamFiles,v,c.platform,c.encodeFileName),g=0;try{e.forEach(function(_,n){g++;var C=function(b,S){var D=b||S,x=s[D];if(!x)throw new Error(D+" is not a valid compression method !");return x}(n.options.compression,c.compression),i=n.options.compressionOptions||c.compressionOptions||{},h=n.dir,d=n.date;n._compressWorker(C,i).withStreamInfo("file",{name:_,dir:h,date:d,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(y)}),y.entriesCount=g}catch(_){y.error(_)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(p,w,a){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var m=new s;for(var e in this)typeof this[e]!="function"&&(m[e]=this[e]);return m}}(s.prototype=p("./object")).loadAsync=p("./load"),s.support=p("./support"),s.defaults=p("./defaults"),s.version="3.10.1",s.loadAsync=function(m,e){return new s().loadAsync(m,e)},s.external=p("./external"),w.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(p,w,a){var s=p("./utils"),m=p("./external"),e=p("./utf8"),c=p("./zipEntries"),v=p("./stream/Crc32Probe"),y=p("./nodejsUtils");function g(_){return new m.Promise(function(n,C){var i=_.decompressed.getContentWorker().pipe(new v);i.on("error",function(h){C(h)}).on("end",function(){i.streamInfo.crc32!==_.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):n()}).resume()})}w.exports=function(_,n){var C=this;return n=s.extend(n||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:e.utf8decode}),y.isNode&&y.isStream(_)?m.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",_,!0,n.optimizedBinaryString,n.base64).then(function(i){var h=new c(n);return h.load(i),h}).then(function(i){var h=[m.Promise.resolve(i)],d=i.files;if(n.checkCRC32)for(var b=0;b<d.length;b++)h.push(g(d[b]));return m.Promise.all(h)}).then(function(i){for(var h=i.shift(),d=h.files,b=0;b<d.length;b++){var S=d[b],D=S.fileNameStr,x=s.resolve(S.fileNameStr);C.file(x,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:n.createFolders}),S.dir||(C.file(x).unsafeOriginalName=D)}return h.zipComment.length&&(C.comment=h.zipComment),C})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(p,w,a){var s=p("../utils"),m=p("../stream/GenericWorker");function e(c,v){m.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(v)}s.inherits(e,m),e.prototype._bindStream=function(c){var v=this;(this._stream=c).pause(),c.on("data",function(y){v.push({data:y,meta:{percent:0}})}).on("error",function(y){v.isPaused?this.generatedError=y:v.error(y)}).on("end",function(){v.isPaused?v._upstreamEnded=!0:v.end()})},e.prototype.pause=function(){return!!m.prototype.pause.call(this)&&(this._stream.pause(),!0)},e.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},w.exports=e},{"../stream/GenericWorker":28,"../utils":32}],13:[function(p,w,a){var s=p("readable-stream").Readable;function m(e,c,v){s.call(this,c),this._helper=e;var y=this;e.on("data",function(g,_){y.push(g)||y._helper.pause(),v&&v(_)}).on("error",function(g){y.emit("error",g)}).on("end",function(){y.push(null)})}p("../utils").inherits(m,s),m.prototype._read=function(){this._helper.resume()},w.exports=m},{"../utils":32,"readable-stream":16}],14:[function(p,w,a){w.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(s,m){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,m);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,m)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var m=new Buffer(s);return m.fill(0),m},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(p,w,a){function s(x,O,A){var j,N=e.getTypeOf(O),Z=e.extend(A||{},y);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(x=d(x)),Z.createFolders&&(j=h(x))&&b.call(this,j,!0);var ae=N==="string"&&Z.binary===!1&&Z.base64===!1;A&&A.binary!==void 0||(Z.binary=!ae),(O instanceof g&&O.uncompressedSize===0||Z.dir||!O||O.length===0)&&(Z.base64=!1,Z.binary=!0,O="",Z.compression="STORE",N="string");var E=null;E=O instanceof g||O instanceof c?O:C.isNode&&C.isStream(O)?new i(x,O):e.prepareContent(x,O,Z.binary,Z.optimizedBinaryString,Z.base64);var q=new _(x,E,Z);this.files[x]=q}var m=p("./utf8"),e=p("./utils"),c=p("./stream/GenericWorker"),v=p("./stream/StreamHelper"),y=p("./defaults"),g=p("./compressedObject"),_=p("./zipObject"),n=p("./generate"),C=p("./nodejsUtils"),i=p("./nodejs/NodejsStreamInputAdapter"),h=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var O=x.lastIndexOf("/");return 0<O?x.substring(0,O):""},d=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},b=function(x,O){return O=O!==void 0?O:y.createFolders,x=d(x),this.files[x]||s.call(this,x,null,{dir:!0,createFolders:O}),this.files[x]};function S(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var D={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var O,A,j;for(O in this.files)j=this.files[O],(A=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&x(A,j)},filter:function(x){var O=[];return this.forEach(function(A,j){x(A,j)&&O.push(j)}),O},file:function(x,O,A){if(arguments.length!==1)return x=this.root+x,s.call(this,x,O,A),this;if(S(x)){var j=x;return this.filter(function(Z,ae){return!ae.dir&&j.test(Z)})}var N=this.files[this.root+x];return N&&!N.dir?N:null},folder:function(x){if(!x)return this;if(S(x))return this.filter(function(N,Z){return Z.dir&&x.test(N)});var O=this.root+x,A=b.call(this,O),j=this.clone();return j.root=A.name,j},remove:function(x){x=this.root+x;var O=this.files[x];if(O||(x.slice(-1)!=="/"&&(x+="/"),O=this.files[x]),O&&!O.dir)delete this.files[x];else for(var A=this.filter(function(N,Z){return Z.name.slice(0,x.length)===x}),j=0;j<A.length;j++)delete this.files[A[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var O,A={};try{if((A=e.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:m.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");e.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var j=A.comment||this.comment||"";O=n.generateWorker(this,A,j)}catch(N){(O=new c("error")).error(N)}return new v(O,A.type||"string",A.mimeType)},generateAsync:function(x,O){return this.generateInternalStream(x).accumulate(O)},generateNodeStream:function(x,O){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(O)}};w.exports=D},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(p,w,a){w.exports=p("stream")},{stream:void 0}],17:[function(p,w,a){var s=p("./DataReader");function m(e){s.call(this,e);for(var c=0;c<this.data.length;c++)e[c]=255&e[c]}p("../utils").inherits(m,s),m.prototype.byteAt=function(e){return this.data[this.zero+e]},m.prototype.lastIndexOfSignature=function(e){for(var c=e.charCodeAt(0),v=e.charCodeAt(1),y=e.charCodeAt(2),g=e.charCodeAt(3),_=this.length-4;0<=_;--_)if(this.data[_]===c&&this.data[_+1]===v&&this.data[_+2]===y&&this.data[_+3]===g)return _-this.zero;return-1},m.prototype.readAndCheckSignature=function(e){var c=e.charCodeAt(0),v=e.charCodeAt(1),y=e.charCodeAt(2),g=e.charCodeAt(3),_=this.readData(4);return c===_[0]&&v===_[1]&&y===_[2]&&g===_[3]},m.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,c},w.exports=m},{"../utils":32,"./DataReader":18}],18:[function(p,w,a){var s=p("../utils");function m(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}m.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var c,v=0;for(this.checkOffset(e),c=this.index+e-1;c>=this.index;c--)v=(v<<8)+this.byteAt(c);return this.index+=e,v},readString:function(e){return s.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},w.exports=m},{"../utils":32}],19:[function(p,w,a){var s=p("./Uint8ArrayReader");function m(e){s.call(this,e)}p("../utils").inherits(m,s),m.prototype.readData=function(e){this.checkOffset(e);var c=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,c},w.exports=m},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(p,w,a){var s=p("./DataReader");function m(e){s.call(this,e)}p("../utils").inherits(m,s),m.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},m.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},m.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},m.prototype.readData=function(e){this.checkOffset(e);var c=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,c},w.exports=m},{"../utils":32,"./DataReader":18}],21:[function(p,w,a){var s=p("./ArrayReader");function m(e){s.call(this,e)}p("../utils").inherits(m,s),m.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,c},w.exports=m},{"../utils":32,"./ArrayReader":17}],22:[function(p,w,a){var s=p("../utils"),m=p("../support"),e=p("./ArrayReader"),c=p("./StringReader"),v=p("./NodeBufferReader"),y=p("./Uint8ArrayReader");w.exports=function(g){var _=s.getTypeOf(g);return s.checkSupport(_),_!=="string"||m.uint8array?_==="nodebuffer"?new v(g):m.uint8array?new y(s.transformTo("uint8array",g)):new e(s.transformTo("array",g)):new c(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(p,w,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(p,w,a){var s=p("./GenericWorker"),m=p("../utils");function e(c){s.call(this,"ConvertWorker to "+c),this.destType=c}m.inherits(e,s),e.prototype.processChunk=function(c){this.push({data:m.transformTo(this.destType,c.data),meta:c.meta})},w.exports=e},{"../utils":32,"./GenericWorker":28}],25:[function(p,w,a){var s=p("./GenericWorker"),m=p("../crc32");function e(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}p("../utils").inherits(e,s),e.prototype.processChunk=function(c){this.streamInfo.crc32=m(c.data,this.streamInfo.crc32||0),this.push(c)},w.exports=e},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(p,w,a){var s=p("../utils"),m=p("./GenericWorker");function e(c){m.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}s.inherits(e,m),e.prototype.processChunk=function(c){if(c){var v=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=v+c.data.length}m.prototype.processChunk.call(this,c)},w.exports=e},{"../utils":32,"./GenericWorker":28}],27:[function(p,w,a){var s=p("../utils"),m=p("./GenericWorker");function e(c){m.call(this,"DataWorker");var v=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(y){v.dataIsReady=!0,v.data=y,v.max=y&&y.length||0,v.type=s.getTypeOf(y),v.isPaused||v._tickAndRepeat()},function(y){v.error(y)})}s.inherits(e,m),e.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this.data=null},e.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},e.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},e.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,v=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,v);break;case"uint8array":c=this.data.subarray(this.index,v);break;case"array":case"nodebuffer":c=this.data.slice(this.index,v)}return this.index=v,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},w.exports=e},{"../utils":32,"./GenericWorker":28}],28:[function(p,w,a){function s(m){this.name=m||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(m){this.emit("data",m)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(m){this.emit("error",m)}return!0},error:function(m){return!this.isFinished&&(this.isPaused?this.generatedError=m:(this.isFinished=!0,this.emit("error",m),this.previous&&this.previous.error(m),this.cleanUp()),!0)},on:function(m,e){return this._listeners[m].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(m,e){if(this._listeners[m])for(var c=0;c<this._listeners[m].length;c++)this._listeners[m][c].call(this,e)},pipe:function(m){return m.registerPrevious(this)},registerPrevious:function(m){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=m.streamInfo,this.mergeStreamInfo(),this.previous=m;var e=this;return m.on("data",function(c){e.processChunk(c)}),m.on("end",function(){e.end()}),m.on("error",function(c){e.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var m=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),m=!0),this.previous&&this.previous.resume(),!m},flush:function(){},processChunk:function(m){this.push(m)},withStreamInfo:function(m,e){return this.extraStreamInfo[m]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var m in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,m)&&(this.streamInfo[m]=this.extraStreamInfo[m])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var m="Worker "+this.name;return this.previous?this.previous+" -> "+m:m}},w.exports=s},{}],29:[function(p,w,a){var s=p("../utils"),m=p("./ConvertWorker"),e=p("./GenericWorker"),c=p("../base64"),v=p("../support"),y=p("../external"),g=null;if(v.nodestream)try{g=p("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(C,i){return new y.Promise(function(h,d){var b=[],S=C._internalType,D=C._outputType,x=C._mimeType;C.on("data",function(O,A){b.push(O),i&&i(A)}).on("error",function(O){b=[],d(O)}).on("end",function(){try{var O=function(A,j,N){switch(A){case"blob":return s.newBlob(s.transformTo("arraybuffer",j),N);case"base64":return c.encode(j);default:return s.transformTo(A,j)}}(D,function(A,j){var N,Z=0,ae=null,E=0;for(N=0;N<j.length;N++)E+=j[N].length;switch(A){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(ae=new Uint8Array(E),N=0;N<j.length;N++)ae.set(j[N],Z),Z+=j[N].length;return ae;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+A+"'")}}(S,b),x);h(O)}catch(A){d(A)}b=[]}).resume()})}function n(C,i,h){var d=i;switch(i){case"blob":case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=i,this._mimeType=h,s.checkSupport(d),this._worker=C.pipe(new m(d)),C.lock()}catch(b){this._worker=new e("error"),this._worker.error(b)}}n.prototype={accumulate:function(C){return _(this,C)},on:function(C,i){var h=this;return C==="data"?this._worker.on(C,function(d){i.call(h,d.data,d.meta)}):this._worker.on(C,function(){s.delay(i,arguments,h)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(C){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},C)}},w.exports=n},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(p,w,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",a.nodebuffer=typeof Buffer!="undefined",a.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")a.blob=!1;else{var s=new ArrayBuffer(0);try{a.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);m.append(s),a.blob=m.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!p("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(p,w,a){for(var s=p("./utils"),m=p("./support"),e=p("./nodejsUtils"),c=p("./stream/GenericWorker"),v=new Array(256),y=0;y<256;y++)v[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;v[254]=v[254]=1;function g(){c.call(this,"utf-8 decode"),this.leftOver=null}function _(){c.call(this,"utf-8 encode")}a.utf8encode=function(n){return m.nodebuffer?e.newBufferFrom(n,"utf-8"):function(C){var i,h,d,b,S,D=C.length,x=0;for(b=0;b<D;b++)(64512&(h=C.charCodeAt(b)))==55296&&b+1<D&&(64512&(d=C.charCodeAt(b+1)))==56320&&(h=65536+(h-55296<<10)+(d-56320),b++),x+=h<128?1:h<2048?2:h<65536?3:4;for(i=m.uint8array?new Uint8Array(x):new Array(x),b=S=0;S<x;b++)(64512&(h=C.charCodeAt(b)))==55296&&b+1<D&&(64512&(d=C.charCodeAt(b+1)))==56320&&(h=65536+(h-55296<<10)+(d-56320),b++),h<128?i[S++]=h:(h<2048?i[S++]=192|h>>>6:(h<65536?i[S++]=224|h>>>12:(i[S++]=240|h>>>18,i[S++]=128|h>>>12&63),i[S++]=128|h>>>6&63),i[S++]=128|63&h);return i}(n)},a.utf8decode=function(n){return m.nodebuffer?s.transformTo("nodebuffer",n).toString("utf-8"):function(C){var i,h,d,b,S=C.length,D=new Array(2*S);for(i=h=0;i<S;)if((d=C[i++])<128)D[h++]=d;else if(4<(b=v[d]))D[h++]=65533,i+=b-1;else{for(d&=b===2?31:b===3?15:7;1<b&&i<S;)d=d<<6|63&C[i++],b--;1<b?D[h++]=65533:d<65536?D[h++]=d:(d-=65536,D[h++]=55296|d>>10&1023,D[h++]=56320|1023&d)}return D.length!==h&&(D.subarray?D=D.subarray(0,h):D.length=h),s.applyFromCharCode(D)}(n=s.transformTo(m.uint8array?"uint8array":"array",n))},s.inherits(g,c),g.prototype.processChunk=function(n){var C=s.transformTo(m.uint8array?"uint8array":"array",n.data);if(this.leftOver&&this.leftOver.length){if(m.uint8array){var i=C;(C=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),C.set(i,this.leftOver.length)}else C=this.leftOver.concat(C);this.leftOver=null}var h=function(b,S){var D;for((S=S||b.length)>b.length&&(S=b.length),D=S-1;0<=D&&(192&b[D])==128;)D--;return D<0||D===0?S:D+v[b[D]]>S?D:S}(C),d=C;h!==C.length&&(m.uint8array?(d=C.subarray(0,h),this.leftOver=C.subarray(h,C.length)):(d=C.slice(0,h),this.leftOver=C.slice(h,C.length))),this.push({data:a.utf8decode(d),meta:n.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=g,s.inherits(_,c),_.prototype.processChunk=function(n){this.push({data:a.utf8encode(n.data),meta:n.meta})},a.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(p,w,a){var s=p("./support"),m=p("./base64"),e=p("./nodejsUtils"),c=p("./external");function v(i){return i}function y(i,h){for(var d=0;d<i.length;++d)h[d]=255&i.charCodeAt(d);return h}p("setimmediate"),a.newBlob=function(i,h){a.checkSupport("blob");try{return new Blob([i],{type:h})}catch{try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return d.append(i),d.getBlob(h)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(i,h,d){var b=[],S=0,D=i.length;if(D<=d)return String.fromCharCode.apply(null,i);for(;S<D;)h==="array"||h==="nodebuffer"?b.push(String.fromCharCode.apply(null,i.slice(S,Math.min(S+d,D)))):b.push(String.fromCharCode.apply(null,i.subarray(S,Math.min(S+d,D)))),S+=d;return b.join("")},stringifyByChar:function(i){for(var h="",d=0;d<i.length;d++)h+=String.fromCharCode(i[d]);return h},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,e.allocBuffer(1)).length===1}catch{return!1}}()}};function _(i){var h=65536,d=a.getTypeOf(i),b=!0;if(d==="uint8array"?b=g.applyCanBeUsed.uint8array:d==="nodebuffer"&&(b=g.applyCanBeUsed.nodebuffer),b)for(;1<h;)try{return g.stringifyByChunk(i,d,h)}catch{h=Math.floor(h/2)}return g.stringifyByChar(i)}function n(i,h){for(var d=0;d<i.length;d++)h[d]=i[d];return h}a.applyFromCharCode=_;var C={};C.string={string:v,array:function(i){return y(i,new Array(i.length))},arraybuffer:function(i){return C.string.uint8array(i).buffer},uint8array:function(i){return y(i,new Uint8Array(i.length))},nodebuffer:function(i){return y(i,e.allocBuffer(i.length))}},C.array={string:_,array:v,arraybuffer:function(i){return new Uint8Array(i).buffer},uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return e.newBufferFrom(i)}},C.arraybuffer={string:function(i){return _(new Uint8Array(i))},array:function(i){return n(new Uint8Array(i),new Array(i.byteLength))},arraybuffer:v,uint8array:function(i){return new Uint8Array(i)},nodebuffer:function(i){return e.newBufferFrom(new Uint8Array(i))}},C.uint8array={string:_,array:function(i){return n(i,new Array(i.length))},arraybuffer:function(i){return i.buffer},uint8array:v,nodebuffer:function(i){return e.newBufferFrom(i)}},C.nodebuffer={string:_,array:function(i){return n(i,new Array(i.length))},arraybuffer:function(i){return C.nodebuffer.uint8array(i).buffer},uint8array:function(i){return n(i,new Uint8Array(i.length))},nodebuffer:v},a.transformTo=function(i,h){if(h=h||"",!i)return h;a.checkSupport(i);var d=a.getTypeOf(h);return C[d][i](h)},a.resolve=function(i){for(var h=i.split("/"),d=[],b=0;b<h.length;b++){var S=h[b];S==="."||S===""&&b!==0&&b!==h.length-1||(S===".."?d.pop():d.push(S))}return d.join("/")},a.getTypeOf=function(i){return typeof i=="string"?"string":Object.prototype.toString.call(i)==="[object Array]"?"array":s.nodebuffer&&e.isBuffer(i)?"nodebuffer":s.uint8array&&i instanceof Uint8Array?"uint8array":s.arraybuffer&&i instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(i){if(!s[i.toLowerCase()])throw new Error(i+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(i){var h,d,b="";for(d=0;d<(i||"").length;d++)b+="\\x"+((h=i.charCodeAt(d))<16?"0":"")+h.toString(16).toUpperCase();return b},a.delay=function(i,h,d){setImmediate(function(){i.apply(d||null,h||[])})},a.inherits=function(i,h){function d(){}d.prototype=h.prototype,i.prototype=new d},a.extend=function(){var i,h,d={};for(i=0;i<arguments.length;i++)for(h in arguments[i])Object.prototype.hasOwnProperty.call(arguments[i],h)&&d[h]===void 0&&(d[h]=arguments[i][h]);return d},a.prepareContent=function(i,h,d,b,S){return c.Promise.resolve(h).then(function(D){return s.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader!="undefined"?new c.Promise(function(x,O){var A=new FileReader;A.onload=function(j){x(j.target.result)},A.onerror=function(j){O(j.target.error)},A.readAsArrayBuffer(D)}):D}).then(function(D){var x=a.getTypeOf(D);return x?(x==="arraybuffer"?D=a.transformTo("uint8array",D):x==="string"&&(S?D=m.decode(D):d&&b!==!0&&(D=function(O){return y(O,s.uint8array?new Uint8Array(O.length):new Array(O.length))}(D))),D):c.Promise.reject(new Error("Can't read the data of '"+i+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(p,w,a){var s=p("./reader/readerFor"),m=p("./utils"),e=p("./signature"),c=p("./zipEntry"),v=p("./support");function y(g){this.files=[],this.loadOptions=g}y.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var _=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+m.pretty(_)+", expected "+m.pretty(g)+")")}},isSignature:function(g,_){var n=this.reader.index;this.reader.setIndex(g);var C=this.reader.readString(4)===_;return this.reader.setIndex(n),C},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),_=v.uint8array?"uint8array":"array",n=m.transformTo(_,g);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,_,n,C=this.zip64EndOfCentralSize-44;0<C;)g=this.reader.readInt(2),_=this.reader.readInt(4),n=this.reader.readData(_),this.zip64ExtensibleData[g]={id:g,length:_,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,_;for(g=0;g<this.files.length;g++)_=this.files[g],this.reader.setIndex(_.localHeaderOffset),this.checkSignature(e.LOCAL_FILE_HEADER),_.readLocalPart(this.reader),_.handleUTF8(),_.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(g=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var _=g;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===m.MAX_VALUE_16BITS||this.diskWithCentralDirStart===m.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===m.MAX_VALUE_16BITS||this.centralDirRecords===m.MAX_VALUE_16BITS||this.centralDirSize===m.MAX_VALUE_32BITS||this.centralDirOffset===m.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var C=_-n;if(0<C)this.isSignature(_,e.CENTRAL_FILE_HEADER)||(this.reader.zero=C);else if(C<0)throw new Error("Corrupted zip: missing "+Math.abs(C)+" bytes.")},prepareReader:function(g){this.reader=s(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},w.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(p,w,a){var s=p("./reader/readerFor"),m=p("./utils"),e=p("./compressedObject"),c=p("./crc32"),v=p("./utf8"),y=p("./compressions"),g=p("./support");function _(n,C){this.options=n,this.loadOptions=C}_.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(n){var C,i;if(n.skip(22),this.fileNameLength=n.readInt(2),i=n.readInt(2),this.fileName=n.readData(this.fileNameLength),n.skip(i),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((C=function(h){for(var d in y)if(Object.prototype.hasOwnProperty.call(y,d)&&y[d].magic===h)return y[d];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+m.pretty(this.compressionMethod)+" unknown (inner file : "+m.transformTo("string",this.fileName)+")");this.decompressed=new e(this.compressedSize,this.uncompressedSize,this.crc32,C,n.readData(this.compressedSize))},readCentralPart:function(n){this.versionMadeBy=n.readInt(2),n.skip(2),this.bitFlag=n.readInt(2),this.compressionMethod=n.readString(2),this.date=n.readDate(),this.crc32=n.readInt(4),this.compressedSize=n.readInt(4),this.uncompressedSize=n.readInt(4);var C=n.readInt(2);if(this.extraFieldsLength=n.readInt(2),this.fileCommentLength=n.readInt(2),this.diskNumberStart=n.readInt(2),this.internalFileAttributes=n.readInt(2),this.externalFileAttributes=n.readInt(4),this.localHeaderOffset=n.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");n.skip(C),this.readExtraFields(n),this.parseZIP64ExtraField(n),this.fileComment=n.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var n=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),n==0&&(this.dosPermissions=63&this.externalFileAttributes),n==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var n=s(this.extraFields[1].value);this.uncompressedSize===m.MAX_VALUE_32BITS&&(this.uncompressedSize=n.readInt(8)),this.compressedSize===m.MAX_VALUE_32BITS&&(this.compressedSize=n.readInt(8)),this.localHeaderOffset===m.MAX_VALUE_32BITS&&(this.localHeaderOffset=n.readInt(8)),this.diskNumberStart===m.MAX_VALUE_32BITS&&(this.diskNumberStart=n.readInt(4))}},readExtraFields:function(n){var C,i,h,d=n.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});n.index+4<d;)C=n.readInt(2),i=n.readInt(2),h=n.readData(i),this.extraFields[C]={id:C,length:i,value:h};n.setIndex(d)},handleUTF8:function(){var n=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=v.utf8decode(this.fileName),this.fileCommentStr=v.utf8decode(this.fileComment);else{var C=this.findExtraFieldUnicodePath();if(C!==null)this.fileNameStr=C;else{var i=m.transformTo(n,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var h=this.findExtraFieldUnicodeComment();if(h!==null)this.fileCommentStr=h;else{var d=m.transformTo(n,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(d)}}},findExtraFieldUnicodePath:function(){var n=this.extraFields[28789];if(n){var C=s(n.value);return C.readInt(1)!==1||c(this.fileName)!==C.readInt(4)?null:v.utf8decode(C.readData(n.length-5))}return null},findExtraFieldUnicodeComment:function(){var n=this.extraFields[25461];if(n){var C=s(n.value);return C.readInt(1)!==1||c(this.fileComment)!==C.readInt(4)?null:v.utf8decode(C.readData(n.length-5))}return null}},w.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(p,w,a){function s(C,i,h){this.name=C,this.dir=h.dir,this.date=h.date,this.comment=h.comment,this.unixPermissions=h.unixPermissions,this.dosPermissions=h.dosPermissions,this._data=i,this._dataBinary=h.binary,this.options={compression:h.compression,compressionOptions:h.compressionOptions}}var m=p("./stream/StreamHelper"),e=p("./stream/DataWorker"),c=p("./utf8"),v=p("./compressedObject"),y=p("./stream/GenericWorker");s.prototype={internalStream:function(C){var i=null,h="string";try{if(!C)throw new Error("No output type specified.");var d=(h=C.toLowerCase())==="string"||h==="text";h!=="binarystring"&&h!=="text"||(h="string"),i=this._decompressWorker();var b=!this._dataBinary;b&&!d&&(i=i.pipe(new c.Utf8EncodeWorker)),!b&&d&&(i=i.pipe(new c.Utf8DecodeWorker))}catch(S){(i=new y("error")).error(S)}return new m(i,h,"")},async:function(C,i){return this.internalStream(C).accumulate(i)},nodeStream:function(C,i){return this.internalStream(C||"nodebuffer").toNodejsStream(i)},_compressWorker:function(C,i){if(this._data instanceof v&&this._data.compression.magic===C.magic)return this._data.getCompressedWorker();var h=this._decompressWorker();return this._dataBinary||(h=h.pipe(new c.Utf8EncodeWorker)),v.createWorkerFrom(h,C,i)},_decompressWorker:function(){return this._data instanceof v?this._data.getContentWorker():this._data instanceof y?this._data:new e(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},n=0;n<g.length;n++)s.prototype[g[n]]=_;w.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(p,w,a){(function(s){var m,e,c=s.MutationObserver||s.WebKitMutationObserver;if(c){var v=0,y=new c(C),g=s.document.createTextNode("");y.observe(g,{characterData:!0}),m=function(){g.data=v=++v%2}}else if(s.setImmediate||s.MessageChannel===void 0)m="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var i=s.document.createElement("script");i.onreadystatechange=function(){C(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},s.document.documentElement.appendChild(i)}:function(){setTimeout(C,0)};else{var _=new s.MessageChannel;_.port1.onmessage=C,m=function(){_.port2.postMessage(0)}}var n=[];function C(){var i,h;e=!0;for(var d=n.length;d;){for(h=n,n=[],i=-1;++i<d;)h[i]();d=n.length}e=!1}w.exports=function(i){n.push(i)!==1||e||m()}}).call(this,typeof tt!="undefined"?tt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(p,w,a){var s=p("immediate");function m(){}var e={},c=["REJECTED"],v=["FULFILLED"],y=["PENDING"];function g(d){if(typeof d!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,d!==m&&i(this,d)}function _(d,b,S){this.promise=d,typeof b=="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function n(d,b,S){s(function(){var D;try{D=b(S)}catch(x){return e.reject(d,x)}D===d?e.reject(d,new TypeError("Cannot resolve promise with itself")):e.resolve(d,D)})}function C(d){var b=d&&d.then;if(d&&(typeof d=="object"||typeof d=="function")&&typeof b=="function")return function(){b.apply(d,arguments)}}function i(d,b){var S=!1;function D(A){S||(S=!0,e.reject(d,A))}function x(A){S||(S=!0,e.resolve(d,A))}var O=h(function(){b(x,D)});O.status==="error"&&D(O.value)}function h(d,b){var S={};try{S.value=d(b),S.status="success"}catch(D){S.status="error",S.value=D}return S}(w.exports=g).prototype.finally=function(d){if(typeof d!="function")return this;var b=this.constructor;return this.then(function(S){return b.resolve(d()).then(function(){return S})},function(S){return b.resolve(d()).then(function(){throw S})})},g.prototype.catch=function(d){return this.then(null,d)},g.prototype.then=function(d,b){if(typeof d!="function"&&this.state===v||typeof b!="function"&&this.state===c)return this;var S=new this.constructor(m);return this.state!==y?n(S,this.state===v?d:b,this.outcome):this.queue.push(new _(S,d,b)),S},_.prototype.callFulfilled=function(d){e.resolve(this.promise,d)},_.prototype.otherCallFulfilled=function(d){n(this.promise,this.onFulfilled,d)},_.prototype.callRejected=function(d){e.reject(this.promise,d)},_.prototype.otherCallRejected=function(d){n(this.promise,this.onRejected,d)},e.resolve=function(d,b){var S=h(C,b);if(S.status==="error")return e.reject(d,S.value);var D=S.value;if(D)i(d,D);else{d.state=v,d.outcome=b;for(var x=-1,O=d.queue.length;++x<O;)d.queue[x].callFulfilled(b)}return d},e.reject=function(d,b){d.state=c,d.outcome=b;for(var S=-1,D=d.queue.length;++S<D;)d.queue[S].callRejected(b);return d},g.resolve=function(d){return d instanceof this?d:e.resolve(new this(m),d)},g.reject=function(d){var b=new this(m);return e.reject(b,d)},g.all=function(d){var b=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,D=!1;if(!S)return this.resolve([]);for(var x=new Array(S),O=0,A=-1,j=new this(m);++A<S;)N(d[A],A);return j;function N(Z,ae){b.resolve(Z).then(function(E){x[ae]=E,++O!==S||D||(D=!0,e.resolve(j,x))},function(E){D||(D=!0,e.reject(j,E))})}},g.race=function(d){var b=this;if(Object.prototype.toString.call(d)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=d.length,D=!1;if(!S)return this.resolve([]);for(var x=-1,O=new this(m);++x<S;)A=d[x],b.resolve(A).then(function(j){D||(D=!0,e.resolve(O,j))},function(j){D||(D=!0,e.reject(O,j))});var A;return O}},{immediate:36}],38:[function(p,w,a){var s={};(0,p("./lib/utils/common").assign)(s,p("./lib/deflate"),p("./lib/inflate"),p("./lib/zlib/constants")),w.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(p,w,a){var s=p("./zlib/deflate"),m=p("./utils/common"),e=p("./utils/strings"),c=p("./zlib/messages"),v=p("./zlib/zstream"),y=Object.prototype.toString,g=0,_=-1,n=0,C=8;function i(d){if(!(this instanceof i))return new i(d);this.options=m.assign({level:_,method:C,chunkSize:16384,windowBits:15,memLevel:8,strategy:n,to:""},d||{});var b=this.options;b.raw&&0<b.windowBits?b.windowBits=-b.windowBits:b.gzip&&0<b.windowBits&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var S=s.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(S!==g)throw new Error(c[S]);if(b.header&&s.deflateSetHeader(this.strm,b.header),b.dictionary){var D;if(D=typeof b.dictionary=="string"?e.string2buf(b.dictionary):y.call(b.dictionary)==="[object ArrayBuffer]"?new Uint8Array(b.dictionary):b.dictionary,(S=s.deflateSetDictionary(this.strm,D))!==g)throw new Error(c[S]);this._dict_set=!0}}function h(d,b){var S=new i(b);if(S.push(d,!0),S.err)throw S.msg||c[S.err];return S.result}i.prototype.push=function(d,b){var S,D,x=this.strm,O=this.options.chunkSize;if(this.ended)return!1;D=b===~~b?b:b===!0?4:0,typeof d=="string"?x.input=e.string2buf(d):y.call(d)==="[object ArrayBuffer]"?x.input=new Uint8Array(d):x.input=d,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new m.Buf8(O),x.next_out=0,x.avail_out=O),(S=s.deflate(x,D))!==1&&S!==g)return this.onEnd(S),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||D!==4&&D!==2)||(this.options.to==="string"?this.onData(e.buf2binstring(m.shrinkBuf(x.output,x.next_out))):this.onData(m.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&S!==1);return D===4?(S=s.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===g):D!==2||(this.onEnd(g),!(x.avail_out=0))},i.prototype.onData=function(d){this.chunks.push(d)},i.prototype.onEnd=function(d){d===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},a.Deflate=i,a.deflate=h,a.deflateRaw=function(d,b){return(b=b||{}).raw=!0,h(d,b)},a.gzip=function(d,b){return(b=b||{}).gzip=!0,h(d,b)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(p,w,a){var s=p("./zlib/inflate"),m=p("./utils/common"),e=p("./utils/strings"),c=p("./zlib/constants"),v=p("./zlib/messages"),y=p("./zlib/zstream"),g=p("./zlib/gzheader"),_=Object.prototype.toString;function n(i){if(!(this instanceof n))return new n(i);this.options=m.assign({chunkSize:16384,windowBits:0,to:""},i||{});var h=this.options;h.raw&&0<=h.windowBits&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),!(0<=h.windowBits&&h.windowBits<16)||i&&i.windowBits||(h.windowBits+=32),15<h.windowBits&&h.windowBits<48&&(15&h.windowBits)==0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var d=s.inflateInit2(this.strm,h.windowBits);if(d!==c.Z_OK)throw new Error(v[d]);this.header=new g,s.inflateGetHeader(this.strm,this.header)}function C(i,h){var d=new n(h);if(d.push(i,!0),d.err)throw d.msg||v[d.err];return d.result}n.prototype.push=function(i,h){var d,b,S,D,x,O,A=this.strm,j=this.options.chunkSize,N=this.options.dictionary,Z=!1;if(this.ended)return!1;b=h===~~h?h:h===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof i=="string"?A.input=e.binstring2buf(i):_.call(i)==="[object ArrayBuffer]"?A.input=new Uint8Array(i):A.input=i,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new m.Buf8(j),A.next_out=0,A.avail_out=j),(d=s.inflate(A,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&N&&(O=typeof N=="string"?e.string2buf(N):_.call(N)==="[object ArrayBuffer]"?new Uint8Array(N):N,d=s.inflateSetDictionary(this.strm,O)),d===c.Z_BUF_ERROR&&Z===!0&&(d=c.Z_OK,Z=!1),d!==c.Z_STREAM_END&&d!==c.Z_OK)return this.onEnd(d),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&d!==c.Z_STREAM_END&&(A.avail_in!==0||b!==c.Z_FINISH&&b!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=e.utf8border(A.output,A.next_out),D=A.next_out-S,x=e.buf2string(A.output,S),A.next_out=D,A.avail_out=j-D,D&&m.arraySet(A.output,A.output,S,D,0),this.onData(x)):this.onData(m.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(Z=!0)}while((0<A.avail_in||A.avail_out===0)&&d!==c.Z_STREAM_END);return d===c.Z_STREAM_END&&(b=c.Z_FINISH),b===c.Z_FINISH?(d=s.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,d===c.Z_OK):b!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(A.avail_out=0))},n.prototype.onData=function(i){this.chunks.push(i)},n.prototype.onEnd=function(i){i===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg},a.Inflate=n,a.inflate=C,a.inflateRaw=function(i,h){return(h=h||{}).raw=!0,C(i,h)},a.ungzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(p,w,a){var s=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";a.assign=function(c){for(var v=Array.prototype.slice.call(arguments,1);v.length;){var y=v.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var g in y)y.hasOwnProperty(g)&&(c[g]=y[g])}}return c},a.shrinkBuf=function(c,v){return c.length===v?c:c.subarray?c.subarray(0,v):(c.length=v,c)};var m={arraySet:function(c,v,y,g,_){if(v.subarray&&c.subarray)c.set(v.subarray(y,y+g),_);else for(var n=0;n<g;n++)c[_+n]=v[y+n]},flattenChunks:function(c){var v,y,g,_,n,C;for(v=g=0,y=c.length;v<y;v++)g+=c[v].length;for(C=new Uint8Array(g),v=_=0,y=c.length;v<y;v++)n=c[v],C.set(n,_),_+=n.length;return C}},e={arraySet:function(c,v,y,g,_){for(var n=0;n<g;n++)c[_+n]=v[y+n]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,m)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,e))},a.setTyped(s)},{}],42:[function(p,w,a){var s=p("./common"),m=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch{m=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e=!1}for(var c=new s.Buf8(256),v=0;v<256;v++)c[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;function y(g,_){if(_<65537&&(g.subarray&&e||!g.subarray&&m))return String.fromCharCode.apply(null,s.shrinkBuf(g,_));for(var n="",C=0;C<_;C++)n+=String.fromCharCode(g[C]);return n}c[254]=c[254]=1,a.string2buf=function(g){var _,n,C,i,h,d=g.length,b=0;for(i=0;i<d;i++)(64512&(n=g.charCodeAt(i)))==55296&&i+1<d&&(64512&(C=g.charCodeAt(i+1)))==56320&&(n=65536+(n-55296<<10)+(C-56320),i++),b+=n<128?1:n<2048?2:n<65536?3:4;for(_=new s.Buf8(b),i=h=0;h<b;i++)(64512&(n=g.charCodeAt(i)))==55296&&i+1<d&&(64512&(C=g.charCodeAt(i+1)))==56320&&(n=65536+(n-55296<<10)+(C-56320),i++),n<128?_[h++]=n:(n<2048?_[h++]=192|n>>>6:(n<65536?_[h++]=224|n>>>12:(_[h++]=240|n>>>18,_[h++]=128|n>>>12&63),_[h++]=128|n>>>6&63),_[h++]=128|63&n);return _},a.buf2binstring=function(g){return y(g,g.length)},a.binstring2buf=function(g){for(var _=new s.Buf8(g.length),n=0,C=_.length;n<C;n++)_[n]=g.charCodeAt(n);return _},a.buf2string=function(g,_){var n,C,i,h,d=_||g.length,b=new Array(2*d);for(n=C=0;n<d;)if((i=g[n++])<128)b[C++]=i;else if(4<(h=c[i]))b[C++]=65533,n+=h-1;else{for(i&=h===2?31:h===3?15:7;1<h&&n<d;)i=i<<6|63&g[n++],h--;1<h?b[C++]=65533:i<65536?b[C++]=i:(i-=65536,b[C++]=55296|i>>10&1023,b[C++]=56320|1023&i)}return y(b,C)},a.utf8border=function(g,_){var n;for((_=_||g.length)>g.length&&(_=g.length),n=_-1;0<=n&&(192&g[n])==128;)n--;return n<0||n===0?_:n+c[g[n]]>_?n:_}},{"./common":41}],43:[function(p,w,a){w.exports=function(s,m,e,c){for(var v=65535&s|0,y=s>>>16&65535|0,g=0;e!==0;){for(e-=g=2e3<e?2e3:e;y=y+(v=v+m[c++]|0)|0,--g;);v%=65521,y%=65521}return v|y<<16|0}},{}],44:[function(p,w,a){w.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(p,w,a){var s=function(){for(var m,e=[],c=0;c<256;c++){m=c;for(var v=0;v<8;v++)m=1&m?3988292384^m>>>1:m>>>1;e[c]=m}return e}();w.exports=function(m,e,c,v){var y=s,g=v+c;m^=-1;for(var _=v;_<g;_++)m=m>>>8^y[255&(m^e[_])];return-1^m}},{}],46:[function(p,w,a){var s,m=p("../utils/common"),e=p("./trees"),c=p("./adler32"),v=p("./crc32"),y=p("./messages"),g=0,_=4,n=0,C=-2,i=-1,h=4,d=2,b=8,S=9,D=286,x=30,O=19,A=2*D+1,j=15,N=3,Z=258,ae=Z+N+1,E=42,q=113,f=1,R=2,le=3,H=4;function de(u,U){return u.msg=y[U],U}function X(u){return(u<<1)-(4<u?9:0)}function se(u){for(var U=u.length;0<=--U;)u[U]=0}function F(u){var U=u.state,T=U.pending;T>u.avail_out&&(T=u.avail_out),T!==0&&(m.arraySet(u.output,U.pending_buf,U.pending_out,T,u.next_out),u.next_out+=T,U.pending_out+=T,u.total_out+=T,u.avail_out-=T,U.pending-=T,U.pending===0&&(U.pending_out=0))}function z(u,U){e._tr_flush_block(u,0<=u.block_start?u.block_start:-1,u.strstart-u.block_start,U),u.block_start=u.strstart,F(u.strm)}function re(u,U){u.pending_buf[u.pending++]=U}function ee(u,U){u.pending_buf[u.pending++]=U>>>8&255,u.pending_buf[u.pending++]=255&U}function Q(u,U){var T,k,I=u.max_chain_length,V=u.strstart,L=u.prev_length,M=u.nice_match,P=u.strstart>u.w_size-ae?u.strstart-(u.w_size-ae):0,W=u.window,te=u.w_mask,G=u.prev,oe=u.strstart+Z,ye=W[V+L-1],me=W[V+L];u.prev_length>=u.good_match&&(I>>=2),M>u.lookahead&&(M=u.lookahead);do if(W[(T=U)+L]===me&&W[T+L-1]===ye&&W[T]===W[V]&&W[++T]===W[V+1]){V+=2,T++;do;while(W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&W[++V]===W[++T]&&V<oe);if(k=Z-(oe-V),V=oe-Z,L<k){if(u.match_start=U,M<=(L=k))break;ye=W[V+L-1],me=W[V+L]}}while((U=G[U&te])>P&&--I!=0);return L<=u.lookahead?L:u.lookahead}function we(u){var U,T,k,I,V,L,M,P,W,te,G=u.w_size;do{if(I=u.window_size-u.lookahead-u.strstart,u.strstart>=G+(G-ae)){for(m.arraySet(u.window,u.window,G,G,0),u.match_start-=G,u.strstart-=G,u.block_start-=G,U=T=u.hash_size;k=u.head[--U],u.head[U]=G<=k?k-G:0,--T;);for(U=T=G;k=u.prev[--U],u.prev[U]=G<=k?k-G:0,--T;);I+=G}if(u.strm.avail_in===0)break;if(L=u.strm,M=u.window,P=u.strstart+u.lookahead,W=I,te=void 0,te=L.avail_in,W<te&&(te=W),T=te===0?0:(L.avail_in-=te,m.arraySet(M,L.input,L.next_in,te,P),L.state.wrap===1?L.adler=c(L.adler,M,te,P):L.state.wrap===2&&(L.adler=v(L.adler,M,te,P)),L.next_in+=te,L.total_in+=te,te),u.lookahead+=T,u.lookahead+u.insert>=N)for(V=u.strstart-u.insert,u.ins_h=u.window[V],u.ins_h=(u.ins_h<<u.hash_shift^u.window[V+1])&u.hash_mask;u.insert&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[V+N-1])&u.hash_mask,u.prev[V&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=V,V++,u.insert--,!(u.lookahead+u.insert<N)););}while(u.lookahead<ae&&u.strm.avail_in!==0)}function Ee(u,U){for(var T,k;;){if(u.lookahead<ae){if(we(u),u.lookahead<ae&&U===g)return f;if(u.lookahead===0)break}if(T=0,u.lookahead>=N&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+N-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),T!==0&&u.strstart-T<=u.w_size-ae&&(u.match_length=Q(u,T)),u.match_length>=N)if(k=e._tr_tally(u,u.strstart-u.match_start,u.match_length-N),u.lookahead-=u.match_length,u.match_length<=u.max_lazy_match&&u.lookahead>=N){for(u.match_length--;u.strstart++,u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+N-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart,--u.match_length!=0;);u.strstart++}else u.strstart+=u.match_length,u.match_length=0,u.ins_h=u.window[u.strstart],u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+1])&u.hash_mask;else k=e._tr_tally(u,0,u.window[u.strstart]),u.lookahead--,u.strstart++;if(k&&(z(u,!1),u.strm.avail_out===0))return f}return u.insert=u.strstart<N-1?u.strstart:N-1,U===_?(z(u,!0),u.strm.avail_out===0?le:H):u.last_lit&&(z(u,!1),u.strm.avail_out===0)?f:R}function ce(u,U){for(var T,k,I;;){if(u.lookahead<ae){if(we(u),u.lookahead<ae&&U===g)return f;if(u.lookahead===0)break}if(T=0,u.lookahead>=N&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+N-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),u.prev_length=u.match_length,u.prev_match=u.match_start,u.match_length=N-1,T!==0&&u.prev_length<u.max_lazy_match&&u.strstart-T<=u.w_size-ae&&(u.match_length=Q(u,T),u.match_length<=5&&(u.strategy===1||u.match_length===N&&4096<u.strstart-u.match_start)&&(u.match_length=N-1)),u.prev_length>=N&&u.match_length<=u.prev_length){for(I=u.strstart+u.lookahead-N,k=e._tr_tally(u,u.strstart-1-u.prev_match,u.prev_length-N),u.lookahead-=u.prev_length-1,u.prev_length-=2;++u.strstart<=I&&(u.ins_h=(u.ins_h<<u.hash_shift^u.window[u.strstart+N-1])&u.hash_mask,T=u.prev[u.strstart&u.w_mask]=u.head[u.ins_h],u.head[u.ins_h]=u.strstart),--u.prev_length!=0;);if(u.match_available=0,u.match_length=N-1,u.strstart++,k&&(z(u,!1),u.strm.avail_out===0))return f}else if(u.match_available){if((k=e._tr_tally(u,0,u.window[u.strstart-1]))&&z(u,!1),u.strstart++,u.lookahead--,u.strm.avail_out===0)return f}else u.match_available=1,u.strstart++,u.lookahead--}return u.match_available&&(k=e._tr_tally(u,0,u.window[u.strstart-1]),u.match_available=0),u.insert=u.strstart<N-1?u.strstart:N-1,U===_?(z(u,!0),u.strm.avail_out===0?le:H):u.last_lit&&(z(u,!1),u.strm.avail_out===0)?f:R}function ge(u,U,T,k,I){this.good_length=u,this.max_lazy=U,this.nice_length=T,this.max_chain=k,this.func=I}function ke(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=b,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new m.Buf16(2*A),this.dyn_dtree=new m.Buf16(2*(2*x+1)),this.bl_tree=new m.Buf16(2*(2*O+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new m.Buf16(j+1),this.heap=new m.Buf16(2*D+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new m.Buf16(2*D+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ie(u){var U;return u&&u.state?(u.total_in=u.total_out=0,u.data_type=d,(U=u.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?E:q,u.adler=U.wrap===2?0:1,U.last_flush=g,e._tr_init(U),n):de(u,C)}function Ae(u){var U=Ie(u);return U===n&&function(T){T.window_size=2*T.w_size,se(T.head),T.max_lazy_match=s[T.level].max_lazy,T.good_match=s[T.level].good_length,T.nice_match=s[T.level].nice_length,T.max_chain_length=s[T.level].max_chain,T.strstart=0,T.block_start=0,T.lookahead=0,T.insert=0,T.match_length=T.prev_length=N-1,T.match_available=0,T.ins_h=0}(u.state),U}function Fe(u,U,T,k,I,V){if(!u)return C;var L=1;if(U===i&&(U=6),k<0?(L=0,k=-k):15<k&&(L=2,k-=16),I<1||S<I||T!==b||k<8||15<k||U<0||9<U||V<0||h<V)return de(u,C);k===8&&(k=9);var M=new ke;return(u.state=M).strm=u,M.wrap=L,M.gzhead=null,M.w_bits=k,M.w_size=1<<M.w_bits,M.w_mask=M.w_size-1,M.hash_bits=I+7,M.hash_size=1<<M.hash_bits,M.hash_mask=M.hash_size-1,M.hash_shift=~~((M.hash_bits+N-1)/N),M.window=new m.Buf8(2*M.w_size),M.head=new m.Buf16(M.hash_size),M.prev=new m.Buf16(M.w_size),M.lit_bufsize=1<<I+6,M.pending_buf_size=4*M.lit_bufsize,M.pending_buf=new m.Buf8(M.pending_buf_size),M.d_buf=1*M.lit_bufsize,M.l_buf=3*M.lit_bufsize,M.level=U,M.strategy=V,M.method=T,Ae(u)}s=[new ge(0,0,0,0,function(u,U){var T=65535;for(T>u.pending_buf_size-5&&(T=u.pending_buf_size-5);;){if(u.lookahead<=1){if(we(u),u.lookahead===0&&U===g)return f;if(u.lookahead===0)break}u.strstart+=u.lookahead,u.lookahead=0;var k=u.block_start+T;if((u.strstart===0||u.strstart>=k)&&(u.lookahead=u.strstart-k,u.strstart=k,z(u,!1),u.strm.avail_out===0)||u.strstart-u.block_start>=u.w_size-ae&&(z(u,!1),u.strm.avail_out===0))return f}return u.insert=0,U===_?(z(u,!0),u.strm.avail_out===0?le:H):(u.strstart>u.block_start&&(z(u,!1),u.strm.avail_out),f)}),new ge(4,4,8,4,Ee),new ge(4,5,16,8,Ee),new ge(4,6,32,32,Ee),new ge(4,4,16,16,ce),new ge(8,16,32,32,ce),new ge(8,16,128,128,ce),new ge(8,32,128,256,ce),new ge(32,128,258,1024,ce),new ge(32,258,258,4096,ce)],a.deflateInit=function(u,U){return Fe(u,U,b,15,8,0)},a.deflateInit2=Fe,a.deflateReset=Ae,a.deflateResetKeep=Ie,a.deflateSetHeader=function(u,U){return u&&u.state?u.state.wrap!==2?C:(u.state.gzhead=U,n):C},a.deflate=function(u,U){var T,k,I,V;if(!u||!u.state||5<U||U<0)return u?de(u,C):C;if(k=u.state,!u.output||!u.input&&u.avail_in!==0||k.status===666&&U!==_)return de(u,u.avail_out===0?-5:C);if(k.strm=u,T=k.last_flush,k.last_flush=U,k.status===E)if(k.wrap===2)u.adler=0,re(k,31),re(k,139),re(k,8),k.gzhead?(re(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),re(k,255&k.gzhead.time),re(k,k.gzhead.time>>8&255),re(k,k.gzhead.time>>16&255),re(k,k.gzhead.time>>24&255),re(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),re(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&(re(k,255&k.gzhead.extra.length),re(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(u.adler=v(u.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(re(k,0),re(k,0),re(k,0),re(k,0),re(k,0),re(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),re(k,3),k.status=q);else{var L=b+(k.w_bits-8<<4)<<8;L|=(2<=k.strategy||k.level<2?0:k.level<6?1:k.level===6?2:3)<<6,k.strstart!==0&&(L|=32),L+=31-L%31,k.status=q,ee(k,L),k.strstart!==0&&(ee(k,u.adler>>>16),ee(k,65535&u.adler)),u.adler=1}if(k.status===69)if(k.gzhead.extra){for(I=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>I&&(u.adler=v(u.adler,k.pending_buf,k.pending-I,I)),F(u),I=k.pending,k.pending!==k.pending_buf_size));)re(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>I&&(u.adler=v(u.adler,k.pending_buf,k.pending-I,I)),k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(k.status===73)if(k.gzhead.name){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(u.adler=v(u.adler,k.pending_buf,k.pending-I,I)),F(u),I=k.pending,k.pending===k.pending_buf_size)){V=1;break}V=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0,re(k,V)}while(V!==0);k.gzhead.hcrc&&k.pending>I&&(u.adler=v(u.adler,k.pending_buf,k.pending-I,I)),V===0&&(k.gzindex=0,k.status=91)}else k.status=91;if(k.status===91)if(k.gzhead.comment){I=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>I&&(u.adler=v(u.adler,k.pending_buf,k.pending-I,I)),F(u),I=k.pending,k.pending===k.pending_buf_size)){V=1;break}V=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0,re(k,V)}while(V!==0);k.gzhead.hcrc&&k.pending>I&&(u.adler=v(u.adler,k.pending_buf,k.pending-I,I)),V===0&&(k.status=103)}else k.status=103;if(k.status===103&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&F(u),k.pending+2<=k.pending_buf_size&&(re(k,255&u.adler),re(k,u.adler>>8&255),u.adler=0,k.status=q)):k.status=q),k.pending!==0){if(F(u),u.avail_out===0)return k.last_flush=-1,n}else if(u.avail_in===0&&X(U)<=X(T)&&U!==_)return de(u,-5);if(k.status===666&&u.avail_in!==0)return de(u,-5);if(u.avail_in!==0||k.lookahead!==0||U!==g&&k.status!==666){var M=k.strategy===2?function(P,W){for(var te;;){if(P.lookahead===0&&(we(P),P.lookahead===0)){if(W===g)return f;break}if(P.match_length=0,te=e._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,te&&(z(P,!1),P.strm.avail_out===0))return f}return P.insert=0,W===_?(z(P,!0),P.strm.avail_out===0?le:H):P.last_lit&&(z(P,!1),P.strm.avail_out===0)?f:R}(k,U):k.strategy===3?function(P,W){for(var te,G,oe,ye,me=P.window;;){if(P.lookahead<=Z){if(we(P),P.lookahead<=Z&&W===g)return f;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=N&&0<P.strstart&&(G=me[oe=P.strstart-1])===me[++oe]&&G===me[++oe]&&G===me[++oe]){ye=P.strstart+Z;do;while(G===me[++oe]&&G===me[++oe]&&G===me[++oe]&&G===me[++oe]&&G===me[++oe]&&G===me[++oe]&&G===me[++oe]&&G===me[++oe]&&oe<ye);P.match_length=Z-(ye-oe),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=N?(te=e._tr_tally(P,1,P.match_length-N),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(te=e._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),te&&(z(P,!1),P.strm.avail_out===0))return f}return P.insert=0,W===_?(z(P,!0),P.strm.avail_out===0?le:H):P.last_lit&&(z(P,!1),P.strm.avail_out===0)?f:R}(k,U):s[k.level].func(k,U);if(M!==le&&M!==H||(k.status=666),M===f||M===le)return u.avail_out===0&&(k.last_flush=-1),n;if(M===R&&(U===1?e._tr_align(k):U!==5&&(e._tr_stored_block(k,0,0,!1),U===3&&(se(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0))),F(u),u.avail_out===0))return k.last_flush=-1,n}return U!==_?n:k.wrap<=0?1:(k.wrap===2?(re(k,255&u.adler),re(k,u.adler>>8&255),re(k,u.adler>>16&255),re(k,u.adler>>24&255),re(k,255&u.total_in),re(k,u.total_in>>8&255),re(k,u.total_in>>16&255),re(k,u.total_in>>24&255)):(ee(k,u.adler>>>16),ee(k,65535&u.adler)),F(u),0<k.wrap&&(k.wrap=-k.wrap),k.pending!==0?n:1)},a.deflateEnd=function(u){var U;return u&&u.state?(U=u.state.status)!==E&&U!==69&&U!==73&&U!==91&&U!==103&&U!==q&&U!==666?de(u,C):(u.state=null,U===q?de(u,-3):n):C},a.deflateSetDictionary=function(u,U){var T,k,I,V,L,M,P,W,te=U.length;if(!u||!u.state||(V=(T=u.state).wrap)===2||V===1&&T.status!==E||T.lookahead)return C;for(V===1&&(u.adler=c(u.adler,U,te,0)),T.wrap=0,te>=T.w_size&&(V===0&&(se(T.head),T.strstart=0,T.block_start=0,T.insert=0),W=new m.Buf8(T.w_size),m.arraySet(W,U,te-T.w_size,T.w_size,0),U=W,te=T.w_size),L=u.avail_in,M=u.next_in,P=u.input,u.avail_in=te,u.next_in=0,u.input=U,we(T);T.lookahead>=N;){for(k=T.strstart,I=T.lookahead-(N-1);T.ins_h=(T.ins_h<<T.hash_shift^T.window[k+N-1])&T.hash_mask,T.prev[k&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=k,k++,--I;);T.strstart=k,T.lookahead=N-1,we(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=N-1,T.match_available=0,u.next_in=M,u.input=P,u.avail_in=L,T.wrap=V,n},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(p,w,a){w.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(p,w,a){w.exports=function(s,m){var e,c,v,y,g,_,n,C,i,h,d,b,S,D,x,O,A,j,N,Z,ae,E,q,f,R;e=s.state,c=s.next_in,f=s.input,v=c+(s.avail_in-5),y=s.next_out,R=s.output,g=y-(m-s.avail_out),_=y+(s.avail_out-257),n=e.dmax,C=e.wsize,i=e.whave,h=e.wnext,d=e.window,b=e.hold,S=e.bits,D=e.lencode,x=e.distcode,O=(1<<e.lenbits)-1,A=(1<<e.distbits)-1;e:do{S<15&&(b+=f[c++]<<S,S+=8,b+=f[c++]<<S,S+=8),j=D[b&O];t:for(;;){if(b>>>=N=j>>>24,S-=N,(N=j>>>16&255)===0)R[y++]=65535&j;else{if(!(16&N)){if((64&N)==0){j=D[(65535&j)+(b&(1<<N)-1)];continue t}if(32&N){e.mode=12;break e}s.msg="invalid literal/length code",e.mode=30;break e}Z=65535&j,(N&=15)&&(S<N&&(b+=f[c++]<<S,S+=8),Z+=b&(1<<N)-1,b>>>=N,S-=N),S<15&&(b+=f[c++]<<S,S+=8,b+=f[c++]<<S,S+=8),j=x[b&A];a:for(;;){if(b>>>=N=j>>>24,S-=N,!(16&(N=j>>>16&255))){if((64&N)==0){j=x[(65535&j)+(b&(1<<N)-1)];continue a}s.msg="invalid distance code",e.mode=30;break e}if(ae=65535&j,S<(N&=15)&&(b+=f[c++]<<S,(S+=8)<N&&(b+=f[c++]<<S,S+=8)),n<(ae+=b&(1<<N)-1)){s.msg="invalid distance too far back",e.mode=30;break e}if(b>>>=N,S-=N,(N=y-g)<ae){if(i<(N=ae-N)&&e.sane){s.msg="invalid distance too far back",e.mode=30;break e}if(q=d,(E=0)===h){if(E+=C-N,N<Z){for(Z-=N;R[y++]=d[E++],--N;);E=y-ae,q=R}}else if(h<N){if(E+=C+h-N,(N-=h)<Z){for(Z-=N;R[y++]=d[E++],--N;);if(E=0,h<Z){for(Z-=N=h;R[y++]=d[E++],--N;);E=y-ae,q=R}}}else if(E+=h-N,N<Z){for(Z-=N;R[y++]=d[E++],--N;);E=y-ae,q=R}for(;2<Z;)R[y++]=q[E++],R[y++]=q[E++],R[y++]=q[E++],Z-=3;Z&&(R[y++]=q[E++],1<Z&&(R[y++]=q[E++]))}else{for(E=y-ae;R[y++]=R[E++],R[y++]=R[E++],R[y++]=R[E++],2<(Z-=3););Z&&(R[y++]=R[E++],1<Z&&(R[y++]=R[E++]))}break}}break}}while(c<v&&y<_);c-=Z=S>>3,b&=(1<<(S-=Z<<3))-1,s.next_in=c,s.next_out=y,s.avail_in=c<v?v-c+5:5-(c-v),s.avail_out=y<_?_-y+257:257-(y-_),e.hold=b,e.bits=S}},{}],49:[function(p,w,a){var s=p("../utils/common"),m=p("./adler32"),e=p("./crc32"),c=p("./inffast"),v=p("./inftrees"),y=1,g=2,_=0,n=-2,C=1,i=852,h=592;function d(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(E){var q;return E&&E.state?(q=E.state,E.total_in=E.total_out=q.total=0,E.msg="",q.wrap&&(E.adler=1&q.wrap),q.mode=C,q.last=0,q.havedict=0,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new s.Buf32(i),q.distcode=q.distdyn=new s.Buf32(h),q.sane=1,q.back=-1,_):n}function D(E){var q;return E&&E.state?((q=E.state).wsize=0,q.whave=0,q.wnext=0,S(E)):n}function x(E,q){var f,R;return E&&E.state?(R=E.state,q<0?(f=0,q=-q):(f=1+(q>>4),q<48&&(q&=15)),q&&(q<8||15<q)?n:(R.window!==null&&R.wbits!==q&&(R.window=null),R.wrap=f,R.wbits=q,D(E))):n}function O(E,q){var f,R;return E?(R=new b,(E.state=R).window=null,(f=x(E,q))!==_&&(E.state=null),f):n}var A,j,N=!0;function Z(E){if(N){var q;for(A=new s.Buf32(512),j=new s.Buf32(32),q=0;q<144;)E.lens[q++]=8;for(;q<256;)E.lens[q++]=9;for(;q<280;)E.lens[q++]=7;for(;q<288;)E.lens[q++]=8;for(v(y,E.lens,0,288,A,0,E.work,{bits:9}),q=0;q<32;)E.lens[q++]=5;v(g,E.lens,0,32,j,0,E.work,{bits:5}),N=!1}E.lencode=A,E.lenbits=9,E.distcode=j,E.distbits=5}function ae(E,q,f,R){var le,H=E.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new s.Buf8(H.wsize)),R>=H.wsize?(s.arraySet(H.window,q,f-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(R<(le=H.wsize-H.wnext)&&(le=R),s.arraySet(H.window,q,f-R,le,H.wnext),(R-=le)?(s.arraySet(H.window,q,f-R,R,0),H.wnext=R,H.whave=H.wsize):(H.wnext+=le,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=le))),0}a.inflateReset=D,a.inflateReset2=x,a.inflateResetKeep=S,a.inflateInit=function(E){return O(E,15)},a.inflateInit2=O,a.inflate=function(E,q){var f,R,le,H,de,X,se,F,z,re,ee,Q,we,Ee,ce,ge,ke,Ie,Ae,Fe,u,U,T,k,I=0,V=new s.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return n;(f=E.state).mode===12&&(f.mode=13),de=E.next_out,le=E.output,se=E.avail_out,H=E.next_in,R=E.input,X=E.avail_in,F=f.hold,z=f.bits,re=X,ee=se,U=_;e:for(;;)switch(f.mode){case C:if(f.wrap===0){f.mode=13;break}for(;z<16;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(2&f.wrap&&F===35615){V[f.check=0]=255&F,V[1]=F>>>8&255,f.check=e(f.check,V,2,0),z=F=0,f.mode=2;break}if(f.flags=0,f.head&&(f.head.done=!1),!(1&f.wrap)||(((255&F)<<8)+(F>>8))%31){E.msg="incorrect header check",f.mode=30;break}if((15&F)!=8){E.msg="unknown compression method",f.mode=30;break}if(z-=4,u=8+(15&(F>>>=4)),f.wbits===0)f.wbits=u;else if(u>f.wbits){E.msg="invalid window size",f.mode=30;break}f.dmax=1<<u,E.adler=f.check=1,f.mode=512&F?10:12,z=F=0;break;case 2:for(;z<16;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(f.flags=F,(255&f.flags)!=8){E.msg="unknown compression method",f.mode=30;break}if(57344&f.flags){E.msg="unknown header flags set",f.mode=30;break}f.head&&(f.head.text=F>>8&1),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,f.check=e(f.check,V,2,0)),z=F=0,f.mode=3;case 3:for(;z<32;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}f.head&&(f.head.time=F),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,V[2]=F>>>16&255,V[3]=F>>>24&255,f.check=e(f.check,V,4,0)),z=F=0,f.mode=4;case 4:for(;z<16;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}f.head&&(f.head.xflags=255&F,f.head.os=F>>8),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,f.check=e(f.check,V,2,0)),z=F=0,f.mode=5;case 5:if(1024&f.flags){for(;z<16;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}f.length=F,f.head&&(f.head.extra_len=F),512&f.flags&&(V[0]=255&F,V[1]=F>>>8&255,f.check=e(f.check,V,2,0)),z=F=0}else f.head&&(f.head.extra=null);f.mode=6;case 6:if(1024&f.flags&&(X<(Q=f.length)&&(Q=X),Q&&(f.head&&(u=f.head.extra_len-f.length,f.head.extra||(f.head.extra=new Array(f.head.extra_len)),s.arraySet(f.head.extra,R,H,Q,u)),512&f.flags&&(f.check=e(f.check,R,Q,H)),X-=Q,H+=Q,f.length-=Q),f.length))break e;f.length=0,f.mode=7;case 7:if(2048&f.flags){if(X===0)break e;for(Q=0;u=R[H+Q++],f.head&&u&&f.length<65536&&(f.head.name+=String.fromCharCode(u)),u&&Q<X;);if(512&f.flags&&(f.check=e(f.check,R,Q,H)),X-=Q,H+=Q,u)break e}else f.head&&(f.head.name=null);f.length=0,f.mode=8;case 8:if(4096&f.flags){if(X===0)break e;for(Q=0;u=R[H+Q++],f.head&&u&&f.length<65536&&(f.head.comment+=String.fromCharCode(u)),u&&Q<X;);if(512&f.flags&&(f.check=e(f.check,R,Q,H)),X-=Q,H+=Q,u)break e}else f.head&&(f.head.comment=null);f.mode=9;case 9:if(512&f.flags){for(;z<16;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(F!==(65535&f.check)){E.msg="header crc mismatch",f.mode=30;break}z=F=0}f.head&&(f.head.hcrc=f.flags>>9&1,f.head.done=!0),E.adler=f.check=0,f.mode=12;break;case 10:for(;z<32;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}E.adler=f.check=d(F),z=F=0,f.mode=11;case 11:if(f.havedict===0)return E.next_out=de,E.avail_out=se,E.next_in=H,E.avail_in=X,f.hold=F,f.bits=z,2;E.adler=f.check=1,f.mode=12;case 12:if(q===5||q===6)break e;case 13:if(f.last){F>>>=7&z,z-=7&z,f.mode=27;break}for(;z<3;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}switch(f.last=1&F,z-=1,3&(F>>>=1)){case 0:f.mode=14;break;case 1:if(Z(f),f.mode=20,q!==6)break;F>>>=2,z-=2;break e;case 2:f.mode=17;break;case 3:E.msg="invalid block type",f.mode=30}F>>>=2,z-=2;break;case 14:for(F>>>=7&z,z-=7&z;z<32;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if((65535&F)!=(F>>>16^65535)){E.msg="invalid stored block lengths",f.mode=30;break}if(f.length=65535&F,z=F=0,f.mode=15,q===6)break e;case 15:f.mode=16;case 16:if(Q=f.length){if(X<Q&&(Q=X),se<Q&&(Q=se),Q===0)break e;s.arraySet(le,R,H,Q,de),X-=Q,H+=Q,se-=Q,de+=Q,f.length-=Q;break}f.mode=12;break;case 17:for(;z<14;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(f.nlen=257+(31&F),F>>>=5,z-=5,f.ndist=1+(31&F),F>>>=5,z-=5,f.ncode=4+(15&F),F>>>=4,z-=4,286<f.nlen||30<f.ndist){E.msg="too many length or distance symbols",f.mode=30;break}f.have=0,f.mode=18;case 18:for(;f.have<f.ncode;){for(;z<3;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}f.lens[L[f.have++]]=7&F,F>>>=3,z-=3}for(;f.have<19;)f.lens[L[f.have++]]=0;if(f.lencode=f.lendyn,f.lenbits=7,T={bits:f.lenbits},U=v(0,f.lens,0,19,f.lencode,0,f.work,T),f.lenbits=T.bits,U){E.msg="invalid code lengths set",f.mode=30;break}f.have=0,f.mode=19;case 19:for(;f.have<f.nlen+f.ndist;){for(;ge=(I=f.lencode[F&(1<<f.lenbits)-1])>>>16&255,ke=65535&I,!((ce=I>>>24)<=z);){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(ke<16)F>>>=ce,z-=ce,f.lens[f.have++]=ke;else{if(ke===16){for(k=ce+2;z<k;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(F>>>=ce,z-=ce,f.have===0){E.msg="invalid bit length repeat",f.mode=30;break}u=f.lens[f.have-1],Q=3+(3&F),F>>>=2,z-=2}else if(ke===17){for(k=ce+3;z<k;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}z-=ce,u=0,Q=3+(7&(F>>>=ce)),F>>>=3,z-=3}else{for(k=ce+7;z<k;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}z-=ce,u=0,Q=11+(127&(F>>>=ce)),F>>>=7,z-=7}if(f.have+Q>f.nlen+f.ndist){E.msg="invalid bit length repeat",f.mode=30;break}for(;Q--;)f.lens[f.have++]=u}}if(f.mode===30)break;if(f.lens[256]===0){E.msg="invalid code -- missing end-of-block",f.mode=30;break}if(f.lenbits=9,T={bits:f.lenbits},U=v(y,f.lens,0,f.nlen,f.lencode,0,f.work,T),f.lenbits=T.bits,U){E.msg="invalid literal/lengths set",f.mode=30;break}if(f.distbits=6,f.distcode=f.distdyn,T={bits:f.distbits},U=v(g,f.lens,f.nlen,f.ndist,f.distcode,0,f.work,T),f.distbits=T.bits,U){E.msg="invalid distances set",f.mode=30;break}if(f.mode=20,q===6)break e;case 20:f.mode=21;case 21:if(6<=X&&258<=se){E.next_out=de,E.avail_out=se,E.next_in=H,E.avail_in=X,f.hold=F,f.bits=z,c(E,ee),de=E.next_out,le=E.output,se=E.avail_out,H=E.next_in,R=E.input,X=E.avail_in,F=f.hold,z=f.bits,f.mode===12&&(f.back=-1);break}for(f.back=0;ge=(I=f.lencode[F&(1<<f.lenbits)-1])>>>16&255,ke=65535&I,!((ce=I>>>24)<=z);){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(ge&&(240&ge)==0){for(Ie=ce,Ae=ge,Fe=ke;ge=(I=f.lencode[Fe+((F&(1<<Ie+Ae)-1)>>Ie)])>>>16&255,ke=65535&I,!(Ie+(ce=I>>>24)<=z);){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}F>>>=Ie,z-=Ie,f.back+=Ie}if(F>>>=ce,z-=ce,f.back+=ce,f.length=ke,ge===0){f.mode=26;break}if(32&ge){f.back=-1,f.mode=12;break}if(64&ge){E.msg="invalid literal/length code",f.mode=30;break}f.extra=15&ge,f.mode=22;case 22:if(f.extra){for(k=f.extra;z<k;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}f.length+=F&(1<<f.extra)-1,F>>>=f.extra,z-=f.extra,f.back+=f.extra}f.was=f.length,f.mode=23;case 23:for(;ge=(I=f.distcode[F&(1<<f.distbits)-1])>>>16&255,ke=65535&I,!((ce=I>>>24)<=z);){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if((240&ge)==0){for(Ie=ce,Ae=ge,Fe=ke;ge=(I=f.distcode[Fe+((F&(1<<Ie+Ae)-1)>>Ie)])>>>16&255,ke=65535&I,!(Ie+(ce=I>>>24)<=z);){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}F>>>=Ie,z-=Ie,f.back+=Ie}if(F>>>=ce,z-=ce,f.back+=ce,64&ge){E.msg="invalid distance code",f.mode=30;break}f.offset=ke,f.extra=15&ge,f.mode=24;case 24:if(f.extra){for(k=f.extra;z<k;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}f.offset+=F&(1<<f.extra)-1,F>>>=f.extra,z-=f.extra,f.back+=f.extra}if(f.offset>f.dmax){E.msg="invalid distance too far back",f.mode=30;break}f.mode=25;case 25:if(se===0)break e;if(Q=ee-se,f.offset>Q){if((Q=f.offset-Q)>f.whave&&f.sane){E.msg="invalid distance too far back",f.mode=30;break}we=Q>f.wnext?(Q-=f.wnext,f.wsize-Q):f.wnext-Q,Q>f.length&&(Q=f.length),Ee=f.window}else Ee=le,we=de-f.offset,Q=f.length;for(se<Q&&(Q=se),se-=Q,f.length-=Q;le[de++]=Ee[we++],--Q;);f.length===0&&(f.mode=21);break;case 26:if(se===0)break e;le[de++]=f.length,se--,f.mode=21;break;case 27:if(f.wrap){for(;z<32;){if(X===0)break e;X--,F|=R[H++]<<z,z+=8}if(ee-=se,E.total_out+=ee,f.total+=ee,ee&&(E.adler=f.check=f.flags?e(f.check,le,ee,de-ee):m(f.check,le,ee,de-ee)),ee=se,(f.flags?F:d(F))!==f.check){E.msg="incorrect data check",f.mode=30;break}z=F=0}f.mode=28;case 28:if(f.wrap&&f.flags){for(;z<32;){if(X===0)break e;X--,F+=R[H++]<<z,z+=8}if(F!==(4294967295&f.total)){E.msg="incorrect length check",f.mode=30;break}z=F=0}f.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return n}return E.next_out=de,E.avail_out=se,E.next_in=H,E.avail_in=X,f.hold=F,f.bits=z,(f.wsize||ee!==E.avail_out&&f.mode<30&&(f.mode<27||q!==4))&&ae(E,E.output,E.next_out,ee-E.avail_out)?(f.mode=31,-4):(re-=E.avail_in,ee-=E.avail_out,E.total_in+=re,E.total_out+=ee,f.total+=ee,f.wrap&&ee&&(E.adler=f.check=f.flags?e(f.check,le,ee,E.next_out-ee):m(f.check,le,ee,E.next_out-ee)),E.data_type=f.bits+(f.last?64:0)+(f.mode===12?128:0)+(f.mode===20||f.mode===15?256:0),(re==0&&ee===0||q===4)&&U===_&&(U=-5),U)},a.inflateEnd=function(E){if(!E||!E.state)return n;var q=E.state;return q.window&&(q.window=null),E.state=null,_},a.inflateGetHeader=function(E,q){var f;return E&&E.state?(2&(f=E.state).wrap)==0?n:((f.head=q).done=!1,_):n},a.inflateSetDictionary=function(E,q){var f,R=q.length;return E&&E.state?(f=E.state).wrap!==0&&f.mode!==11?n:f.mode===11&&m(1,q,R,0)!==f.check?-3:ae(E,q,R,R)?(f.mode=31,-4):(f.havedict=1,_):n},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(p,w,a){var s=p("../utils/common"),m=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];w.exports=function(y,g,_,n,C,i,h,d){var b,S,D,x,O,A,j,N,Z,ae=d.bits,E=0,q=0,f=0,R=0,le=0,H=0,de=0,X=0,se=0,F=0,z=null,re=0,ee=new s.Buf16(16),Q=new s.Buf16(16),we=null,Ee=0;for(E=0;E<=15;E++)ee[E]=0;for(q=0;q<n;q++)ee[g[_+q]]++;for(le=ae,R=15;1<=R&&ee[R]===0;R--);if(R<le&&(le=R),R===0)return C[i++]=20971520,C[i++]=20971520,d.bits=1,0;for(f=1;f<R&&ee[f]===0;f++);for(le<f&&(le=f),E=X=1;E<=15;E++)if(X<<=1,(X-=ee[E])<0)return-1;if(0<X&&(y===0||R!==1))return-1;for(Q[1]=0,E=1;E<15;E++)Q[E+1]=Q[E]+ee[E];for(q=0;q<n;q++)g[_+q]!==0&&(h[Q[g[_+q]]++]=q);if(A=y===0?(z=we=h,19):y===1?(z=m,re-=257,we=e,Ee-=257,256):(z=c,we=v,-1),E=f,O=i,de=q=F=0,D=-1,x=(se=1<<(H=le))-1,y===1&&852<se||y===2&&592<se)return 1;for(;;){for(j=E-de,Z=h[q]<A?(N=0,h[q]):h[q]>A?(N=we[Ee+h[q]],z[re+h[q]]):(N=96,0),b=1<<E-de,f=S=1<<H;C[O+(F>>de)+(S-=b)]=j<<24|N<<16|Z|0,S!==0;);for(b=1<<E-1;F&b;)b>>=1;if(b!==0?(F&=b-1,F+=b):F=0,q++,--ee[E]==0){if(E===R)break;E=g[_+h[q]]}if(le<E&&(F&x)!==D){for(de===0&&(de=le),O+=f,X=1<<(H=E-de);H+de<R&&!((X-=ee[H+de])<=0);)H++,X<<=1;if(se+=1<<H,y===1&&852<se||y===2&&592<se)return 1;C[D=F&x]=le<<24|H<<16|O-i|0}}return F!==0&&(C[O+F]=E-de<<24|64<<16|0),d.bits=le,0}},{"../utils/common":41}],51:[function(p,w,a){w.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(p,w,a){var s=p("../utils/common"),m=0,e=1;function c(I){for(var V=I.length;0<=--V;)I[V]=0}var v=0,y=29,g=256,_=g+1+y,n=30,C=19,i=2*_+1,h=15,d=16,b=7,S=256,D=16,x=17,O=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=new Array(2*(_+2));c(ae);var E=new Array(2*n);c(E);var q=new Array(512);c(q);var f=new Array(256);c(f);var R=new Array(y);c(R);var le,H,de,X=new Array(n);function se(I,V,L,M,P){this.static_tree=I,this.extra_bits=V,this.extra_base=L,this.elems=M,this.max_length=P,this.has_stree=I&&I.length}function F(I,V){this.dyn_tree=I,this.max_code=0,this.stat_desc=V}function z(I){return I<256?q[I]:q[256+(I>>>7)]}function re(I,V){I.pending_buf[I.pending++]=255&V,I.pending_buf[I.pending++]=V>>>8&255}function ee(I,V,L){I.bi_valid>d-L?(I.bi_buf|=V<<I.bi_valid&65535,re(I,I.bi_buf),I.bi_buf=V>>d-I.bi_valid,I.bi_valid+=L-d):(I.bi_buf|=V<<I.bi_valid&65535,I.bi_valid+=L)}function Q(I,V,L){ee(I,L[2*V],L[2*V+1])}function we(I,V){for(var L=0;L|=1&I,I>>>=1,L<<=1,0<--V;);return L>>>1}function Ee(I,V,L){var M,P,W=new Array(h+1),te=0;for(M=1;M<=h;M++)W[M]=te=te+L[M-1]<<1;for(P=0;P<=V;P++){var G=I[2*P+1];G!==0&&(I[2*P]=we(W[G]++,G))}}function ce(I){var V;for(V=0;V<_;V++)I.dyn_ltree[2*V]=0;for(V=0;V<n;V++)I.dyn_dtree[2*V]=0;for(V=0;V<C;V++)I.bl_tree[2*V]=0;I.dyn_ltree[2*S]=1,I.opt_len=I.static_len=0,I.last_lit=I.matches=0}function ge(I){8<I.bi_valid?re(I,I.bi_buf):0<I.bi_valid&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0}function ke(I,V,L,M){var P=2*V,W=2*L;return I[P]<I[W]||I[P]===I[W]&&M[V]<=M[L]}function Ie(I,V,L){for(var M=I.heap[L],P=L<<1;P<=I.heap_len&&(P<I.heap_len&&ke(V,I.heap[P+1],I.heap[P],I.depth)&&P++,!ke(V,M,I.heap[P],I.depth));)I.heap[L]=I.heap[P],L=P,P<<=1;I.heap[L]=M}function Ae(I,V,L){var M,P,W,te,G=0;if(I.last_lit!==0)for(;M=I.pending_buf[I.d_buf+2*G]<<8|I.pending_buf[I.d_buf+2*G+1],P=I.pending_buf[I.l_buf+G],G++,M===0?Q(I,P,V):(Q(I,(W=f[P])+g+1,V),(te=A[W])!==0&&ee(I,P-=R[W],te),Q(I,W=z(--M),L),(te=j[W])!==0&&ee(I,M-=X[W],te)),G<I.last_lit;);Q(I,S,V)}function Fe(I,V){var L,M,P,W=V.dyn_tree,te=V.stat_desc.static_tree,G=V.stat_desc.has_stree,oe=V.stat_desc.elems,ye=-1;for(I.heap_len=0,I.heap_max=i,L=0;L<oe;L++)W[2*L]!==0?(I.heap[++I.heap_len]=ye=L,I.depth[L]=0):W[2*L+1]=0;for(;I.heap_len<2;)W[2*(P=I.heap[++I.heap_len]=ye<2?++ye:0)]=1,I.depth[P]=0,I.opt_len--,G&&(I.static_len-=te[2*P+1]);for(V.max_code=ye,L=I.heap_len>>1;1<=L;L--)Ie(I,W,L);for(P=oe;L=I.heap[1],I.heap[1]=I.heap[I.heap_len--],Ie(I,W,1),M=I.heap[1],I.heap[--I.heap_max]=L,I.heap[--I.heap_max]=M,W[2*P]=W[2*L]+W[2*M],I.depth[P]=(I.depth[L]>=I.depth[M]?I.depth[L]:I.depth[M])+1,W[2*L+1]=W[2*M+1]=P,I.heap[1]=P++,Ie(I,W,1),2<=I.heap_len;);I.heap[--I.heap_max]=I.heap[1],function(me,ze){var We,qe,Ge,Ce,Je,it,Be=ze.dyn_tree,ut=ze.max_code,yt=ze.stat_desc.static_tree,wt=ze.stat_desc.has_stree,It=ze.stat_desc.extra_bits,ct=ze.stat_desc.extra_base,Qe=ze.stat_desc.max_length,et=0;for(Ce=0;Ce<=h;Ce++)me.bl_count[Ce]=0;for(Be[2*me.heap[me.heap_max]+1]=0,We=me.heap_max+1;We<i;We++)Qe<(Ce=Be[2*Be[2*(qe=me.heap[We])+1]+1]+1)&&(Ce=Qe,et++),Be[2*qe+1]=Ce,ut<qe||(me.bl_count[Ce]++,Je=0,ct<=qe&&(Je=It[qe-ct]),it=Be[2*qe],me.opt_len+=it*(Ce+Je),wt&&(me.static_len+=it*(yt[2*qe+1]+Je)));if(et!==0){do{for(Ce=Qe-1;me.bl_count[Ce]===0;)Ce--;me.bl_count[Ce]--,me.bl_count[Ce+1]+=2,me.bl_count[Qe]--,et-=2}while(0<et);for(Ce=Qe;Ce!==0;Ce--)for(qe=me.bl_count[Ce];qe!==0;)ut<(Ge=me.heap[--We])||(Be[2*Ge+1]!==Ce&&(me.opt_len+=(Ce-Be[2*Ge+1])*Be[2*Ge],Be[2*Ge+1]=Ce),qe--)}}(I,V),Ee(W,ye,I.bl_count)}function u(I,V,L){var M,P,W=-1,te=V[1],G=0,oe=7,ye=4;for(te===0&&(oe=138,ye=3),V[2*(L+1)+1]=65535,M=0;M<=L;M++)P=te,te=V[2*(M+1)+1],++G<oe&&P===te||(G<ye?I.bl_tree[2*P]+=G:P!==0?(P!==W&&I.bl_tree[2*P]++,I.bl_tree[2*D]++):G<=10?I.bl_tree[2*x]++:I.bl_tree[2*O]++,W=P,ye=(G=0)===te?(oe=138,3):P===te?(oe=6,3):(oe=7,4))}function U(I,V,L){var M,P,W=-1,te=V[1],G=0,oe=7,ye=4;for(te===0&&(oe=138,ye=3),M=0;M<=L;M++)if(P=te,te=V[2*(M+1)+1],!(++G<oe&&P===te)){if(G<ye)for(;Q(I,P,I.bl_tree),--G!=0;);else P!==0?(P!==W&&(Q(I,P,I.bl_tree),G--),Q(I,D,I.bl_tree),ee(I,G-3,2)):G<=10?(Q(I,x,I.bl_tree),ee(I,G-3,3)):(Q(I,O,I.bl_tree),ee(I,G-11,7));W=P,ye=(G=0)===te?(oe=138,3):P===te?(oe=6,3):(oe=7,4)}}c(X);var T=!1;function k(I,V,L,M){ee(I,(v<<1)+(M?1:0),3),function(P,W,te,G){ge(P),G&&(re(P,te),re(P,~te)),s.arraySet(P.pending_buf,P.window,W,te,P.pending),P.pending+=te}(I,V,L,!0)}a._tr_init=function(I){T||(function(){var V,L,M,P,W,te=new Array(h+1);for(P=M=0;P<y-1;P++)for(R[P]=M,V=0;V<1<<A[P];V++)f[M++]=P;for(f[M-1]=P,P=W=0;P<16;P++)for(X[P]=W,V=0;V<1<<j[P];V++)q[W++]=P;for(W>>=7;P<n;P++)for(X[P]=W<<7,V=0;V<1<<j[P]-7;V++)q[256+W++]=P;for(L=0;L<=h;L++)te[L]=0;for(V=0;V<=143;)ae[2*V+1]=8,V++,te[8]++;for(;V<=255;)ae[2*V+1]=9,V++,te[9]++;for(;V<=279;)ae[2*V+1]=7,V++,te[7]++;for(;V<=287;)ae[2*V+1]=8,V++,te[8]++;for(Ee(ae,_+1,te),V=0;V<n;V++)E[2*V+1]=5,E[2*V]=we(V,5);le=new se(ae,A,g+1,_,h),H=new se(E,j,0,n,h),de=new se(new Array(0),N,0,C,b)}(),T=!0),I.l_desc=new F(I.dyn_ltree,le),I.d_desc=new F(I.dyn_dtree,H),I.bl_desc=new F(I.bl_tree,de),I.bi_buf=0,I.bi_valid=0,ce(I)},a._tr_stored_block=k,a._tr_flush_block=function(I,V,L,M){var P,W,te=0;0<I.level?(I.strm.data_type===2&&(I.strm.data_type=function(G){var oe,ye=4093624447;for(oe=0;oe<=31;oe++,ye>>>=1)if(1&ye&&G.dyn_ltree[2*oe]!==0)return m;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return e;for(oe=32;oe<g;oe++)if(G.dyn_ltree[2*oe]!==0)return e;return m}(I)),Fe(I,I.l_desc),Fe(I,I.d_desc),te=function(G){var oe;for(u(G,G.dyn_ltree,G.l_desc.max_code),u(G,G.dyn_dtree,G.d_desc.max_code),Fe(G,G.bl_desc),oe=C-1;3<=oe&&G.bl_tree[2*Z[oe]+1]===0;oe--);return G.opt_len+=3*(oe+1)+5+5+4,oe}(I),P=I.opt_len+3+7>>>3,(W=I.static_len+3+7>>>3)<=P&&(P=W)):P=W=L+5,L+4<=P&&V!==-1?k(I,V,L,M):I.strategy===4||W===P?(ee(I,2+(M?1:0),3),Ae(I,ae,E)):(ee(I,4+(M?1:0),3),function(G,oe,ye,me){var ze;for(ee(G,oe-257,5),ee(G,ye-1,5),ee(G,me-4,4),ze=0;ze<me;ze++)ee(G,G.bl_tree[2*Z[ze]+1],3);U(G,G.dyn_ltree,oe-1),U(G,G.dyn_dtree,ye-1)}(I,I.l_desc.max_code+1,I.d_desc.max_code+1,te+1),Ae(I,I.dyn_ltree,I.dyn_dtree)),ce(I),M&&ge(I)},a._tr_tally=function(I,V,L){return I.pending_buf[I.d_buf+2*I.last_lit]=V>>>8&255,I.pending_buf[I.d_buf+2*I.last_lit+1]=255&V,I.pending_buf[I.l_buf+I.last_lit]=255&L,I.last_lit++,V===0?I.dyn_ltree[2*L]++:(I.matches++,V--,I.dyn_ltree[2*(f[L]+g+1)]++,I.dyn_dtree[2*z(V)]++),I.last_lit===I.lit_bufsize-1},a._tr_align=function(I){ee(I,2,3),Q(I,S,ae),function(V){V.bi_valid===16?(re(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):8<=V.bi_valid&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(I)}},{"../utils/common":41}],53:[function(p,w,a){w.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(p,w,a){(function(s){(function(m,e){if(!m.setImmediate){var c,v,y,g,_=1,n={},C=!1,i=m.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(m);h=h&&h.setTimeout?h:m,c={}.toString.call(m.process)==="[object process]"?function(D){process.nextTick(function(){b(D)})}:function(){if(m.postMessage&&!m.importScripts){var D=!0,x=m.onmessage;return m.onmessage=function(){D=!1},m.postMessage("","*"),m.onmessage=x,D}}()?(g="setImmediate$"+Math.random()+"$",m.addEventListener?m.addEventListener("message",S,!1):m.attachEvent("onmessage",S),function(D){m.postMessage(g+D,"*")}):m.MessageChannel?((y=new MessageChannel).port1.onmessage=function(D){b(D.data)},function(D){y.port2.postMessage(D)}):i&&"onreadystatechange"in i.createElement("script")?(v=i.documentElement,function(D){var x=i.createElement("script");x.onreadystatechange=function(){b(D),x.onreadystatechange=null,v.removeChild(x),x=null},v.appendChild(x)}):function(D){setTimeout(b,0,D)},h.setImmediate=function(D){typeof D!="function"&&(D=new Function(""+D));for(var x=new Array(arguments.length-1),O=0;O<x.length;O++)x[O]=arguments[O+1];var A={callback:D,args:x};return n[_]=A,c(_),_++},h.clearImmediate=d}function d(D){delete n[D]}function b(D){if(C)setTimeout(b,0,D);else{var x=n[D];if(x){C=!0;try{(function(O){var A=O.callback,j=O.args;switch(j.length){case 0:A();break;case 1:A(j[0]);break;case 2:A(j[0],j[1]);break;case 3:A(j[0],j[1],j[2]);break;default:A.apply(e,j)}})(x)}finally{d(D),C=!1}}}}function S(D){D.source===m&&typeof D.data=="string"&&D.data.indexOf(g)===0&&b(+D.data.slice(g.length))}})(typeof self=="undefined"?s===void 0?this:s:self)}).call(this,typeof tt!="undefined"?tt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(_t);var ba=_t.exports;const Ke={paginacao:{atual:1,maximo:1,total:1,limite:25},filtros:{numero:"",numeroCompra:null,termoBusca:"",periodoEmissao:{ini:"",fim:""},periodoFinalizado:{ini:"",fim:""},fornecedor:{nome:""},destinatario:null}},va={components:{Lista:Ft,ComprasFicha:Xt,ComprasImportacaoXML:ga},data(){return{usuario:"",clienteSistema:"",lista:[],contatos:{},destinatarioOpcoes:[],destinatarioSelecionado:null,mostrar:{barraTopo:!0,toolbarTitulo:!0,icone:"factory",titulo:"Compras",filtroAvancado:!0,buscar:!0,btnAjuda:!0,btnAtualizar:!0,btnNovo:!0,toolbarAcoes:!0,checkBox:!1,btnRemover:!1,btnRestaurar:!1,centralizaTabs:!1,btnDetalhes:!1,btnExportaXLS:!1,btnMenuMais:!1,toolbarAdicao:!1,bannerMsg:""},resultado:{},busca:"",filtros:$utils.clonarV2(Ke.filtros),tabSelecionada2:{valor:"Digita\xE7\xE3o"},tabs2:[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}],tabSelecionada:{},tabs:[],paginacao:$utils.clonarV2(Ke.paginacao),xmlDevolucao:!1,xmlEstrangeiro:!1,modalXMLNotaEntrada:!1,xmlNotaEntrada:{},abrirNotadeEntrada:null,configImpressao:[],configImpressaoPedidoCompra:[{valor:"ped_compra",texto:"Pedido de Compra",observacao:"Modelo 1"},{valor:"pedidoCompra",texto:"Pedido de Compra",observacao:"Modelo 2"}],dialogEtiquetas:{impressao:!1,adicionar:!1,limpar:!1,item:{}},opcoesModelo:[],modeloSelecionado:"",emBranco:0,opcoesEmpresas:[],empresaSelecionada:"",tabelasPreco:[],opcoesTabelasPreco:[],tabelaPrecoSelecionada:""}},methods:{aoSelecionarDestinatario(){this.filtros.destinatario=$utils.clonar(this.destinatarioSelecionado)},async atualizar(o){var p;const l=$utils.logarIni("ComprasLista");await $tryLoading(async()=>{var y;let{buscarDadosRecentes:w}=o!=null?o:{},a,s,m,e,c=["dataHoraFinalizado","dataHoraEmissao"],v=["desc","desc"];if(o!=null&&o.aba2&&(this.tabSelecionada.valor=o.aba2),this.tabSelecionadaAnterior&&this.tabSelecionadaAnterior!==this.tabSelecionada.valor&&(this.setOpcoesTabs(this.tabSelecionada.valor),this.filtros=$utils.clonarV2(Ke.filtros),this.paginacao=$utils.clonarV2(Ke.paginacao),this.busca="",w=!0),this.tabSelecionadaAnterior=this.tabSelecionada.valor,w&&(a=await $utils.localIDB.getItem({objectStore:"dadosRecentes",id:this.tabSelecionada.valor}),a!=null&&a._id&&(this.destinatarioSelecionado=a.filtros.destinatario,this.filtros=a.filtros,this.busca=a.termoBusca,c=a.sort,v=a.dir)),o!=null&&o.aba&&(this.tabSelecionada2.valor=o.aba),s=$utils.eliminarVazios(this.filtros),m=this.paginacao.limite,e=this.paginacao.atual,s.status=this.tabSelecionada2.valor,s.operacao=this.tabSelecionada.valor,s.termoBusca=this.busca,this.tabSelecionada2.valor==="Todos"&&delete s.status,s.operacao==="Nota no SEFAZ"){let g=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","xNomeEmitente","cpfCnpjEmitente","xNomeDestinatario","cpfCnpjDestinatario","vNF","situacao","nNF"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});g=g.filter(i=>{var h,d,b;return!(((h=this.filtros.fornecedor)==null?void 0:h.nome)&&!i.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((d=this.filtros.destinatario)==null?void 0:d.numeroDocumentoNacional)&&((b=i.cpfCnpjDestinatario)==null?void 0:b.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))});const _=await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","dhRecbto"],whereIn:{idDocumentoFiscalEletronico:g.map(i=>i.id)}}),n=[];_.forEach(i=>{var D,x;const h=g.find(O=>O.id===i.idDocumentoFiscalEletronico),d=new Date(i.dhRecbto).setHours(0,0,0,0),b=new Date((D=this.filtros.periodoEmissao)==null?void 0:D.ini).setHours(0,0,0,0),S=new Date((x=this.filtros.periodoEmissao)==null?void 0:x.fim).setHours(0,0,0,0);(b||S)&&d&&(b&&d<b||S&&d>S)||h&&n.push({id:h.id,descricaoContato:h.xNomeEmitente,numeroDocumentoContato:this.$filters.cpfCnpj(h.cpfCnpjEmitente)||"",descricaoEmpresa:h.xNomeDestinatario,numeroDocumentoEmpresa:this.$filters.cpfCnpj(h.cpfCnpjDestinatario)||"",dhRecbto:i.dhRecbto,totalDocumento:h.vNF,status:h.situacao,notaNumero:h.nNF})});const C=(e-1)*m;this.paginacao.total=n.length,this.paginacao.maximo=Math.ceil(this.paginacao.total/m)||1,n.sort((i,h)=>i.dhRecbto<h.dhRecbto?1:-1),this.lista=n.splice(C,m)}else{(y=this.filtros.destinatario)!=null&&y.value&&(s.idContatoEmpresa=this.filtros.destinatario.value);const g=await $db.compra.leListaCompleta({filtros:s,limit:m,page:e,sort:c,dir:v});this.paginacao.total=g.total,this.paginacao.maximo=g.totalPages,this.lista=g.data.compras}for(const{idContato:g}of this.lista)g&&!this.contatos[g]&&(this.contatos[g]={});this.carregarImagensContatos(this.contatos),a={_id:this.tabSelecionada.valor,tabSelecionada2:this.tabSelecionada2.valor,filtros:$utils.clonarV2(s),termoBusca:this.busca,sort:c,dir:v},await $utils.localIDB.setItem({objectStore:"dadosRecentes",data:a}),this.configuraImpressao(this.filtros.idEmpresa)}),$utils.logarFim(l,((p=this.paginacao)==null?void 0:p.total)||1)},async carregarImagensContatos(o){const l=Object.keys(o);if(!!l.length){await $utils.dormir(200);try{const p=await $db.hibrido.lista({table:"contato",columns:["id","apelido","imagem"],whereIn:{id:l}});for(const w of p)o[w.id].imagem=w.imagem||""}catch(p){console.error("Erro ao carregar imagens de contatos - ",p)}}},adicionarXml(o){this.xmlNotaEntrada.arquivo=o[0]},async concluirImportacao(o){await $tryLoading(async()=>{await $db.compra.grava({atual:o}),$q.notifyPositive("Importa\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabSelecionada.valor="Nota de Entrada",await this.$refs.comprasFicha.mostrar({id:o.documento.id})},{mensagem:"Gravando importa\xE7\xE3o..."})},async importarXmlNotaDeEntrada(){var p,w,a,s,m,e;let o,l;try{$utils.verificarErro(!this.xmlNotaEntrada.arquivo,"Adicione um arquivo XML antes de enviar!");const v=await(i=>new Promise((h,d)=>{const b=new FileReader;b.readAsBinaryString(i),b.onload=()=>h(b.result),b.onerror=S=>d(S)}))(this.xmlNotaEntrada.arquivo),y=new DOMParser,g=new XMLSerializer,_=y.parseFromString(v,"text/xml");l=g.serializeToString(_),$utils.verificarErro(_.documentElement.nodeName==="html","Arquivo inv\xE1lido ou corrompido");const n=new Vt.Parser;let C;n.parseString(l,(i,h)=>{i&&console.log(i),C=h}),o=(e=(m=(s=(a=(w=(p=C==null?void 0:C.nfeProc)==null?void 0:p.protNFe)==null?void 0:w[0])==null?void 0:a.infProt)==null?void 0:s[0])==null?void 0:m.nProt)==null?void 0:e[0]}catch(c){return $q.notifyError("Ocorreu um erro na importa\xE7\xE3o",c),!1}if(!o&&!await $q.dialogSimNao({title:"Aviso importante",message:"O XML que est\xE1 sendo importado n\xE3o foi protocolado pela Sefaz, gostaria de importar o XML sem o protocolo?",html:!0})){$q.notifyError("Opera\xE7\xE3o para importa\xE7\xE3o de XML n\xE3o realizada!",erro);return}await $tryLoading(async()=>{const c=(await $db.hibrido.lista({table:"documentoXML",whereFilter:{xmlAux:l}}))[0];$utils.verificarErro(c==null?void 0:c.id,"Esse xml j\xE1 foi importado!");const v=await $db.compra.importaXml({xmlString:l,xmlEstrangeiro:Boolean(this.xmlEstrangeiro)});v.documentosItem.find(({vinculado:y})=>!y)?this.$refs.comprasImportacaoXML.mostrar(v):await this.concluirImportacao(v)},{mensagem:"Importando..."}),delete this.xmlNotaEntrada.arquivo,this.modalXMLNotaEntrada=!1,this.xmlEstrangeiro=!1},async fecharXmlNotaDeEntrada(){delete this.xmlNotaEntrada.arquivo},async abrir(o){this.tabSelecionada.valor!=="Nota no SEFAZ"&&this.$refs.comprasFicha.mostrar({id:o})},criarClick(){this.$refs.comprasFicha.criar()},importarXmlClick(){this.modalXMLNotaEntrada=!0},limparFiltrosClick(){this.filtros=$utils.clonarV2(Ke.filtros),this.destinatarioSelecionado=null,this.atualizar()},setOpcoesTabs(o){o!=="Nota no SEFAZ"?(this.tabSelecionada2.valor="Digita\xE7\xE3o",this.tabs2=[{valor:"Digita\xE7\xE3o",rotulo:"Digita\xE7\xE3o"},{valor:"Finalizado",rotulo:"Finalizado"},{valor:"Todos",rotulo:"Todos"}]):(this.tabSelecionada2.valor="N\xE3o Importada",this.tabs2=[{valor:"N\xE3o Importada",rotulo:"N\xE3o Importada"},{valor:"Importada",rotulo:"Importada"},{valor:"Todos",rotulo:"Todos"}])},async duplicarDocumento(o){!await $q.dialogSimNao({title:"Duplicar",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const l=await $db.hibrido.le({table:"documento",id:o.id});$utils.verificarErro(!l.id,"Compra n\xE3o encontrada");const p=(await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:o.id}})).sort((a,s)=>new Date(a.dataHoraEmissao||0)-new Date(s.dataHoraEmissao||0)),w=$utils.uuid();await $db.hibrido.grava("documento",{atual:{...l,id:w,codigoDocumento:void 0,numero:void 0,notaNumero:void 0,notaSerie:void 0,naturezaOperacao:void 0,dataCompra:void 0,chaveAcesso:void 0,dataHoraEmissao:$utils.dataAtual(),dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"}}),await $db.hibrido.gravaLista("documentoItem",{atual:p.map(a=>({...a,id:$utils.uuid(),codigoDocumentoItem:void 0,idDocumento:w,codigoDocumento:void 0,dataHoraFinalizado:void 0,status:"Digita\xE7\xE3o"}))}),$q.notifyPositive("Duplica\xE7\xE3o realizada com sucesso!"),this.tabSelecionada2.valor="Digita\xE7\xE3o",await this.$refs.comprasFicha.mostrar({id:w})},{mensagem:"Duplicando..."})},async downloadXmlDFeFiltrados(){var o,l,p,w,a;if(!!await $q.dialogSimNao({title:"Download XML's filtrados",message:"Deseja prosseguir com a opera\xE7\xE3o?"}))try{$q.loading.show();let s=[];if($db.hibrido.isOnline())s=(a=(w=(p=await $utils.geeksApi({downloadDFe:{funcao:"2D9F9B43-47D3-491E-AD49-528EC9547BDC",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{},fornecedor:(o=this.filtros.fornecedor)==null?void 0:o.nome,numeroDocumentoNacionalDestinatario:(l=this.filtros.destinatario)==null?void 0:l.numeroDocumentoNacional,periodoRecbto:this.filtros.periodoEmissao}}))==null?void 0:p.data)==null?void 0:w.downloadDFe)!=null?a:[];else{let m=await $db.hibrido.lista({table:"documentoFiscalEletronico",columns:["id","dhEmi","cpfCnpjEmitente","cpfCnpjDestinatario","xNomeEmitente","xNomeDestinatario"],where:{tipo:"DFe",...this.tabSelecionada2.valor!=="Todos"?{situacao:this.tabSelecionada2.valor}:{}}});m=m.filter(c=>{var v,y,g;return!(((v=this.filtros.fornecedor)==null?void 0:v.nome)&&!c.xNomeEmitente.toLowerCase().includes(this.filtros.fornecedor.nome.toLowerCase())||((y=this.filtros.destinatario)==null?void 0:y.numeroDocumentoNacional)&&((g=c.cpfCnpjDestinatario)==null?void 0:g.replace(/\D/g,""))!==this.filtros.destinatario.numeroDocumentoNacional.replace(/\D/g,""))}),(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",columns:["idDocumentoFiscalEletronico","chNFe","dhRecbto","xmlProt"],whereIn:{idDocumentoFiscalEletronico:m.map(c=>c.id)}})).forEach(c=>{var n,C;const v=m.find(i=>i.id===c.idDocumentoFiscalEletronico),y=new Date(c.dhRecbto).setHours(0,0,0,0),g=new Date((n=this.filtros.periodoEmissao)==null?void 0:n.ini).setHours(0,0,0,0),_=new Date((C=this.filtros.periodoEmissao)==null?void 0:C.fim).setHours(0,0,0,0);(g||_)&&y&&(g&&y<g||_&&y>_)||v&&s.push({chNFe:c.chNFe,xml:c.xmlProt,cnpj:v.cpfCnpjDestinatario})})}if((s==null?void 0:s.length)>0){const m=Array.from(new Set(s.filter(c=>c.cnpj).map(c=>c.cnpj))),e=new ba;for(const c of m)for(const v of s.filter(y=>y.cnpj===c))e.file(`${c}/${v.chNFe}.procNFe.xml`,v.xml);e.generateAsync({type:"blob"}).then(function(c){const v=new Date,y=document.createElement("a");y.href=window.URL.createObjectURL(c),y.download=`${v.getFullYear()}-${String(v.getMonth()+1).padStart(2,"0")}-${String(v.getDate()).padStart(2,"0")}_NotasEntradaSEFAZ.zip`,y.click()})}}catch{$q.notify({message:"N\xE3o foi poss\xEDvel realizar o download",type:"negative"})}finally{$q.loading.hide()}},async downloadXmlDFe(o,l){!await $q.dialogSimNao({title:"Download XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{var c;const w=(l==="Nota de Entrada"?await $db.hibrido.lista({table:"documentoXML",where:{idDocumento:o}}):await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:o}}))[0],a=(w==null?void 0:w.xmlProt)||(w==null?void 0:w.xmlData),s=(w==null?void 0:w.chNFe)||((c=/<chNFe>(\d+)<\/chNFe>/i.exec(a))==null?void 0:c[1]);$utils.verificarErro(!a,"N\xE3o foi poss\xEDvel recuperar o XML");const m=document.createElement("a"),e=new Blob([a],{type:"text/plain"});m.setAttribute("href",window.URL.createObjectURL(e)),m.setAttribute("download",`${s||o}-procNFe.xml`),m.click()})},async importarXmlDFe(o){!await $q.dialogSimNao({title:"Importar XML",message:"Deseja prosseguir com a opera\xE7\xE3o?"})||await $tryLoading(async()=>{const l=await $db.hibrido.le({table:"documentoFiscalEletronico",id:o}),p=(await $db.hibrido.lista({table:"documentoFiscalEletronicoXml",where:{idDocumentoFiscalEletronico:o}}))[0];if((l==null?void 0:l.id)&&(p==null?void 0:p.xmlProt)){const w=await $db.compra.importaXml({xmlString:p.xmlProt}),a={original:$utils.clonar(l),atual:$utils.clonar(l)};a.atual.situacao="Importada",await $db.documentoFiscalEletronico.grava(a),w.documentosItem.find(({vinculado:s})=>!s)?this.$refs.comprasImportacaoXML.mostrar(w):await this.concluirImportacao(w)}},{mensagem:"Importando..."})},async destinatarioOpcoesCarregar(){const o=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.destinatarioOpcoes=o.map(l=>({label:l.nome,value:l.id,numeroDocumentoNacional:l.numeroDocumentoNacional}))},async configuraImpressao(o){const l=await $db.configuracoes.porNome("impressao.compra",o);this.configImpressao=[...l.length?l.map(p=>({valor:p.valor,texto:p.texto,observacao:p.observacao})):[{valor:"invoice",texto:"Pedido de Compra",observacao:"Invoice"}]]},imprimirPedidoCompra(o,l){o==="pedidoCompra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/OptiSoul/pedidoCompra.html
            ?CodigoDocumento=${l}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `),o==="ped_compra"&&this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/distribuidor/email.html
            ?CodigoDocumento=${l}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &NomeReport=ped_compra
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,Versao:this.clienteSistema.versao,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Padrao:this.clienteSistema.padrao?this.clienteSistema.padrao:null,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)},async configuraEtiqueta(){const o=await $db.configuracoes.le({nome:"impressao.etiqueta"});this.opcoesModelo=[],o.some(l=>l.valor==="etiquetaFila")?this.opcoesModelo.push({rotulo:"Etiqueta Fila",valor:"etiquetaFila",modelo:"etiquetaFila"}):o.forEach(l=>{this.opcoesModelo.push({rotulo:l.texto,valor:l.observacao&&l.observacao.trim()!==""?l.observacao:l.valor,modelo:l.valor})}),this.opcoesModelo=[...this.opcoesModelo,{rotulo:"Modelos antigos:",value:"modelos-antigos",disable:!0},{rotulo:"Folha Argox",valor:"etiqueta-fila"},{rotulo:"Folha Carta",valor:"etiqueta-carta"},{rotulo:"Folha Pimaco",valor:"EtiquetaPimaco6Col"},{rotulo:"Personaliz\xE1vel",valor:"etiqueta_generica_ajustavel"}],this.modeloSelecionado=this.opcoesModelo[0].valor},async configuraEmpresas(){const o=(await $db.contato.ler({filtros:{ativo:!0,empresas:!0}})).data;this.opcoesEmpresas=o.map(l=>({rotulo:l.apelido||l.nome,valor:l.id,codigoEmpresa:l.codigoContato})),this.empresaSelecionada=""},async configuraTabelasPreco(){this.tabelasPreco=await $db.itemTabelaPreco.le({ativo:!0,tabelaMaster:!0})||[],this.opcoesTabelasPreco=this.tabelasPreco.map(o=>({rotulo:o.descricao,valor:o.id,codigoItemTabelaPreco:o.codigoItemTabelaPreco})),this.tabelaPrecoSelecionada=""},async dialogImprimirEtiquetas({acao:o,item:l}){try{await this.configuraEtiqueta(),await this.configuraEmpresas(),await this.configuraTabelasPreco(),this.dialogEtiquetas={[o]:!0,item:l||{},limpar:!1}}catch(p){console.error("Erro ao configurar impress\xE3o de etiquetas",p)}},imprimirEtiquetas(o){var l,p,w,a,s;if(o==="etiqueta_generica_ajustavel"||o==="etiqueta-fila"||o==="etiqueta-carta"||o==="EtiquetaPimaco6Col"){const m=o==="etiqueta_generica_ajustavel"?"":"OptiSoul/";this.abrirImpressao(`
            https://rel.storage.b15.com.br/Relatorios/${m}${o}.html
            ?Banco=${encodeURIComponent(this.clienteSistema.bancoDeDados)}
            &URLServidor=${encodeURIComponent(this.clienteSistema.urlServidor)}
            &CodigoUsuario=${this.usuario.codigoUsuario}
            &EmBranco=${this.emBranco}
            &CodigoPedido=${(p=(l=this.dialogEtiquetas)==null?void 0:l.item)==null?void 0:p.codigoDocumento}
            &TabelaPreco=${this.tabelaPrecoSelecionada?encodeURIComponent(this.opcoesTabelasPreco.find(e=>e.valor===this.tabelaPrecoSelecionada).codigoItemTabelaPreco):""}
            &CodigoContatoEmpresa=${this.empresaSelecionada?encodeURIComponent(this.opcoesEmpresas.find(e=>e.valor===this.empresaSelecionada).codigoEmpresa):""}
            &cpfUsuarioLogado=${encodeURIComponent(this.usuario.cpf)}
            &hfCodigoSistema=${encodeURIComponent(JSON.stringify({data:{CodigoUsuario:this.usuario.codigoUsuario,CodigoSistema:this.clienteSistema.codigoSistema,CodigoClienteSistema:this.clienteSistema.codigoClienteSistema,Sistema:this.clienteSistema.sistema,URLServidor:this.clienteSistema.urlServidor,BancoDeDados:this.clienteSistema.bancoDeDados,CodigoCliente:this.clienteSistema.codigoCliente,Cliente:this.clienteSistema.cliente,Administrador:this.clienteSistema.administrador,GrupoInterno:this.clienteSistema.grupoInterno}}))}
          `)}else{const m=(w=this.opcoesModelo)==null?void 0:w.find(v=>v.valor===o),e=(m==null?void 0:m.modelo)||"",c=(m==null?void 0:m.valor)||"";$imprimir(e,{id:(s=(a=this.dialogEtiquetas)==null?void 0:a.item)==null?void 0:s.id,impressao:"etiquetas"},{modelo:c,idEmpresa:this.empresaSelecionada,idTabelaPreco:this.tabelaPrecoSelecionada,emBranco:this.emBranco})}},abrirImpressao(o){window.open(o.replace(/[\s\n]/g,""),"_blank").focus()},async adicionarEtiquetas(){var o;try{$q.loading.show();const l=this.dialogEtiquetas;let p=await $db.etiqueta.ler({cpfUsuarioLogado:this.usuario.numeroDocumentoNacional})||[];if(l!=null&&l.limpar){for(const m of p)await $db.etiqueta.remover(m.id);p=[]}const w=await $db.hibrido.lista({table:"documentoItem",where:{idDocumento:(o=l==null?void 0:l.item)==null?void 0:o.id}});if(!w.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}const a=w.map(m=>m.idItem),s=await $db.hibrido.lista({table:"item",columns:["id","codigoItem","descricaoConcatenada","valorVenda"],whereIn:{id:a}});if(!s.length){$q.notifyError("N\xE3o foi poss\xEDvel encontrar itens para carregar a impress\xE3o etiquetas");return}for(const m of s){if(p.length){const c=p.find(v=>v.idItem===m.id)||null;c&&await $db.etiqueta.remover(c==null?void 0:c.id)}const e={id:$utils.uuid(),idItem:m.id,nomeProduto:m.descricaoConcatenada,valor:m.valorVenda||0,quantidadeEtiquetas:w.find(c=>c.idItem===m.id).quantidade||0,cpfUsuarioLogado:this.usuario.numeroDocumentoNacional,dataHoraEmissao:$utils.dataAtual()};await $db.etiqueta.gravar({atual:e})}$q.loading.hide(),this.$q.dialog({title:"",message:"Ir para tela de impress\xE3o de etiquetas?",noRefocus:!0,preventClose:!0,ok:{label:"SIM",push:!0,class:"bg-primary",textColor:"white",flat:!0},cancel:{label:"N\xC3O",push:!0,color:"tertiary",flat:!0}}).onOk(()=>{this.$router.push({name:"EtiquetasLista"})}).onCancel(()=>{this.dialogEtiquetas.adicionar=!1})}catch(l){$q.loading.hide(),$q.notifyError("Erro ao adicionar etiquetas",l)}}},watch:{"tabSelecionada.valor"(){this.tabSelecionada.valor==="Nota no SEFAZ"?this.mostrar.btnMenuMais=!0:this.mostrar.btnMenuMais=!1}},async created(){await this.destinatarioOpcoesCarregar();const o=[{valor:"Pedido de Compra",rotulo:"Pedido de Compra"},{valor:"Nota de Entrada",rotulo:"Nota de Entrada"}];[52,53,62].includes(Number(this.clienteSistema.codigoSistema))&&o.push({valor:"Nota no SEFAZ",rotulo:"Nota no SEFAZ"}),this.tabSelecionada={valor:"Pedido de Compra"},this.tabs=o},async mounted(){this.usuario=JSON.parse(localStorage.getItem("usuario")),this.clienteSistema=JSON.parse(localStorage.getItem("clienteSistema")),this.tabSelecionada.valor=this.$route.name,this.atualizar({buscarDadosRecentes:!0})}},_a={id:"Compras"},ya={class:"mw80 text-center"},wa={key:0,class:"text-weight-medium"},Ia={class:"row q-ma-md"},Ca={key:0,class:"row q-ma-md"},ka={class:"certificado-error-messages"};function Sa(o,l,p,w,a,s){const m=fe("campo"),e=fe("row"),c=fe("BadgeCopiarUid"),v=fe("avatar"),y=fe("g-label"),g=fe("badge"),_=fe("g-col"),n=fe("g-row"),C=fe("Lista"),i=fe("ComprasFicha"),h=fe("ComprasImportacaoXML");return $(),ve("div",_a,[t(C,{busca:a.busca,"onUpdate:busca":l[11]||(l[11]=d=>a.busca=d),onAtualizar:s.atualizar,onLimparFiltrosClick:s.limparFiltrosClick,onCriarClick:s.criarClick,lista:a.lista,tabSelecionada:a.tabSelecionada,tabs:a.tabs,tabSelecionada2:a.tabSelecionada2,tabs2:a.tabs2,paginacao:a.paginacao,mostrar:a.mostrar},{botaoNovo:r(()=>[t(ue,{label:"Novo",icon:"add",unelevated:"",color:"primary","text-color":"white",class:"hideonmobile"},{default:r(()=>[t(Me,null,{default:r(()=>[t(xe,{link:"","no-border":"",separator:""},{default:r(()=>[_e(($(),J(be,{onClick:s.criarClick,clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"add"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B("Incluir Manual")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Ve]]),_e(($(),J(be,{onClick:s.importarXmlClick,clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"add"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B("Importar XML")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Ve]])]),_:1})]),_:1})]),_:1}),t(ue,{icon:"add",flat:"",round:"",color:"primary","text-color":"white",class:"hideondesktop"},{default:r(()=>[t(Me,null,{default:r(()=>[t(xe,{link:"","no-border":"",separator:""},{default:r(()=>[_e(($(),J(be,{onClick:s.criarClick,clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"add"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B("Incluir Manual")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Ve]]),_e(($(),J(be,{onClick:s.importarXmlClick,clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"add"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B("Importar XML")]),_:1})]),_:1})]),_:1},8,["onClick"])),[[Ve]])]),_:1})]),_:1})]),_:1})]),filtroCampos:r(()=>[t(e,{class:"q-col-gutter-md q-mt-md"},{default:r(()=>[t(m,{modelValue:a.filtros.numero,"onUpdate:modelValue":l[0]||(l[0]=d=>a.filtros.numero=d),rotulo:"N\xBA Nota",dense:"",class:"col-md-12",style:{"padding-top":"0px"}},null,8,["modelValue"]),t(m,{modelValue:a.filtros.numeroCompra,"onUpdate:modelValue":l[1]||(l[1]=d=>a.filtros.numeroCompra=d),rotulo:"Ordem de compra",dense:"",class:"q-field--with-bottom"},null,8,["modelValue"])]),_:1}),t(xt,{modelValue:a.destinatarioSelecionado,"onUpdate:modelValue":[l[2]||(l[2]=d=>a.destinatarioSelecionado=d),s.aoSelecionarDestinatario],options:a.destinatarioOpcoes,clearable:"",dense:"",label:"Destinat\xE1rio",class:"q-field--with-bottom"},null,8,["modelValue","onUpdate:modelValue","options"]),t(e,{class:"q-col-gutter-md q-mt-md",style:{"margin-top":"-10px"}},{default:r(()=>[t(m,{modelValue:a.filtros.fornecedor.nome,"onUpdate:modelValue":l[3]||(l[3]=d=>a.filtros.fornecedor.nome=d),rotulo:"Fornecedor",dense:"",class:"col-md-12 q-mb-lg"},null,8,["modelValue"]),this.tabSelecionada.valor==="Nota no SEFAZ"?($(),ve(Se,{key:0},[t(m,{modelValue:a.filtros.periodoEmissao.ini,"onUpdate:modelValue":l[4]||(l[4]=d=>a.filtros.periodoEmissao.ini=d),rotulo:"Data Emiss\xE3o",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"]),t(m,{modelValue:a.filtros.periodoEmissao.fim,"onUpdate:modelValue":l[5]||(l[5]=d=>a.filtros.periodoEmissao.fim=d),rotulo:"at\xE9",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"])],64)):($(),ve(Se,{key:1},[t(m,{modelValue:a.filtros.periodoEmissao.ini,"onUpdate:modelValue":l[6]||(l[6]=d=>a.filtros.periodoEmissao.ini=d),rotulo:"Data Emiss\xE3o",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"]),t(m,{modelValue:a.filtros.periodoEmissao.fim,"onUpdate:modelValue":l[7]||(l[7]=d=>a.filtros.periodoEmissao.fim=d),rotulo:"at\xE9",dense:"",tipo:"data",class:"col-md-12 q-mb-lg"},null,8,["modelValue"]),t(m,{modelValue:a.filtros.periodoFinalizado.ini,"onUpdate:modelValue":l[8]||(l[8]=d=>a.filtros.periodoFinalizado.ini=d),rotulo:"Data Finalizado",dense:"",tipo:"data",class:"col-md-12"},null,8,["modelValue"]),t(m,{modelValue:a.filtros.periodoFinalizado.fim,"onUpdate:modelValue":l[9]||(l[9]=d=>a.filtros.periodoFinalizado.fim=d),rotulo:"at\xE9",dense:"",tipo:"data",class:"col-md-12 q-mb-lg"},null,8,["modelValue"])],64)),t(m,{modelValue:a.paginacao.limite,"onUpdate:modelValue":l[10]||(l[10]=d=>a.paginacao.limite=d),rotulo:"Quantidade por p\xE1gina",dense:"",tipo:"quantidade",min:"1"},null,8,["modelValue"])]),_:1})]),menuExtras:r(()=>[_e(($(),J(be,{onClick:s.downloadXmlDFeFiltrados,clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"download"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B("Download")]),_:1})]),_:1}),t(De,null,{default:r(()=>[B("Download dos XML's filtrados")]),_:1})]),_:1},8,["onClick"])),[[Ve]])]),itemLista:r(()=>[t(xe,{bordered:"",class:"bg-white q-mb-xs rounded-borders",style:{"min-height":"calc(100vh - 200px)"}},{default:r(()=>[($(!0),ve(Se,null,Te(a.lista,d=>($(),ve("div",{key:d.id,class:"itemHover"},[t(be,{"manual-focus":"",class:"q-py-sm q-px-xs items-center"},{default:r(()=>[t(K,{class:"hideonmobile col-auto q-px-sm no-margin"},{default:r(()=>[he("div",ya,[t(c,{id:d.id,numero:d.numero,cor:"positive",escuro:""},null,8,["id","numero"])])]),_:2},1024),t(K,{class:"col-md col-lg col-xl no-margin"},{default:r(()=>[t(be,{class:"q-pa-none"},{default:r(()=>[t(K,{onClick:b=>s.abrir(d.id),class:"col-auto items-center"},{default:r(()=>[t(v,{imagem:(a.contatos[d.idContato]||{}).imagem,rotulo:d.descricaoContato,tamanho:"40"},null,8,["imagem","rotulo"])]),_:2},1032,["onClick"]),t(K,{class:"col"},{default:r(()=>[t(ne,{onClick:b=>s.abrir(d.id),lines:"2",class:"text-tertiary text-weight-bold ellipsis-2-lines"},{default:r(()=>[B(Y(d.descricaoContato)+" ",1),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("Fornecedor")]),_:1})]),_:2},1032,["onClick"]),d.descricaoEmpresa?($(),J(ne,{key:0,onClick:b=>s.abrir(d.id),caption:""},{default:r(()=>[d.descricaoEmpresa?($(),J(y,{key:0,icon:"business 14px tertiary left"},{default:r(()=>[B(Y(d.descricaoEmpresa)+" ",1),d.numeroDocumentoEmpresa?($(),ve("span",wa,"("+Y(d.numeroDocumentoEmpresa)+")",1)):ie("",!0)]),_:2},1024)):ie("",!0)]),_:2},1032,["onClick"])):ie("",!0),t(be,{class:"q-pa-none hideonmobile q-mt-xs",style:{"min-height":"unset"}},{default:r(()=>[d.notaNumero?($(),J(g,{key:0,cor:"tertiary",class:"mw50 text-center",escuro:""},{default:r(()=>[B(Y(d.notaNumero)+" ",1),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("N\xFAmero da Nota")]),_:1})]),_:2},1024)):($(),J(g,{key:1,cor:"warning",class:"mw50 text-center",escuro:""},{default:r(()=>[B(" S/N "),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("N\xFAmero da Nota")]),_:1})]),_:1}))]),_:2},1024),t(K,{class:"hideondesktop q-mt-sm"},{default:r(()=>[t(n,{mg:"xs-b"},{default:r(()=>[d.dataHoraEmissao?($(),J(_,{key:0,col:"shrink"},{default:r(()=>[t(y,{icon:"mdi-calendar-today xs tertiary left",tip:`Emitido \xE0s ${o.$filters.hora(d.dataHoraEmissao)}`},{default:r(()=>[B(Y(o.$filters.data(d.dataHoraEmissao)),1)]),_:2},1032,["tip"])]),_:2},1024)):ie("",!0),d.dataHoraFinalizado?($(),J(_,{key:1,col:"shrink",class:"q-ml-sm"},{default:r(()=>[t(y,{icon:"mdi-calendar xs tertiary left",tip:`Finalizado \xE1s ${o.$filters.hora(d.dataHoraFinalizado)}`},{default:r(()=>[B(Y(o.$filters.data(d.dataHoraFinalizado)),1)]),_:2},1032,["tip"])]),_:2},1024)):ie("",!0)]),_:2},1024),t(n,{mg:"xs-b"},{default:r(()=>[t(_,{col:"shrink"},{default:r(()=>[t(c,{id:d.id,numero:d.numero,cor:"positive",escuro:""},null,8,["id","numero"])]),_:2},1024),t(_,{col:"shrink",class:"q-ml-sm"},{default:r(()=>[d.notaNumero?($(),J(g,{key:0,cor:"tertiary",class:"mw50",escuro:""},{default:r(()=>[B(Y(d.notaNumero)+" ",1),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("N\xFAmero da Nota")]),_:1})]),_:2},1024)):($(),J(g,{key:1,cor:"warning",class:"mw50",escuro:""},{default:r(()=>[B(" S/N "),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("N\xFAmero da Nota")]),_:1})]),_:1}))]),_:2},1024),t(_,{col:"shrink",class:"q-ml-sm"},{default:r(()=>[t(g,{rotulo:d.status,cor:d.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:d.status!=="Digita\xE7\xE3o"},null,8,["rotulo","cor","escuro"])]),_:2},1024)]),_:2},1024),t(n,null,{default:r(()=>[t(_,{col:"shrink",text:"bold"},{default:r(()=>[B(Y(o.$filters.numero(d.totalDocumento,2)),1)]),_:2},1024),_e(t(_,{col:"grow",text:"center",class:"q-ml-sm"},{default:r(()=>[B(Y(d.qtdeContatos)+" Itens ",1)]),_:2},1536),[[Pe,d.qtdeContatos>0]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(K,{onClick:b=>s.abrir(d.id),class:"hideonmobile maxw110 q-pl-sm no-margin"},{default:r(()=>[this.tabSelecionada.valor==="Nota no SEFAZ"?($(),ve(Se,{key:0},[d.dhRecbto?($(),J(ne,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:r(()=>[t(pe,{name:"mdi-calendar-today"}),B(" "+Y(o.$filters.data(d.dhRecbto))+" ",1),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B(" Autorizado \xE0s "+Y(o.$filters.hora(d.dhRecbto)),1)]),_:2},1024)]),_:2},1024)):ie("",!0)],64)):($(),ve(Se,{key:1},[d.dataHoraEmissao?($(),J(ne,{key:0,lines:"1",color:"tertiary",class:"ellipsis"},{default:r(()=>[t(pe,{name:"mdi-calendar-today"}),B(" "+Y(o.$filters.data(d.dataHoraEmissao))+" ",1),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B(" Emitido \xE0s "+Y(o.$filters.hora(d.dataHoraEmissao)),1)]),_:2},1024)]),_:2},1024)):ie("",!0),d.dataHoraFinalizado?($(),J(ne,{key:1,lines:"1",color:"tertiary",class:"ellipsis"},{default:r(()=>[t(pe,{name:"mdi-calendar"}),B(" "+Y(o.$filters.data(d.dataHoraFinalizado))+" ",1),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B(" Finalizado \xE1s "+Y(o.$filters.hora(d.dataHoraFinalizado)),1)]),_:2},1024)]),_:2},1024)):ie("",!0)],64))]),_:2},1032,["onClick"]),t(K,{onClick:b=>s.abrir(d.id),class:"hideonmobile maxw100 q-pl-sm no-margin"},{default:r(()=>[t(g,{cor:d.status!=="Digita\xE7\xE3o"?"tertiary":"light",escuro:d.status!=="Digita\xE7\xE3o",class:"col-auto q-mx-auto"},{default:r(()=>[B(Y(d.status)+" ",1),t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B(" Status ")]),_:1})]),_:2},1032,["cor","escuro"])]),_:2},1032,["onClick"]),t(K,{onClick:b=>s.abrir(d.id),class:"hideonmobile maxw120 q-pl-sm no-margin"},{default:r(()=>[t(ne,{class:"text-tertiary text-weight-bold text-right"},{default:r(()=>[B(Y(o.$filters.numero(d.totalDocumento,2)),1)]),_:2},1024),_e(t(ne,{class:"text-tertiary text-right"},{default:r(()=>[B(Y(d.qtdeContatos)+" Itens ",1)]),_:2},1536),[[Pe,d.qtdeContatos>0]])]),_:2},1032,["onClick"]),t(K,{class:"hideonmobile col-auto q-pl-sm no-margin"},{default:r(()=>[t(be,{class:"q-pa-none"},{default:r(()=>[a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(K,{key:0,class:"no-margin"},{default:r(()=>[t(ue,{onClick:b=>s.abrir(d.id),icon:"edit",size:"md",color:"primary",round:"",flat:"",dense:""},null,8,["onClick"])]),_:2},1024)):ie("",!0),a.tabSelecionada.valor==="Nota no SEFAZ"?($(),J(K,{key:1,class:"no-margin",style:{width:"33.6px"}},{default:r(()=>[d.status==="N\xE3o Importada"?($(),J(ue,{key:0,onClick:b=>s.importarXmlDFe(d.id),flat:"",round:"",dense:"",icon:"mdi-upload",size:"md",color:"tertiary",class:"buttons"},{default:r(()=>[t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("Importar XML")]),_:1})]),_:2},1032,["onClick"])):ie("",!0)]),_:2},1024)):ie("",!0),["Nota no SEFAZ","Nota de Entrada"].includes(a.tabSelecionada.valor)?($(),J(K,{key:2,class:"no-margin",style:{width:"33.6px"}},{default:r(()=>[t(ue,{onClick:b=>s.downloadXmlDFe(d.id,a.tabSelecionada.valor),flat:"",round:"",dense:"",icon:"mdi-download",color:"tertiary",size:"md",class:"buttons"},{default:r(()=>[t(De,{anchor:"bottom middle",self:"center middle"},{default:r(()=>[B("Download XML")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(K,{key:3,class:"no-margin"},{default:r(()=>[t(ue,{icon:"print",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:r(()=>[t(Me,null,{default:r(()=>[_e(($(),J(xe,{link:"","no-border":"",separator:""},{default:r(()=>[($(!0),ve(Se,null,Te(a.configImpressao,b=>($(),J(be,{key:b.valor,onClick:S=>o.$imprimir(b.valor,d.id),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(Y(b.texto),1)]),_:2},1024),b.observacao?($(),J(ne,{key:0,caption:""},{default:r(()=>[B(Y(b.observacao),1)]),_:2},1024)):ie("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),($(!0),ve(Se,null,Te(a.configImpressaoPedidoCompra,b=>($(),J(be,{key:b.valor,onClick:S=>s.imprimirPedidoCompra(b.valor,d==null?void 0:d.codigoDocumento),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(Y(b.texto),1)]),_:2},1024),b.observacao?($(),J(ne,{key:0,caption:""},{default:r(()=>[B(Y(b.observacao),1)]),_:2},1024)):ie("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t(be,{onClick:b=>s.dialogImprimirEtiquetas({acao:"adicionar",item:d}),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Etiquetas ")]),_:1}),t(ne,{caption:""},{default:r(()=>[B(" Adicionar \xE1 Fila ")]),_:1})]),_:1})]),_:2},1032,["onClick"]),t(be,{onClick:b=>s.dialogImprimirEtiquetas({acao:"impressao",item:d}),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Etiquetas ")]),_:1}),t(ne,{caption:""},{default:r(()=>[B(" Impress\xE3o Direta ")]),_:1})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),[[Ve]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(K,{key:4,class:"no-margin"},{default:r(()=>[t(ue,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:r(()=>[t(Me,null,{default:r(()=>[_e(($(),J(xe,{link:"","no-border":"",separator:""},{default:r(()=>[a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(be,{key:0,onClick:b=>s.duplicarDocumento(d),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"content_copy"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):ie("",!0),ie("",!0)]),_:2},1024)),[[Ve]])]),_:2},1024)]),_:2},1024)]),_:2},1024)):ie("",!0)]),_:2},1024)]),_:2},1024),t(K,{class:"hideondesktop col-auto q-pl-sm no-margin"},{default:r(()=>[t(ue,{icon:"more_vert",size:"md",color:"tertiary",round:"",flat:"",dense:""},{default:r(()=>[t(Me,null,{default:r(()=>[_e(($(),J(xe,{link:"","no-border":"",separator:""},{default:r(()=>[ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(be,{key:1,onClick:b=>s.abrir(d.id),clickable:"",class:"itemHover"},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"edit"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Editar ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):ie("",!0),a.tabSelecionada.valor==="Nota no SEFAZ"&&d.status==="N\xE3o Importada"?($(),J(be,{key:2,onClick:b=>s.importarXmlDFe(d.id),clickable:"",class:"itemHover"},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"mdi-upload"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Importar XML ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):ie("",!0),["Nota no SEFAZ","Nota de Entrada"].includes(a.tabSelecionada.valor)?($(),J(be,{key:3,onClick:b=>s.downloadXmlDFe(d.id,a.tabSelecionada.valor),clickable:"",class:"itemHover"},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"mdi-download"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Download XML ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(!0),ve(Se,{key:4},Te(a.configImpressao,b=>($(),J(be,{key:b.valor,onClick:S=>o.$imprimir(b.valor,d.id),clickable:""},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(Y(b.texto),1)]),_:2},1024),b.observacao?($(),J(ne,{key:0,caption:""},{default:r(()=>[B(Y(b.observacao),1)]),_:2},1024)):ie("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(!0),ve(Se,{key:5},Te(a.configImpressaoPedidoCompra,b=>($(),J(be,{clickable:"",key:b.valor,onClick:S=>s.imprimirPedidoCompra(b.valor,d==null?void 0:d.codigoDocumento)},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(Y(b.texto),1)]),_:2},1024),b.observacao?($(),J(ne,{key:0,caption:""},{default:r(()=>[B(Y(b.observacao),1)]),_:2},1024)):ie("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)):ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(be,{key:6,clickable:"",onClick:b=>s.dialogImprimirEtiquetas({acao:"adicionar",item:d})},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Etiquetas ")]),_:1}),t(ne,{caption:""},{default:r(()=>[B(" Adicionar \xE1 Fila ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(be,{key:7,clickable:"",onClick:b=>s.dialogImprimirEtiquetas({acao:"impressao",item:d})},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"print"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Etiquetas ")]),_:1}),t(ne,{caption:""},{default:r(()=>[B(" Impress\xE3o Direta ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):ie("",!0),a.tabSelecionada.valor!=="Nota no SEFAZ"?($(),J(be,{key:8,onClick:b=>s.duplicarDocumento(d),clickable:"",class:"itemHover"},{default:r(()=>[t(K,{avatar:""},{default:r(()=>[t(pe,{name:"content_copy"})]),_:1}),t(K,null,{default:r(()=>[t(ne,null,{default:r(()=>[B(" Duplicar ")]),_:1})]),_:1})]),_:2},1032,["onClick"])):ie("",!0)]),_:2},1024)),[[Ve]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(lt)]))),128))]),_:1})]),_:1},8,["busca","onAtualizar","onLimparFiltrosClick","onCriarClick","lista","tabSelecionada","tabs","tabSelecionada2","tabs2","paginacao","mostrar"]),t(i,{ref:"comprasFicha",onAtualizar:s.atualizar,onDialogImprimirEtiquetas:s.dialogImprimirEtiquetas},null,8,["onAtualizar","onDialogImprimirEtiquetas"]),t(h,{ref:"comprasImportacaoXML",onAtualizar:s.atualizar,onConcluirImportacao:s.concluirImportacao},null,8,["onAtualizar","onConcluirImportacao"]),t(Xe,{modelValue:a.modalXMLNotaEntrada,"onUpdate:modelValue":l[15]||(l[15]=d=>a.modalXMLNotaEntrada=d),persistent:""},{default:r(()=>[t(je,{container:"",class:"bg-light",style:{height:"40vh",width:"50vw","max-width":"100vw"}},{default:r(()=>[he("form",{onSubmit:l[14]||(l[14]=Pt((...d)=>s.importarXmlNotaDeEntrada&&s.importarXmlNotaDeEntrada(...d),["prevent"]))},[t($e,null,{default:r(()=>[t(Ne,null,{default:r(()=>[_e(t(ue,{onClick:s.fecharXmlNotaDeEntrada,flat:"",round:"",dense:"",icon:"close"},null,8,["onClick"]),[[Ve]]),t(Re,null,{default:r(()=>[B("Importar XML Nota de Entrada")]),_:1}),t(ue,{color:"white","text-color":"primary",label:"Enviar",type:"submit",unelevated:""})]),_:1})]),_:1}),t(He,{class:"u-container"},{default:r(()=>[t(Ze,{style:{"min-height":"300px"}},{default:r(()=>{var d,b,S;return[he("div",Ia,[t(zt,{class:"col-12","hide-upload-btn":"","auto-upload":"",factory:s.adicionarXml,filter:D=>D.filter(x=>x.type==="text/xml")},null,8,["factory","filter"]),t(gt,{modelValue:a.xmlDevolucao,"onUpdate:modelValue":l[12]||(l[12]=D=>a.xmlDevolucao=D),label:"Devolu\xE7\xE3o"},null,8,["modelValue"]),t(gt,{modelValue:a.xmlEstrangeiro,"onUpdate:modelValue":l[13]||(l[13]=D=>a.xmlEstrangeiro=D),label:"Importa\xE7\xE3o do exterior"},null,8,["modelValue"])]),Object.keys((S=(b=(d=a.xmlNotaEntrada.error)==null?void 0:d.data)==null?void 0:b.fields)!=null?S:{}).length?($(),ve("div",Ca,[he("ul",ka,[($(!0),ve(Se,null,Te(Object.keys(a.xmlNotaEntrada.error.data.fields),D=>($(),ve("li",{key:D},[he("span",null,Y(D),1),he("span",null,Y(a.xmlNotaEntrada.error.data.fields[D]),1)]))),128))])])):ie("",!0)]}),_:1})]),_:1})],32)]),_:1})]),_:1},8,["modelValue"]),t(Xe,{modelValue:a.dialogEtiquetas.impressao,"onUpdate:modelValue":l[21]||(l[21]=d=>a.dialogEtiquetas.impressao=d)},{default:r(()=>[t(je,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"425px"}},{default:r(()=>[t(dt,{onSubmit:l[20]||(l[20]=d=>s.imprimirEtiquetas(a.modeloSelecionado)),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:r(()=>[t($e,null,{default:r(()=>[t(Ne,{class:"bg-primary text-white"},{default:r(()=>[t(Re,null,{default:r(()=>[t(pe,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),B(" Imprimir Etiquetas ")]),_:1})]),_:1})]),_:1}),t(He,null,{default:r(()=>[t(Ze,{class:"q-pa-md"},{default:r(()=>[t(y,{class:"q-pb-lg"},{default:r(()=>{var d,b,S,D,x,O,A,j,N,Z,ae,E,q;return[B(" Imprimir os itens: "),he("strong",null,Y((d=a.tabSelecionada)==null?void 0:d.valor)+" "+Y((S=(b=a.dialogEtiquetas)==null?void 0:b.item)!=null&&S.numero?", #"+((x=(D=a.dialogEtiquetas)==null?void 0:D.item)==null?void 0:x.numero):"")+" "+Y((A=(O=a.dialogEtiquetas)==null?void 0:O.item)!=null&&A.descricaoContato?" - "+((N=(j=a.dialogEtiquetas)==null?void 0:j.item)==null?void 0:N.descricaoContato):"")+" "+Y((ae=(Z=a.dialogEtiquetas)==null?void 0:Z.item)!=null&&ae.notaNumero?", Nota #"+((q=(E=a.dialogEtiquetas)==null?void 0:E.item)==null?void 0:q.notaNumero):""),1),B(". ")]}),_:1}),t(m,{modelValue:a.modeloSelecionado,"onUpdate:modelValue":l[16]||(l[16]=d=>a.modeloSelecionado=d),opcoes:a.opcoesModelo,dense:"",filled:"",tipo:"seletor",rotulo:"Modelo",cor:"white","popup-content-class":"etiquetas-modelo-selecionado",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(m,{modelValue:a.empresaSelecionada,"onUpdate:modelValue":l[17]||(l[17]=d=>a.empresaSelecionada=d),opcoes:a.opcoesEmpresas,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Empresa",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(m,{modelValue:a.tabelaPrecoSelecionada,"onUpdate:modelValue":l[18]||(l[18]=d=>a.tabelaPrecoSelecionada=d),opcoes:a.opcoesTabelasPreco,dense:"",filled:"",clearable:"",tipo:"seletor",rotulo:"Tabela de Pre\xE7o",color:"tertiary",class:"q-field--with-bottom"},null,8,["modelValue","opcoes"]),t(m,{modelValue:a.emBranco,"onUpdate:modelValue":l[19]||(l[19]=d=>a.emBranco=d),min:0,tipo:"quantidade",dense:"",filled:"",rotulo:"Etiquetas em branco",color:"tertiary","text-color":"red"},null,8,["modelValue"])]),_:1})]),_:1}),t(Ye,{class:"bg-light"},{default:r(()=>[t(Ne,null,{default:r(()=>[t(ot),_e(t(ue,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ve]]),t(ue,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Xe,{modelValue:a.dialogEtiquetas.adicionar,"onUpdate:modelValue":l[23]||(l[23]=d=>a.dialogEtiquetas.adicionar=d)},{default:r(()=>[t(je,{container:"",view:"hHh LpR fFf",class:"bg-white rounded-borders",style:{height:"100%","max-height":"250px"}},{default:r(()=>[t(dt,{onSubmit:s.adicionarEtiquetas,autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false",novalidate:""},{default:r(()=>[t($e,null,{default:r(()=>[t(Ne,{class:"bg-primary text-white"},{default:r(()=>[t(Re,null,{default:r(()=>[t(pe,{name:"mdi-tag-plus",size:"sm",class:"q-mr-sm"}),B(" Adicionar os itens a lista de etiquetas ")]),_:1})]),_:1})]),_:1}),t(He,null,{default:r(()=>[t(Ze,{class:"q-pa-md"},{default:r(()=>[t(y,{class:"q-pb-lg"},{default:r(()=>{var d,b,S,D,x,O,A,j,N,Z,ae,E,q;return[B(" Adicionar os itens: "),he("strong",null,Y((d=a.tabSelecionada)==null?void 0:d.valor)+" "+Y((S=(b=a.dialogEtiquetas)==null?void 0:b.item)!=null&&S.numero?", #"+((x=(D=a.dialogEtiquetas)==null?void 0:D.item)==null?void 0:x.numero):"")+" "+Y((A=(O=a.dialogEtiquetas)==null?void 0:O.item)!=null&&A.descricaoContato?" - "+((N=(j=a.dialogEtiquetas)==null?void 0:j.item)==null?void 0:N.descricaoContato):"")+" "+Y((ae=(Z=a.dialogEtiquetas)==null?void 0:Z.item)!=null&&ae.notaNumero?", Nota #"+((q=(E=a.dialogEtiquetas)==null?void 0:E.item)==null?void 0:q.notaNumero):""),1),B(" \xE0 lista de etiquetas para impress\xE3o. ")]}),_:1}),t(m,{modelValue:a.dialogEtiquetas.limpar,"onUpdate:modelValue":l[22]||(l[22]=d=>a.dialogEtiquetas.limpar=d),tipo:"logico",rotulo:"Limpar lista de etiquetas anterior."},null,8,["modelValue"])]),_:1})]),_:1}),t(Ye,{class:"bg-light"},{default:r(()=>[t(Ne,null,{default:r(()=>[t(ot),_e(t(ue,{label:"Cancelar",color:"tertiary",flat:"",class:"q-mr-sm"},null,512),[[Ve]]),t(ue,{label:"Confirmar",color:"primary",type:"submit",unelevated:""})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])])}var za=rt(va,[["render",Sa]]);export{za as default};
